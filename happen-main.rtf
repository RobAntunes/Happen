{\rtf1\ansi\ansicpg1252\cocoartf2822
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica-Bold;\f1\fnil\fcharset0 HelveticaNeue-Bold;\f2\fnil\fcharset0 HelveticaNeue;
\f3\fnil\fcharset0 .SFNS-Regular_wdth_opsz180000_GRAD_wght2580000;\f4\fmodern\fcharset0 Courier;\f5\fnil\fcharset0 .SFNS-Regular_wdth_opsz140000_GRAD_wght2580000;
\f6\fmodern\fcharset0 Courier-Bold;\f7\fnil\fcharset0 HelveticaNeue-Italic;\f8\fnil\fcharset0 .SFNS-Regular_wdth_opsz110000_GRAD_wght1F40000;
\f9\fnil\fcharset0 .SFNS-Regular_wdth_opsz1E0000_GRAD_wght2580000;}
{\colortbl;\red255\green255\blue255;\red0\green0\blue0;\red21\green22\blue24;\red255\green255\blue255;
\red40\green84\blue210;\red87\green91\blue100;\red244\green245\blue249;\red101\green101\blue101;\red247\green249\blue250;
\red171\green72\blue4;\red44\green90\blue217;\red18\green138\blue19;\red218\green0\blue26;\red229\green232\blue239;
}
{\*\expandedcolortbl;;\cspthree\c0\c0\c0;\cssrgb\c10980\c11373\c12157;\cssrgb\c100000\c100000\c100000;
\cssrgb\c20392\c42745\c85882;\cssrgb\c41569\c43137\c46667;\cssrgb\c96471\c96863\c98039;\cssrgb\c47059\c47059\c47059;\cssrgb\c97647\c98039\c98431;
\cssrgb\c73333\c36078\c0;\cssrgb\c22353\c45098\c88235;\cssrgb\c0\c59608\c9020;\cssrgb\c89412\c0\c12941;\cssrgb\c91765\c92941\c94902;
}
{\*\listtable{\list\listtemplateid1\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid1\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid1}
{\list\listtemplateid2\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid101\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid2}
{\list\listtemplateid3\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid201\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid3}
{\list\listtemplateid4\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid301\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid4}
{\list\listtemplateid5\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid401\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid5}
{\list\listtemplateid6\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid501\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid6}
{\list\listtemplateid7\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid601\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid7}
{\list\listtemplateid8\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid701\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid8}
{\list\listtemplateid9\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid801\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid9}
{\list\listtemplateid10\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid901\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid10}
{\list\listtemplateid11\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid1001\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid11}
{\list\listtemplateid12\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid1101\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid12}
{\list\listtemplateid13\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid1201\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid13}
{\list\listtemplateid14\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid1301\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid14}
{\list\listtemplateid15\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid1401\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid15}
{\list\listtemplateid16\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid1501\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid16}
{\list\listtemplateid17\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid1601\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid17}
{\list\listtemplateid18\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid1701\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid18}
{\list\listtemplateid19\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid1801\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid1802\'00;}{\levelnumbers;}\fi-360\li1440\lin1440 }{\listname ;}\listid19}
{\list\listtemplateid20\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid1901\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid20}
{\list\listtemplateid21\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid2001\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid21}
{\list\listtemplateid22\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid2101\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid22}
{\list\listtemplateid23\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid2201\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid23}
{\list\listtemplateid24\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid2301\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid24}
{\list\listtemplateid25\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid2401\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid25}
{\list\listtemplateid26\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid2501\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid26}
{\list\listtemplateid27\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid2601\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid27}
{\list\listtemplateid28\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid2701\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid28}
{\list\listtemplateid29\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid2801\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid29}
{\list\listtemplateid30\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid2901\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid30}
{\list\listtemplateid31\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid3001\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid31}
{\list\listtemplateid32\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid3101\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid32}
{\list\listtemplateid33\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid3201\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid33}
{\list\listtemplateid34\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid3301\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid34}
{\list\listtemplateid35\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid3401\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid35}
{\list\listtemplateid36\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid3501\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid36}
{\list\listtemplateid37\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid3601\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid37}
{\list\listtemplateid38\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid3701\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid38}
{\list\listtemplateid39\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid3801\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid39}
{\list\listtemplateid40\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid3901\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid40}
{\list\listtemplateid41\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid4001\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid41}
{\list\listtemplateid42\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid4101\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid42}
{\list\listtemplateid43\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid4201\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid4202\'00;}{\levelnumbers;}\fi-360\li1440\lin1440 }{\listname ;}\listid43}
{\list\listtemplateid44\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid4301\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid44}
{\list\listtemplateid45\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid4401\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid45}
{\list\listtemplateid46\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid4501\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid46}
{\list\listtemplateid47\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid4601\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid47}
{\list\listtemplateid48\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid4701\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid48}
{\list\listtemplateid49\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid4801\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid49}
{\list\listtemplateid50\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid4901\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid50}
{\list\listtemplateid51\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid5001\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid51}
{\list\listtemplateid52\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid5101\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid52}
{\list\listtemplateid53\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid5201\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid53}
{\list\listtemplateid54\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid5301\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid54}
{\list\listtemplateid55\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid5401\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid55}
{\list\listtemplateid56\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid5501\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid56}
{\list\listtemplateid57\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid5601\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid57}
{\list\listtemplateid58\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid5701\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid58}
{\list\listtemplateid59\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid5801\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid59}
{\list\listtemplateid60\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid5901\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid60}
{\list\listtemplateid61\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid6001\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid61}
{\list\listtemplateid62\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid6101\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid62}
{\list\listtemplateid63\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid6201\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid63}
{\list\listtemplateid64\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid6301\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid64}
{\list\listtemplateid65\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid6401\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid65}
{\list\listtemplateid66\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid6501\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid66}
{\list\listtemplateid67\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid6601\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid67}
{\list\listtemplateid68\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid6701\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid68}
{\list\listtemplateid69\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid6801\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid69}
{\list\listtemplateid70\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid6901\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid70}
{\list\listtemplateid71\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid7001\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid71}
{\list\listtemplateid72\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid7101\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid72}
{\list\listtemplateid73\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid7201\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid73}
{\list\listtemplateid74\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid7301\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid74}
{\list\listtemplateid75\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid7401\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid75}
{\list\listtemplateid76\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid7501\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid76}
{\list\listtemplateid77\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid7601\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid77}
{\list\listtemplateid78\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid7701\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid78}
{\list\listtemplateid79\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid7801\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid79}
{\list\listtemplateid80\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid7901\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid80}
{\list\listtemplateid81\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid8001\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid81}
{\list\listtemplateid82\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid8101\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid82}
{\list\listtemplateid83\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid8201\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid83}
{\list\listtemplateid84\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid8301\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid84}
{\list\listtemplateid85\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid8401\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid85}
{\list\listtemplateid86\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid8501\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid86}
{\list\listtemplateid87\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid8601\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid87}
{\list\listtemplateid88\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid8701\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid88}
{\list\listtemplateid89\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid8801\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid89}
{\list\listtemplateid90\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid8901\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid90}
{\list\listtemplateid91\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid9001\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid91}
{\list\listtemplateid92\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid9101\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid92}
{\list\listtemplateid93\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid9201\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid93}
{\list\listtemplateid94\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid9301\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid94}
{\list\listtemplateid95\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid9401\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid9402\'00;}{\levelnumbers;}\fi-360\li1440\lin1440 }{\listname ;}\listid95}
{\list\listtemplateid96\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid9501\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid96}
{\list\listtemplateid97\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid9601\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid97}
{\list\listtemplateid98\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid9701\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid98}
{\list\listtemplateid99\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid9801\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid99}
{\list\listtemplateid100\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid9901\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid100}
{\list\listtemplateid101\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid10001\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid101}
{\list\listtemplateid102\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid10101\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid102}
{\list\listtemplateid103\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid10201\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid103}
{\list\listtemplateid104\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid10301\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid104}
{\list\listtemplateid105\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid10401\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid105}
{\list\listtemplateid106\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid10501\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid106}
{\list\listtemplateid107\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid10601\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid107}
{\list\listtemplateid108\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid10701\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid108}
{\list\listtemplateid109\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid10801\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid109}
{\list\listtemplateid110\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid10901\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid110}
{\list\listtemplateid111\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid11001\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid111}
{\list\listtemplateid112\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid11101\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid112}
{\list\listtemplateid113\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid11201\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid113}
{\list\listtemplateid114\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid11301\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid114}
{\list\listtemplateid115\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid11401\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid115}
{\list\listtemplateid116\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid11501\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid116}
{\list\listtemplateid117\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid11601\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid117}
{\list\listtemplateid118\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid11701\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid118}
{\list\listtemplateid119\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid11801\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid119}
{\list\listtemplateid120\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid11901\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid120}
{\list\listtemplateid121\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid12001\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid121}
{\list\listtemplateid122\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid12101\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid122}
{\list\listtemplateid123\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid12201\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid123}
{\list\listtemplateid124\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid12301\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid124}
{\list\listtemplateid125\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{none\}}{\leveltext\leveltemplateid12401\'00;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid125}}
{\*\listoverridetable{\listoverride\listid1\listoverridecount0\ls1}{\listoverride\listid2\listoverridecount0\ls2}{\listoverride\listid3\listoverridecount0\ls3}{\listoverride\listid4\listoverridecount0\ls4}{\listoverride\listid5\listoverridecount0\ls5}{\listoverride\listid6\listoverridecount0\ls6}{\listoverride\listid7\listoverridecount0\ls7}{\listoverride\listid8\listoverridecount0\ls8}{\listoverride\listid9\listoverridecount0\ls9}{\listoverride\listid10\listoverridecount0\ls10}{\listoverride\listid11\listoverridecount0\ls11}{\listoverride\listid12\listoverridecount0\ls12}{\listoverride\listid13\listoverridecount0\ls13}{\listoverride\listid14\listoverridecount0\ls14}{\listoverride\listid15\listoverridecount0\ls15}{\listoverride\listid16\listoverridecount0\ls16}{\listoverride\listid17\listoverridecount0\ls17}{\listoverride\listid18\listoverridecount0\ls18}{\listoverride\listid19\listoverridecount0\ls19}{\listoverride\listid20\listoverridecount0\ls20}{\listoverride\listid21\listoverridecount0\ls21}{\listoverride\listid22\listoverridecount0\ls22}{\listoverride\listid23\listoverridecount0\ls23}{\listoverride\listid24\listoverridecount0\ls24}{\listoverride\listid25\listoverridecount0\ls25}{\listoverride\listid26\listoverridecount0\ls26}{\listoverride\listid27\listoverridecount0\ls27}{\listoverride\listid28\listoverridecount0\ls28}{\listoverride\listid29\listoverridecount0\ls29}{\listoverride\listid30\listoverridecount0\ls30}{\listoverride\listid31\listoverridecount0\ls31}{\listoverride\listid32\listoverridecount0\ls32}{\listoverride\listid33\listoverridecount0\ls33}{\listoverride\listid34\listoverridecount0\ls34}{\listoverride\listid35\listoverridecount0\ls35}{\listoverride\listid36\listoverridecount0\ls36}{\listoverride\listid37\listoverridecount0\ls37}{\listoverride\listid38\listoverridecount0\ls38}{\listoverride\listid39\listoverridecount0\ls39}{\listoverride\listid40\listoverridecount0\ls40}{\listoverride\listid41\listoverridecount0\ls41}{\listoverride\listid42\listoverridecount0\ls42}{\listoverride\listid43\listoverridecount0\ls43}{\listoverride\listid44\listoverridecount0\ls44}{\listoverride\listid45\listoverridecount0\ls45}{\listoverride\listid46\listoverridecount0\ls46}{\listoverride\listid47\listoverridecount0\ls47}{\listoverride\listid48\listoverridecount0\ls48}{\listoverride\listid49\listoverridecount0\ls49}{\listoverride\listid50\listoverridecount0\ls50}{\listoverride\listid51\listoverridecount0\ls51}{\listoverride\listid52\listoverridecount0\ls52}{\listoverride\listid53\listoverridecount0\ls53}{\listoverride\listid54\listoverridecount0\ls54}{\listoverride\listid55\listoverridecount0\ls55}{\listoverride\listid56\listoverridecount0\ls56}{\listoverride\listid57\listoverridecount0\ls57}{\listoverride\listid58\listoverridecount0\ls58}{\listoverride\listid59\listoverridecount0\ls59}{\listoverride\listid60\listoverridecount0\ls60}{\listoverride\listid61\listoverridecount0\ls61}{\listoverride\listid62\listoverridecount0\ls62}{\listoverride\listid63\listoverridecount0\ls63}{\listoverride\listid64\listoverridecount0\ls64}{\listoverride\listid65\listoverridecount0\ls65}{\listoverride\listid66\listoverridecount0\ls66}{\listoverride\listid67\listoverridecount0\ls67}{\listoverride\listid68\listoverridecount0\ls68}{\listoverride\listid69\listoverridecount0\ls69}{\listoverride\listid70\listoverridecount0\ls70}{\listoverride\listid71\listoverridecount0\ls71}{\listoverride\listid72\listoverridecount0\ls72}{\listoverride\listid73\listoverridecount0\ls73}{\listoverride\listid74\listoverridecount0\ls74}{\listoverride\listid75\listoverridecount0\ls75}{\listoverride\listid76\listoverridecount0\ls76}{\listoverride\listid77\listoverridecount0\ls77}{\listoverride\listid78\listoverridecount0\ls78}{\listoverride\listid79\listoverridecount0\ls79}{\listoverride\listid80\listoverridecount0\ls80}{\listoverride\listid81\listoverridecount0\ls81}{\listoverride\listid82\listoverridecount0\ls82}{\listoverride\listid83\listoverridecount0\ls83}{\listoverride\listid84\listoverridecount0\ls84}{\listoverride\listid85\listoverridecount0\ls85}{\listoverride\listid86\listoverridecount0\ls86}{\listoverride\listid87\listoverridecount0\ls87}{\listoverride\listid88\listoverridecount0\ls88}{\listoverride\listid89\listoverridecount0\ls89}{\listoverride\listid90\listoverridecount0\ls90}{\listoverride\listid91\listoverridecount0\ls91}{\listoverride\listid92\listoverridecount0\ls92}{\listoverride\listid93\listoverridecount0\ls93}{\listoverride\listid94\listoverridecount0\ls94}{\listoverride\listid95\listoverridecount0\ls95}{\listoverride\listid96\listoverridecount0\ls96}{\listoverride\listid97\listoverridecount0\ls97}{\listoverride\listid98\listoverridecount0\ls98}{\listoverride\listid99\listoverridecount0\ls99}{\listoverride\listid100\listoverridecount0\ls100}{\listoverride\listid101\listoverridecount0\ls101}{\listoverride\listid102\listoverridecount0\ls102}{\listoverride\listid103\listoverridecount0\ls103}{\listoverride\listid104\listoverridecount0\ls104}{\listoverride\listid105\listoverridecount0\ls105}{\listoverride\listid106\listoverridecount0\ls106}{\listoverride\listid107\listoverridecount0\ls107}{\listoverride\listid108\listoverridecount0\ls108}{\listoverride\listid109\listoverridecount0\ls109}{\listoverride\listid110\listoverridecount0\ls110}{\listoverride\listid111\listoverridecount0\ls111}{\listoverride\listid112\listoverridecount0\ls112}{\listoverride\listid113\listoverridecount0\ls113}{\listoverride\listid114\listoverridecount0\ls114}{\listoverride\listid115\listoverridecount0\ls115}{\listoverride\listid116\listoverridecount0\ls116}{\listoverride\listid117\listoverridecount0\ls117}{\listoverride\listid118\listoverridecount0\ls118}{\listoverride\listid119\listoverridecount0\ls119}{\listoverride\listid120\listoverridecount0\ls120}{\listoverride\listid121\listoverridecount0\ls121}{\listoverride\listid122\listoverridecount0\ls122}{\listoverride\listid123\listoverridecount0\ls123}{\listoverride\listid124\listoverridecount0\ls124}{\listoverride\listid125\listoverridecount0\ls125}}
\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b\fs24 \cf2 	
\f1\fs120 \cf3 \cb4 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec3 Happen\cb1 \
\pard\pardeftab720\partightenfactor0

\fs72 \cf3 \cb4 Welcome\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 Welcome to Happen, where we believe in the power of simplicity! \cb1 \
\cb4 We're excited you're here to explore a framework that turns conventional wisdom on its head. Instead of drowning you in abstractions and boilerplate, Happen gives you just two fundamental building blocks\'97Nodes and Events\'97that combine to create systems of surprising power and flexibility. Whether you're building a straightforward automation pipeline or an intricate multi-agent ecosystem, you'll find that Happen's minimalist approach makes complex problems suddenly manageable. \cb1 \
\cb4 Our philosophy is simple: the most elegant solutions emerge not from adding complexity, but from discovering the right minimal abstractions that let the magic happen naturally. As you dive into these docs, you'll see how a handful of simple concepts can unlock an entire universe of possibilities. So take a deep breath, let go of framework complexity, and welcome to a world where less truly is more.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-kzTlst3tKo255yz4YpDi-quick-links"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Quick Links\cb1 \
\pard\pardeftab720\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-zKm2SQ5JH05CgKVa7EuM"}}{\fldrslt 
\fs32 \cf5 \cb4 \ul \ulc5 \strokec5 Basics}}
\fs32 \cf5 \ul \ulc5 \strokec5 \
\pard\pardeftab720\partightenfactor0

\fs28 \cf6 \cb4 \ulnone \strokec6 Learn\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-5kxme6Qh842rWHbSmGan"}}{\fldrslt 
\fs32 \cf5 \cb4 \ul \ulc5 \strokec5 Getting Started}}
\fs32 \cf5 \ul \ulc5 \strokec5 \
\pard\pardeftab720\partightenfactor0

\fs28 \cf3 \cb4 \ulnone \strokec3 Dive right in\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs96 \cf3 \cb4 Getting Started\cb1 \
\pard\pardeftab720\partightenfactor0

\fs72 \cf3 \cb4 What is Happen?\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 Happen is a framework for building agent-based systems founded on a philosophy of simplicity. Unlike conventional frameworks that burden developers with complex abstractions, Happen provides just two fundamental building blocks that can be composed to create systems ranging from simple pipelines to complex, adaptive multi-agent ecosystems.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-5kxme6Qh842rWHbSmGan-core-philosophy"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Core Philosophy\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 At its core, Happen distills agent-based systems down to their essence, recognizing that true power emerges from simplicity rather than complexity. The framework's philosophy embraces several key principles:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls1\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Simplicity
\f2\b0 : Only include what's absolutely essential; solve specific needs with specialized nodes rather than general framework features\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Pure Causality
\f2\b0 : Everything in a Happen system happens because of something else, creating natural causal chains\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Decentralized Intelligence
\f2\b0 : Smart systems emerge from simple nodes making local decisions\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Composable Simplicity
\f2\b0 : Complex behavior emerges from composing simple, understandable parts\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Emergence Over Prescription
\f2\b0 : Let patterns emerge naturally rather than forcing specific structural approaches\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 This minimalist approach creates a framework that is both accessible to newcomers and powerful enough for experts, allowing developers to focus on solving domain problems rather than battling framework complexities.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-5kxme6Qh842rWHbSmGan-the-foundation-nodes-and-events"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 The Foundation: Nodes and Events\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 At its foundation lie just two primitives:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls2\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Nodes
\f2\b0  - Independent, autonomous components that process and respond to information\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Events
\f2\b0  - Structured messages that transport data and intentions between Nodes\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 These two simple concepts combine to create systems of surprising power and flexibility. Nodes act as the primary actors in a Happen system - independent, autonomous components that can receive and process events, maintain internal state, and emit new events. Events are structured messages that flow between nodes, representing meaningful occurrences in the domain rather than simple function calls.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-5kxme6Qh842rWHbSmGan-pure-causality-the-secret-to-happens-power"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Pure Causality: The Secret to Happen's Power\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The most distinctive aspect of Happen is its embrace of pure causality as its organizing principle. This approach eliminates entire categories of complexity found in other systems.\cb1 \
\cb4 In Happen:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls3\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Events can only be created when their prerequisites exist\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Every event contains references to its causal predecessors\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Each event has a unique identifier that gets referenced by its dependents\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 These references form a complete causal web that defines system behavior\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 This means that knowledge about the system is encoded directly in event flow patterns. Nodes don't need schema definitions or formal contracts to understand how to interact - they simply need to observe the event flow.\cb1 \
\cb4 When a node receives an event, it automatically knows:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls4\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 What event caused this one\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 What transaction or process it's part of\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Which node originated the event\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 The entire history and context are embedded in the event itself.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-5kxme6Qh842rWHbSmGan-runtime-transparency-direct-access-to-your-environment"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Runtime Transparency: Direct Access to Your Environment\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen embodies simplicity not only in its design but in its relationship with the underlying runtime environment. Unlike conventional frameworks that build abstraction layers over runtime capabilities, Happen takes a fundamentally different approach:\cb1 \
\cb4 Happen is simply a coordination layer for events. The runtime belongs to your code.\cb1 \
\cb4 This means:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls5\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 No framework-specific abstractions between your code and the runtime\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Direct use of runtime capabilities without performance penalties\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Immediate access to new runtime features without waiting for framework updates\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Seamless integration with the broader ecosystem for your runtime\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-5kxme6Qh842rWHbSmGan-why-happen-the-power-of-less"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Why Happen? The Power of Less\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen's minimalist approach offers profound advantages:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls6\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Cognitive Accessibility
\f2\b0 : The entire framework can be understood in minutes, eliminating the steep learning curves associated with complex agent frameworks\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Unbounded Flexibility
\f2\b0 : The simple primitives can be composed in countless ways, enabling virtually any interaction pattern\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Natural Scalability
\f2\b0 : Systems grow organically without architectural reimagining, scaling from tiny applications to vast distributed networks\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Inherent Resilience
\f2\b0 : The decentralized, event-driven nature creates natural recovery patterns and adaptation to changing conditions\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Self-Documentation
\f2\b0 : The causal web of events documents system behavior automatically\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 Happen demonstrates that remarkable power can emerge from intentional simplicity. By providing just enough structure through two core concepts, it enables developers to create systems that are both powerful and comprehensible.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 As you begin building with Happen, remember that the framework's power comes not from complex features or abstractions, but from how its minimal primitives combine to create emergent behaviors. Start simple, observe how events flow through your system, and let the natural patterns guide your development.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs72 \cf3 \cb4 Runtime Philosophy\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 Happen embodies simplicity not only in its design but in its relationship with the underlying runtime environment. Unlike conventional frameworks that build abstraction layers over runtime capabilities, Happen takes a fundamentally different approach:\cb1 \
\cb4 Happen is simply a coordination layer for events. The runtime belongs to your code.\cb1 \
\cb4 This approach has profound implications for how you build systems with Happen.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-iy2b6fx2iddlyQQLxhP6-direct-runtime-access"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Direct Runtime Access\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 With Happen, there are no framework-specific abstractions standing between your code and the runtime:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf8 \cb9 \strokec8 // A Happen node handling file operations\cf3 \strokec3 \
\pard\pardeftab720\partightenfactor0
\cf10 \strokec10 fileNode\cf11 \strokec11 .on\cf3 \strokec3 (\cf12 \strokec12 'save-document'\cf6 \strokec6 ,\cf3 \strokec3  \cf13 \strokec13 async\cf3 \strokec3  event \cf13 \strokec13 =>\cf3 \strokec3  \{\
  \cf13 \strokec13 const\cf3 \strokec3  \{ \cf10 \strokec10 path\cf6 \strokec6 ,\cf3 \strokec3  \cf10 \strokec10 content\cf3 \strokec3  \} \cf13 \strokec13 =\cf3 \strokec3  \cf10 \strokec10 event\cf3 \strokec3 .payload;\
  \cf13 \strokec13 try\cf3 \strokec3  \{\
    \cf8 \strokec8 // Direct use of runtime capabilities\cf3 \strokec3 \
    \cf8 \strokec8 // No "Happen way" to do this - just use the runtime\cf3 \strokec3 \
    \cf13 \strokec13 await\cf3 \strokec3  \cf10 \strokec10 Bun\cf11 \strokec11 .write\cf3 \strokec3 (path\cf6 \strokec6 ,\cf3 \strokec3  content);\
    \
    \cf8 \strokec8 // Return success result\cf3 \strokec3 \
    \cf13 \strokec13 return\cf3 \strokec3  \{\
      status\cf13 \strokec13 :\cf3 \strokec3  \cf12 \strokec12 'success'\cf6 \strokec6 ,\cf3 \strokec3 \
      path\
    \};\
  \} \cf13 \strokec13 catch\cf3 \strokec3  (error) \{\
    \cf8 \strokec8 // Return error result\cf3 \strokec3 \
    \cf13 \strokec13 return\cf3 \strokec3  \{\
      status\cf13 \strokec13 :\cf3 \strokec3  \cf12 \strokec12 'error'\cf6 \strokec6 ,\cf3 \strokec3 \
      reason\cf13 \strokec13 :\cf3 \strokec3  \cf10 \strokec10 error\cf3 \strokec3 .message\
    \};\
  \}\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This example demonstrates a crucial aspect of Happen's philosophy: the framework doesn't try to abstract, wrap, or "improve" the runtime's capabilities. Your event handlers are simply JavaScript functions with full, direct access to whatever runtime they're executing in.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-iy2b6fx2iddlyQQLxhP6-the-invisible-framework"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 The Invisible Framework\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen is designed to be virtually invisible from a runtime perspective:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf8 \cb9 \strokec8 // Creating a web server node\cf3 \strokec3 \
\pard\pardeftab720\partightenfactor0
\cf10 \strokec10 httpNode\cf11 \strokec11 .on\cf3 \strokec3 (\cf12 \strokec12 'start-server'\cf6 \strokec6 ,\cf3 \strokec3  event \cf13 \strokec13 =>\cf3 \strokec3  \{\
  \cf13 \strokec13 const\cf3 \strokec3  \{ \cf10 \strokec10 port\cf3 \strokec3  \} \cf13 \strokec13 =\cf3 \strokec3  \cf10 \strokec10 event\cf3 \strokec3 .payload;\
  \
  \cf8 \strokec8 // Direct use of Bun's HTTP server capabilities\cf3 \strokec3 \
  \cf13 \strokec13 const\cf3 \strokec3  \cf10 \strokec10 server\cf3 \strokec3  \cf13 \strokec13 =\cf3 \strokec3  \cf10 \strokec10 Bun\cf11 \strokec11 .serve\cf3 \strokec3 (\{\
    port\cf6 \strokec6 ,\cf3 \strokec3 \
    \cf11 \strokec11 fetch\cf3 \strokec3 (request) \{\
      \cf8 \strokec8 // Convert HTTP requests to events\cf3 \strokec3 \
      \cf13 \strokec13 const\cf3 \strokec3  \cf10 \strokec10 requestEvent\cf3 \strokec3  \cf13 \strokec13 =\cf3 \strokec3  \{\
        type\cf13 \strokec13 :\cf3 \strokec3  \cf12 \strokec12 'http-request'\cf6 \strokec6 ,\cf3 \strokec3 \
        payload\cf13 \strokec13 :\cf3 \strokec3  \{\
          url\cf13 \strokec13 :\cf3 \strokec3  \cf10 \strokec10 request\cf3 \strokec3 .url\cf6 \strokec6 ,\cf3 \strokec3 \
          method\cf13 \strokec13 :\cf3 \strokec3  \cf10 \strokec10 request\cf3 \strokec3 .method\cf6 \strokec6 ,\cf3 \strokec3 \
          headers\cf13 \strokec13 :\cf3 \strokec3  \cf10 \strokec10 Object\cf11 \strokec11 .fromEntries\cf3 \strokec3 (\cf10 \strokec10 request\cf11 \strokec11 .\cf10 \strokec10 headers\cf11 \strokec11 .entries\cf3 \strokec3 ())\cf6 \strokec6 ,\cf3 \strokec3 \
          body\cf13 \strokec13 :\cf3 \strokec3  \cf10 \strokec10 request\cf3 \strokec3 .body\
        \}\
      \};\
      \
      \cf8 \strokec8 // Process through Happen's event system\cf3 \strokec3 \
      \cf13 \strokec13 const\cf3 \strokec3  \cf10 \strokec10 responseEvent\cf3 \strokec3  \cf13 \strokec13 =\cf3 \strokec3  \cf10 \strokec10 httpNode\cf11 \strokec11 .processSync\cf3 \strokec3 (requestEvent);\
      \
      \cf8 \strokec8 // Convert response event back to HTTP\cf3 \strokec3 \
      \cf13 \strokec13 return\cf3 \strokec3  \cf13 \strokec13 new\cf3 \strokec3  \cf11 \strokec11 Response\cf3 \strokec3 (\
        \cf10 \strokec10 responseEvent\cf3 \strokec3 .\cf10 \strokec10 payload\cf3 \strokec3 .body\cf6 \strokec6 ,\cf3 \strokec3 \
        \{\
          status\cf13 \strokec13 :\cf3 \strokec3  \cf10 \strokec10 responseEvent\cf3 \strokec3 .\cf10 \strokec10 payload\cf3 \strokec3 .status\cf6 \strokec6 ,\cf3 \strokec3 \
          headers\cf13 \strokec13 :\cf3 \strokec3  \cf10 \strokec10 responseEvent\cf3 \strokec3 .\cf10 \strokec10 payload\cf3 \strokec3 .headers\
        \}\
      );\
    \}\
  \});\
  \
  \cf8 \strokec8 // Store server instance for later management\cf3 \strokec3 \
  \cf10 \strokec10 httpNode\cf3 \strokec3 .server \cf13 \strokec13 =\cf3 \strokec3  server;\
  \
  \cf13 \strokec13 return\cf3 \strokec3  \{ status\cf13 \strokec13 :\cf3 \strokec3  \cf12 \strokec12 'started'\cf6 \strokec6 ,\cf3 \strokec3  port \};\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 In this example, the node creates and manages a web server using the runtime's native capabilities. Happen simply provides the event-based coordination layer, not the HTTP functionality itself.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-iy2b6fx2iddlyQQLxhP6-glue-with-superpowers"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 "Glue with Superpowers"\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 This runtime philosophy exemplifies Happen's role as "glue with superpowers":\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls7\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 It's Just Glue
\f2\b0 : Happen connects different pieces of functionality without dictating how that functionality is implemented\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Your Code, Your Runtime
\f2\b0 : Your event handlers have complete freedom to use the runtime however they need\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 No Hidden Magic
\f2\b0 : There's no framework-specific way to access runtime features - you use them directly\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 No Learning Curve
\f2\b0 : If you know how to use the runtime, you already know how to use it with Happen\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-iy2b6fx2iddlyQQLxhP6-the-benefits-of-runtime-transparency"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 The Benefits of Runtime Transparency\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 This direct relationship between your code and the runtime offers several key advantages:\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-iy2b6fx2iddlyQQLxhP6-id-1.-zero-overhead"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 1. Zero Overhead\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Since Happen doesn't abstract the runtime, there's no performance penalty for accessing runtime capabilities:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // No performance penalty for runtime access\
databaseNode.on('query-users', async event => \{\
  const \{ filter \} = event.payload;\
  \
  // Direct database query using runtime capabilities\
  // No layers of abstraction adding overhead\
  const statement = db.prepare(`\
    SELECT * FROM users\
    WHERE name LIKE ?\
  `);\
  const users = statement.all(`%$\{filter\}%`);\
  \
  return \{ users \};\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-iy2b6fx2iddlyQQLxhP6-id-2.-full-runtime-capabilities"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 2. Full Runtime Capabilities\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 You have access to everything the runtime offers, not just what the framework developers thought to expose:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Using advanced runtime features\
processingNode.on('process-image', async event => \{\
  const \{ imagePath, options \} = event.payload;\
  \
  // Access to cutting-edge runtime features\
  // as soon as they're available in the runtime\
  const imageData = await Bun.file(imagePath).arrayBuffer();\
  const processed = await ImageProcessor.process(imageData, options);\
  await Bun.write(`$\{imagePath\}.processed`, processed);\
  \
  return \{ status: 'completed', outputPath: `$\{imagePath\}.processed` \};\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-iy2b6fx2iddlyQQLxhP6-id-3.-runtime-evolution"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 3. Runtime Evolution\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 As the runtime evolves with new capabilities, they're immediately available without waiting for framework updates:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Immediate access to new runtime features\
node.on('use-new-feature', event => \{\
  // When the runtime adds new capabilities,\
  // you can use them immediately without framework updates\
  const result = Bun.newCapability(event.payload);\
  \
  return \{ result \};\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-iy2b6fx2iddlyQQLxhP6-id-4.-ecosystem-compatibility"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 4. Ecosystem Compatibility\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Your Happen code works seamlessly with the broader ecosystem for your runtime:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Seamless integration with ecosystem libraries\
analyticsNode.on('analyze-data', async event => \{\
  const \{ dataset \} = event.payload;\
  \
  // Use any ecosystem library directly\
  // No need for framework-specific adapters or wrappers\
  const analysis = await performAnalysis(dataset);\
  \
  return \{ results: analysis \};\
\});\
\
// Helper function using ecosystem libraries\
async function performAnalysis(dataset) \{\
  // Direct use of ecosystem libraries\
  // No "Happen way" to integrate libraries\
  const results = await someAnalyticsLibrary.process(dataset);\
  return results;\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-iy2b6fx2iddlyQQLxhP6-consistent-philosophy-across-environments"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Consistent Philosophy Across Environments\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 This runtime philosophy remains consistent whether you're using Bun, Node.js, Deno, or browsers:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // The same approach works across different runtimes\
function createFileNode(id) \{\
  const node = createNode(id);\
  \
  // Handler implementation uses runtime-appropriate APIs\
  // but the Happen code remains the same\
  node.on('read-file', async event => \{\
    const \{ path \} = event.payload;\
    \
    try \{\
      // In Bun\
      const content = await Bun.file(path).text();\
      \
      // In Node.js\
      // const content = await fs.promises.readFile(path, 'utf8');\
      \
      // In Deno\
      // const content = await Deno.readTextFile(path);\
      \
      // In browser\
      // const response = await fetch(path);\
      // const content = await response.text();\
      \
      return \{ content \};\
    \} catch (error) \{\
      return \{ error: error.message \};\
    \}\
  \});\
  \
  return node;\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 While the specific API calls differ between environments, Happen's relationship with the runtime remains the same: it simply provides event coordination while giving your code direct access to the runtime.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-iy2b6fx2iddlyQQLxhP6-the-power-of-stepping-back"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 The Power of Stepping Back\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 By stepping back and focusing solely on event coordination, Happen achieves something rare in frameworks: it gets out of your way. The framework doesn't try to be the center of your application or dictate how you should use the runtime. It simply provides the minimal structure needed for nodes to communicate through events, then lets your code take center stage.\cb1 \
\cb4 This approach creates a unique developer experience:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls8\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Low Cognitive Load
\f2\b0 : There's no need to learn framework-specific ways to access runtime features\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Maximum Flexibility
\f2\b0 : Your code can use the runtime however it needs without framework constraints\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Future-Proof
\f2\b0 : As runtimes evolve, your code can immediately leverage new capabilities\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 True Simplicity
\f2\b0 : The framework does one thing well (event coordination) and leaves the rest to your code\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 Happen's runtime philosophy embodies its commitment to simplicity. By focusing solely on event coordination and giving your code direct access to the runtime, Happen creates a framework that is both minimal and powerful.\cb1 \
\cb4 This approach recognizes that the most powerful frameworks are often those that do less, not more. By stepping back and letting your code work directly with the runtime, Happen achieves a rare balance: it provides enough structure to create sophisticated event-driven systems while imposing minimal constraints on how those systems are implemented.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 The result is a framework that truly embodies its name: it helps things happen without dictating how they happen.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs72 \cf3 \cb4 Quick Start\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-xApaMzEOar3zWEbFsqVR-welcome-to-happen"}}{\fldrslt 
\f3\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Welcome to Happen!\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Welcome to Happen, a framework for building distributed and agent-based systems founded on a philosophy of simplicity. Instead of complex abstractions, Happen provides just two fundamental building blocks, Nodes and Events, that let you create everything from simple pipelines to adaptive multi-agent ecosystems.\cb1 \
\cb4 This guide will get you running your first multi-node Happen application in under 5 minutes.\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f1\b \cf3 \cb4 Step 1: Prerequisites
\f2\b0 \cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 Before you begin, make sure you have the following installed:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls9\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Node.js (version 18+ recommended)\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Docker (for running the NATS messaging server)\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f1\b \cf3 \cb4 Step 2: Start the Messaging Backend
\f2\b0 \cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 Happen uses the NATS messaging system as its communication backbone. The quickest way to get a NATS server running is with Docker. Open your terminal and run the following command:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 docker run --rm -p 4222:4222 -p 8222:8222 nats:latest -js\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This command starts a NATS server with JetStream (its persistence layer) enabled and makes it available to your application. You can leave this running in the background.\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f1\b \cf3 \cb4 Step 3: Get the Happen Code
\f2\b0 \cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 Happen is currently in active development. To get started, you'll need to clone the repository directly from GitHub.\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 # Clone the Happen repository\
git clone https://github.com/RobAntunes/Happen.git happen\
\pard\pardeftab720\partightenfactor0
\cf3 \cb14 \
# Navigate to the project directory\
\pard\pardeftab720\partightenfactor0
\cf3 \cb9 cd happen\
\
# Install dependencies\
npm install\
\
# Build the project\
npm run build\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f1\b\fs24 \cf3 \cb4 Step 4: Create Your First Application
\f2\b0 \cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 Now, let's create a simple application that shows two nodes communicating. In the 
\f4\fs21 \cb7 happen
\f2\fs24 \cb4  directory, create a new file named 
\f4\fs21 \cb7 my-first-app.js
\f2\fs24 \cb4  and add the following code:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Import Happen from the build output\
import \{ initializeHappen \} from './dist/index.js';\
\
// Initialize the framework. It will connect to NATS on localhost by default.\
const \{ createNode \} = initializeHappen();\
\
// --- Create Our First Node: The Logger ---\
// Nodes are independent, autonomous components.\
const loggerNode = createNode('logger-service');\
\
// This node listens for any 'greeting-was-sent' event.\
loggerNode.on('greeting-was-sent', (event) => \{\
  console.log(`[Logger Service] Received a greeting: "$\{event.payload.message\}"`);\
\});\
\
// --- Create Our Second Node: The Greeter ---\
const greeterNode = createNode('greeter-service');\
\
// After a 1-second delay, this node will broadcast an event to the entire system.\
setTimeout(() => \{\
  console.log('[Greeter Service] Broadcasting a greeting...');\
  \
  // Events are structured messages that transport data.\
  greeterNode.broadcast(\{\
    type: 'greeting-was-sent',\
    payload: \{ message: 'Hello from the other side!' \}\
  \});\
\}, 1000);\
\
console.log('Application started. Nodes are running and listening for events...');\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f1\b\fs24 \cf3 \cb4 Step 5: Run It!
\f2\b0 \cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 Save the file and run it from your terminal:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 node my-first-app.js\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 You should see the following output:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 Application started. Nodes are running and listening for events...\
[Greeter Service] Broadcasting a greeting...\
[Logger Service] Received a greeting: "Hello from the other side!"\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 Congratulations! You just ran your first distributed Happen application. The 
\f4\fs21 \cb7 greeter-service
\f2\fs24 \cb4  node sent an event that the 
\f4\fs21 \cb7 logger-service
\f2\fs24 \cb4  node received and acted upon, all without knowing anything about each other.\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f1\b \cf3 \cb4 Next Steps
\f2\b0 \cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 You've seen the basics of how nodes and events work. The real power of Happen comes from how these simple primitives can be combined to create resilient and complex systems.\cb1 \
\cb4 Ready to explore more? Continue to the\cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 Core Concepts section to deepen your understanding of the framework.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs96 \cf3 \cb4 Basics\cb1 \
\pard\pardeftab720\partightenfactor0

\fs72 \cf3 \cb4 Core Concepts\cb1 \
\pard\pardeftab720\sa240\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 Events all the way down.\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 Happen is built on a minimalist foundation of just two fundamental primitives: Nodes and Events. These primitives combine to create all the power of the framework without unnecessary complexity.\cb1 \
\cb4 At the infrastructure level, these primitives are powered by NATS, a high-performance messaging system that provides the backbone for Happen's distributed capabilities.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-zKm2SQ5JH05CgKVa7EuM-nodes-the-foundation-of-happen-systems"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Nodes: The Foundation of Happen Systems\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Nodes are the primary actors in a Happen system. They are independent, autonomous components that can:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls10\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Receive and process events\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Maintain internal state\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Transform state\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Emit new events\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 Conceptually, nodes can represent anything: services, entities, agents, processes, or even abstract concepts. This flexibility allows Happen systems to model complex domains with remarkable fidelity.\cb1 \
\cb4 Unlike traditional components that often require elaborate setup and configuration, Happen nodes are intentionally lightweight. They embody a biological inspiration\'97like cells in an organism or neurons in a brain\'97simple individual units that collectively create sophisticated behaviors through their interactions.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-zKm2SQ5JH05CgKVa7EuM-creating-a-node"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Creating a Node\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Creating a node in Happen is achieved by calling the 
\f4\fs21 \cb7 createNode()
\f2\fs24 \cb4  function with an identifier and optional config object:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 const orderProcessor = createNode("order-processor", \{\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 Every node has a unique identity that distinguishes it within the system:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls11\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Identities are cryptographically verifiable\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Nodes act autonomously based on their internal logic\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 A node's behavior is determined by how it processes events and transforms state\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Nodes don't need to know about the overall system structure to function\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 This autonomy means nodes can be developed, tested, and reasoned about independently, dramatically simplifying system development and maintenance.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-zKm2SQ5JH05CgKVa7EuM-events-the-lifeblood-of-the-system"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Events: The Lifeblood of the System\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Events are structured messages that flow between nodes, forming the lifeblood of any Happen system. They embody the principle that communication should be explicit, intentional, and meaningful.\cb1 \
\cb4 Unlike traditional method calls or function invocations, events in Happen represent meaningful occurrences in the domain\'97things that have happened that might be of interest to other parts of the system. This perspective shift encourages developers to model their systems in terms of meaningful domain events rather than technical procedures.\cb1 \
\cb4 Under the hood, Happen uses NATS to transport these events between nodes, benefiting from its high-performance, reliable messaging capabilities.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-zKm2SQ5JH05CgKVa7EuM-event-anatomy"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Event Anatomy\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Events consist of three fundamental parts:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls12\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Type
\f2\b0  - A string identifier indicating the event's purpose\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Payload
\f2\b0  - Domain-specific data relevant to the event\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Context
\f2\b0  - Causal and system information about the event\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 \{\
  type: "order-created",\
  payload: \{\
    orderId: "ORD-123",\
    items: [\
      \{\
        productId: "PROD-456",\
        quantity: 2,\
        price: 29.99\
      \}\
    ],\
    total: 59.98\
  \},\
  context: \{\
    causal: \{\
      id: "evt-789", // Unique event identifier\
      sender: "checkout-node", // Node that created the event\
      causationId: "evt-456", // Event that caused this one\
      correlationId: "txn-123", // Transaction/process identifier\
      path: ["user-node", "checkout-node"] // Event path\
    \},\
    // Additional context...\
  \}\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-zKm2SQ5JH05CgKVa7EuM-event-processing-the-event-continuum"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Event Processing: The Event Continuum\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Nodes process events through a pure functional flow model we call the "Event Continuum." This approach treats event handling as a chain of functions where each function determines what happens next through its return value:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Register an event handler - the entry point to the flow\
orderNode.on("process-order", validateOrder);\
\
// First function in the flow\
function validateOrder(event, context) \{\
  // Validate order\
  const validation = validateOrderData(event.payload);\
  if (!validation.valid) \{\
    return \{ success: false, reason: "Invalid order" \};\
  \}\
  \
  // Store validation result\
  context.validatedOrder = \{\
    ...event.payload,\
    validated: true,\
    validatedAt: Date.now()\
  \};\
  \
  // Return the next function to execute\
  return processPayment;\
\}\
\
// Next function in the flow\
function processPayment(event, context) \{\
  // Process payment using data from context\
  const paymentResult = processTransaction(event.payload.payment);\
  \
  // Store in context\
  context.payment = paymentResult;\
  \
  if (!paymentResult.success) \{\
    // Return a value to complete with failure\
    return \{ success: false, reason: "Payment failed" \};\
  \}\
  \
  // Return next function\
  return createShipment;\
\}\
\
// Final function returning a result value\
function createShipment(event, context) \{\
  // Create shipment\
  const shipment = generateShipment(event.payload.address);\
  \
  // Return final result (not a function)\
  return \{\
    success: true,\
    orderId: event.payload.orderId,\
    trackingNumber: shipment.trackingNumber\
  \};\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This pure functional approach offers remarkable power and flexibility:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls13\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Any function can return another function to redirect the flow\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Any function can return a non-function value to complete the flow\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 A shared context object allows communication between functions\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Complex workflows emerge naturally from function composition\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-zKm2SQ5JH05CgKVa7EuM-state-and-persistence"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 State and Persistence\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Nodes can maintain state that persists between events. Happen provides a clean, functional approach to accessing and updating state through pattern matching and transformations.\cb1 \
\cb4 Under the hood, this state is persisted in NATS JetStream's Key-Value store, providing durable, distributed state management without requiring custom persistence implementations.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-zKm2SQ5JH05CgKVa7EuM-accessing-state"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Accessing State\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Access the entire node state\
const orderState = orderNode.state.get();\
\
// Transform state before returning\
const orders = orderNode.state.get(state => state.backlog);\
\
// Access and transform state\
const correctedBatch = orderNode.state.get(state => \{\
  // Transform the state\
  return state.orders.map(order => (\{\
    ...order,\
    total: recalculateTotal(order)\
  \}));\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-zKm2SQ5JH05CgKVa7EuM-transforming-state"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Transforming State\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 You can transform state using a single function approach:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Transform state without pattern matching\
orderNode.state.set((state) => \{\
  // Update transformed state\
  return \{\
    ...state,\
    orders: \{\
      ...state.orders,\
      "order-123": \{\
        ...state.orders["order-123"],\
        status: "shipped",\
        shippedAt: Date.now()\
      \}\
    \}\
  \};\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 For more focused updates, you can create specific transformers:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Define transformer for shipping an order\
const shipOrder = (orderId) => (state) => (\{\
  ...state,\
  orders: \{\
    ...state.orders,\
    [orderId]: \{\
      ...state.orders[orderId],\
      status: "shipped",\
      shippedAt: Date.now()\
    \}\
  \}\
\});\
\
// Apply transformer\
orderNode.state.set(shipOrder("order-123"));\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-zKm2SQ5JH05CgKVa7EuM-the-causality-web"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 The Causality Web\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Underlying Happen's approach is the concept of pure causality, where every event is part of a causal chain. This is implemented through the metadata in each event:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls14\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f4\fs21 \cf3 \cb7 \strokec3 causationId
\f2\fs24 \cb4 : References the event that directly caused this one\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f4\fs21 \cf3 \cb7 \strokec3 correlationId
\f2\fs24 \cb4 : Groups events that are part of the same transaction or process\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f4\fs21 \cf3 \cb7 \strokec3 path
\f2\fs24 \cb4 : Shows the journey the event has taken through the system\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 This causal relationship creates a complete web of events that defines the system's behavior without requiring explicit schema definitions, contracts, or capability discovery protocols.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-zKm2SQ5JH05CgKVa7EuM-uniting-event-processing-and-state-transformation"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Uniting Event Processing and State Transformation\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 What makes Happen truly powerful is how the Event Continuum and state transformations work together:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Process event with the Event Continuum\
orderNode.on("update-order-status", (event, context) => \{\
  // Validate status change\
  const validationResult = validateStatusChange(\
    event.payload.orderId,\
    event.payload.status\
  );\
  \
  if (!validationResult.valid) \{\
    return \{\
      success: false,\
      reason: validationResult.reason\
    \};\
  \}\
  \
  // Store in context\
  context.orderId = event.payload.orderId;\
  context.newStatus = event.payload.status;\
  \
  // Apply state transformation\
  return applyStatusChange;\
\});\
\
// Function that applies state transformation\
function applyStatusChange(event, context) \{\
  const \{ orderId, newStatus \} = context;\
  \
  // Transform state\
  orderNode.state.set(state => \{\
    const orders = state.orders || \{\};\
    const order = orders[orderId];\
    \
    if (!order) \{\
      return state;\
    \}\
    \
    return \{\
      ...state,\
      orders: \{\
        ...orders,\
        [orderId]: \{\
          ...order,\
          status: newStatus,\
          updatedAt: Date.now()\
        \}\
      \}\
    \};\
  \});\
  \
  // Emit another event based on the state change\
  orderNode.broadcast(\{\
    type: "order-status-changed",\
    payload: \{\
      orderId,\
      status: newStatus\
    \}\
  \});\
  \
  // Return success result\
  return \{\
    success: true,\
    orderId,\
    status: newStatus\
  \};\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This unified approach allows you to seamlessly combine the reactive, event-driven flow with the consistent, state-focused transformations, giving you the best of both worlds.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-zKm2SQ5JH05CgKVa7EuM-nats-the-underlying-fabric"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 NATS: The Underlying Fabric\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 While Happen's conceptual model is built around Nodes and Events, the framework leverages NATS as its underlying messaging fabric to provide:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls15\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Distributed Messaging
\f2\b0 : High-performance communication between nodes, even across network boundaries\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Persistence
\f2\b0 : Durable storage of events and state through JetStream\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Exactly-Once Processing
\f2\b0 : Guaranteed message delivery and processing semantics\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Cross-Environment Operation
\f2\b0 : Unified communication across server, browser, and edge environments\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 This foundation ensures that Happen systems are not only conceptually clean but also robust and resilient in real-world distributed environments.\cb1 \
\cb4 Now that you understand the core concepts of Happen, you're ready to explore how these primitives combine to create powerful communication patterns and sophisticated system behaviors.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 In the next section, we'll explore event pattern matching and how it enables powerful selective event handling.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs72 \cf3 \cb4 Event Pattern Matching\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 In Happen, we've taken a different approach to event pattern matching. Instead of providing complex pattern syntax with its own parsing rules and limitations, we leverage JavaScript's first-class functions to give you complete freedom in defining how events should be matched.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-E5bwdXDXbagezt6QI3lo-function-based-matchers"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Function-Based Matchers\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 At its core, a pattern in Happen is simply a function that decides whether an event should be handled:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // A pattern is a function that returns true or false for an event type\
node.on(eventType => eventType === 'order.submitted', (event, context) => \{\
  // Process order submission\
  // ...\
  // Return next function or result\
  return processPayment;\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This function receives the event's type string and returns a boolean: true if the event should be handled, false if it should be ignored.\cb1 \
\cb4 This simple approach provides extraordinary flexibility:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Match exact event type\
node.on(type => type === 'order.submitted', handleOrderSubmission);\
\
// Match events by domain prefix\
node.on(type => type.startsWith('order.'), (event, context) => \{\
  // Log all order events\
  logOrderEvent(event);\
  // Continue to domain-specific handler\
  return getDomainSpecificHandler(event.type);\
\});\
\
// Match multiple specific events\
node.on(type => ['payment.succeeded', 'payment.failed'].includes(type), \
function(event, context) \{\
  // Process payment result\
  processPaymentResult(event);\
  // Branch based on success or failure\
  return event.type === 'payment.succeeded' ? \
    handlePaymentSuccess : handlePaymentFailure;\
\}\
);\
\
// Match with regular expressions\
node.on(type => /^user\\.(created|updated|deleted)$/.test(type), \
function(event, context) \{\
  // Handle user lifecycle event\
  updateUserCache(event);\
  // Determine next step based on event type\
  const actions = \{\
    'user.created': notifyUserCreated,\
    'user.updated': notifyUserUpdated,\
    'user.deleted': notifyUserDeleted\
  \};\
  // Return appropriate next function\
  return actions[event.type];\
\}\
);\
\
// Complex conditional matching\
node.on(type => \{\
  const [domain, action] = type.split('.');\
  return domain === 'inventory' && action.includes('level');\
\}, function(event, context) \{\
  // Process inventory level event\
  processInventoryLevel(event);\
  // Check if restock needed\
  if (isRestockNeeded(event.payload)) \{\
    return createRestockOrder;\
  \}\
  // Otherwise complete\
  return \{ processed: true \};\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-E5bwdXDXbagezt6QI3lo-creating-your-own-pattern-system"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Creating Your Own Pattern System\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 With function-based matchers, you can build any pattern matching system that suits your needs. Here's an example of how you might create your own pattern utilities:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Create a domain matcher\
function domain(name) \{\
  return type => type.startsWith(`$\{name\}.`);\
\}\
\
// Create an exact matcher\
function exact(fullType) \{\
  return type => type === fullType;\
\}\
\
// Create a wildcard matcher\
function wildcard(pattern) \{\
  // Convert the pattern to a regex\
  const regex = new RegExp('^' + pattern.replace(/\\./g, '\\\\.').replace(/\\*/g, '.*') + '$');\
  return type => regex.test(type);\
\}\
\
// Create a matcher for multiple patterns\
function oneOf(...patterns) \{\
  return type => patterns.some(pattern => \
    typeof pattern === 'function' ? pattern(type) : type === pattern\
  );\
\}\
\
// Create a matcher that excludes patterns\
function not(pattern) \{\
  const matcher = typeof pattern === 'function' ? pattern : type => type === pattern;\
  return type => !matcher(type);\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 Now you can use these utilities to create expressive, reusable matchers:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Match all order events\
node.on(domain('order'), (event, context) => \{\
  // Process all order events\
  logOrderEvent(event);\
  // Continue to specific handler based on event type\
  const actionType = event.type.split('.')[1];\
  return getHandlerForAction(actionType);\
\});\
\
// Match a specific event exactly\
node.on(exact('payment.succeeded'), (event, context) => \{\
  // Process successful payment\
  updateOrderPaymentStatus(event.payload);\
  // Continue to shipping\
  return createShipment;\
\});\
\
// Match using wildcards\
node.on(wildcard('user.*.completed'), (event, context) => \{\
  // Handle user completion events\
  trackUserCompletion(event);\
  // Determine next steps\
  return selectNextUserAction;\
\});\
\
// Match any of multiple patterns\
node.on(oneOf(\
  exact('order.submitted'),\
  exact('payment.succeeded'),\
  wildcard('shipping.*')\
), (event, context) => \{\
  // Handle important events\
  notifyAdmins(event);\
  // Continue to regular processing\
  return processNormally;\
\});\
\
// Match one domain but exclude specific events\
node.on(\
  type => domain('user')(type) && not(exact('user.password-changed'))(type),\
  (event, context) => \{\
    // Handle non-sensitive user events\
    logUserAction(event);\
    // Continue to specific handler\
    return getHandlerForUserAction(event.type);\
  \}\
);\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-E5bwdXDXbagezt6QI3lo-string-pattern-support"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 String Pattern Support\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 For convenience, Happen also supports string patterns which are converted to matcher functions internally:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // These are equivalent\
node.on('order.submitted', handleOrderSubmission);\
node.on(type => type === 'order.submitted', handleOrderSubmission);\
\
// These are equivalent too\
node.on('order.*', handleAllOrderEvents);\
node.on(type => type.startsWith('order.') && !type.includes('.', type.indexOf('.') + 1), handleAllOrderEvents);\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 String patterns support several features:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls16\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Exact matching: 'order.submitted'\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Wildcards: 'order.*'\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Alternative patterns: '\{order,payment\}.created'\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Multiple segments: 'user.profile.*'\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 However, function matchers provide greater flexibility and expressiveness when you need more complex matching logic.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-E5bwdXDXbagezt6QI3lo-building-domain-specific-pattern-systems"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Building Domain-Specific Pattern Systems\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 For larger applications, you might want to build a more structured pattern system. Here's an example of a domain-oriented approach:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Create a domain builder\
function createDomain(name) \{\
  // Basic event matcher creator\
  function eventMatcher(action) \{\
    return type => type === `$\{name\}.$\{action\}`;\
  \}\
  \
  // Return a function that can be called directly or accessed for utilities\
  const domain = eventMatcher;\
  \
  // Add utility methods\
  domain.all = () => type => type.startsWith(`$\{name\}.`);\
  domain.oneOf = (...actions) => type => \{\
    const prefix = `$\{name\}.`;\
    return type.startsWith(prefix) && \
           actions.includes(type.slice(prefix.length));\
  \};\
  \
  return domain;\
\}\
\
// Create domains for your application\
const order = createDomain('order');\
const payment = createDomain('payment');\
const user = createDomain('user');\
\
// Use them in your handlers\
node.on(order('submitted'), (event, context) => \{\
  // Handle order submission\
  processOrder(event.payload);\
  // Return next function\
  return validateInventory;\
\});\
\
node.on(order.all(), (event, context) => \{\
  // Log all order events\
  logOrderActivity(event);\
  // Continue normal processing\
  return context.next || null;\
\});\
\
node.on(payment.oneOf('succeeded', 'failed'), (event, context) => \{\
  // Process payment results\
  updateOrderWithPayment(event);\
  // Branch based on result\
  return event.type === 'payment.succeeded' ? \
    handleSuccessfulPayment : handleFailedPayment;\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-E5bwdXDXbagezt6QI3lo-benefits-of-function-based-pattern-matching"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Benefits of Function-Based Pattern Matching\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 This approach to pattern matching offers several advantages:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls17\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Unlimited Flexibility: Any matching logic can be implemented\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Zero Parse-Time Overhead: Patterns are just functions, no parsing needed\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Type Safety: TypeScript can fully type your pattern functions\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Testability: Pattern functions can be unit tested independently\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Composition: Combine matchers to create complex patterns\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Familiar JavaScript: No special syntax to learn, just standard JS\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-E5bwdXDXbagezt6QI3lo-best-practices"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Best Practices\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls18\ilvl0
\f2\b0 \AppleTypeServices \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Keep matcher functions pure: They should depend only on the input event type\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Create reusable pattern factories: Build a library of matcher creators for your application\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Compose simple matchers: Build complex patterns by combining simple ones\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Test your matchers: Unit test complex matching logic independently\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Consider performance: For high-frequency events, optimize your matcher functions\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs72 \cf3 \cb4 The Event Continuum\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 In Happen, we've distilled event processing to its purest essence: a continuous flow of functions that process events and determine what happens next.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-cdPq7w0MkDBsid2eXNPb-the-pure-functional-flow-model"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 The Pure Functional Flow Model\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 At its core, the Event Continuum views event handling as a single entry point that can branch into a chain of functions through return values:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Register a single entry point\
orderNode.on("create-order", validateOrder);\
\
// The flow is controlled by function returns\
function validateOrder(event, context) \{\
  if (!isValidOrder(event.payload)) \{\
    return \{ success: false, reason: "Invalid order" \};\
  \}\
  \
  // Return the next function to execute\
  return processOrder;\
\}\
\
function processOrder(event, context) \{\
  // Process the order\
  const orderId = createOrderInDatabase(event.payload);\
  \
  // Store in context\
  context.orderId = orderId;\
  \
  // Return the next function\
  return notifyCustomer;\
\}\
\
function notifyCustomer(event, context) \{\
  // Send notification using context data\
  sendOrderConfirmation(context.orderId, event.payload.customer);\
  \
  // Return final result\
  return \{ success: true, orderId: context.orderId \};\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This creates an elegant flow system with just one fundamental mechanism: 
\f1\b functions that return either the next function or a final value
\f2\b0 .\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-cdPq7w0MkDBsid2eXNPb-how-the-continuum-works"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 How the Continuum Works\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 When an event arrives at a node, the system:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls19\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Calls the registered handler function\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Examines the return value:\cb1 \
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\partightenfactor0
\ls19\ilvl1
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 If it's a function: Execute that function next\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 If it's any other value: Complete the flow with that value as the result\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 This simple mechanism creates a remarkably powerful and flexible flow system.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-cdPq7w0MkDBsid2eXNPb-flow-control-through-return-values"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Flow Control Through Return Values\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The Event Continuum achieves its power through a pure functional approach:\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-cdPq7w0MkDBsid2eXNPb-continuing-to-the-next-step"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Continuing to the Next Step\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 When a handler returns another function, the flow continues with that function:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 function checkInventory(event, context) \{\
  // Check inventory\
  const inventoryResult = validateStock(event.payload.items);\
  \
  if (!inventoryResult.available) \{\
    return handleInventoryShortage;\
  \}\
  \
  // Continue to payment processing\
  return processPayment;\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-cdPq7w0MkDBsid2eXNPb-completing-the-flow-with-a-result"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Completing the Flow with a Result\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 When a handler returns any non-function value, the flow completes with that value as the result:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 function processPayment(event, context) \{\
  // Process payment\
  const paymentResult = chargeCustomer(event.payload.payment);\
  \
  if (!paymentResult.success) \{\
    // Complete with failure result\
    return \{\
      success: false,\
      reason: "payment-failed",\
      details: paymentResult.error\
    \};\
  \}\
  \
  // Continue to shipping\
  return createShipment;\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-cdPq7w0MkDBsid2eXNPb-dynamic-flow-selection"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Dynamic Flow Selection\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Functions can return different next steps based on any condition:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 function determinePaymentMethod(event, context) \{\
  // Choose next step based on payment method\
  const method = event.payload.paymentMethod;\
  \
  // Return different functions based on conditions\
  if (method === "credit-card") \{\
    return processCreditCard;\
  \} else if (method === "paypal") \{\
    return processPaypal;\
  \} else \{\
    return processAlternativePayment;\
  \}\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-cdPq7w0MkDBsid2eXNPb-shared-context"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Shared Context\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 A shared context object flows through the function chain, allowing communication between steps:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 function validateOrder(event, context) \{\
  // Store validation result in context\
  context.validation = validateOrderData(event.payload);\
  \
  if (!context.validation.valid) \{\
    return \{ success: false, errors: context.validation.errors \};\
  \}\
  \
  return processInventory;\
\}\
\
function processInventory(event, context) \{\
  // Access context from previous step\
  const validatedItems = context.validation.items;\
  \
  // Add more to context\
  context.inventory = checkInventoryForItems(validatedItems);\
  \
  return processPayment;\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This provides a clean way for functions to build up state as the flow progresses.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-cdPq7w0MkDBsid2eXNPb-complex-flow-patterns"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Complex Flow Patterns\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The pure functional model supports sophisticated flow patterns:\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-cdPq7w0MkDBsid2eXNPb-conditional-branching"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Conditional Branching\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 function processOrder(event, context) \{\
  // Branch based on order type\
  if (event.payload.isRush) \{\
    return processRushOrder;\
  \} else if (event.payload.isInternational) \{\
    return processInternationalOrder;\
  \} else \{\
    return processStandardOrder;\
  \}\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-cdPq7w0MkDBsid2eXNPb-loop-patterns"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Loop Patterns\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 You can create loops by returning a function that's already been executed:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 function processItems(event, context) \{\
  // Initialize if first time\
  if (!context.itemIndex) \{\
    context.itemIndex = 0;\
    context.results = [];\
  \}\
  \
  // Get current item\
  const items = event.payload.items;\
  const currentItem = items[context.itemIndex];\
  \
  // Process current item\
  const result = processItem(currentItem);\
  context.results.push(result);\
  \
  // Increment index\
  context.itemIndex++;\
  \
  // Loop if more items\
  if (context.itemIndex < items.length) \{\
    return processItems; // Loop back to this function\
  \}\
  \
  // Otherwise, continue to next handler\
  return summarizeResults;\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-cdPq7w0MkDBsid2eXNPb-error-handling-patterns"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Error Handling Patterns\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Error handling becomes part of the natural flow:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 function processPayment(event, context) \{\
  try \{\
    // Attempt to process payment\
    const result = chargeCustomer(event.payload.payment);\
    context.payment = result;\
    \
    // Continue to shipping\
    return createShipment;\
  \} catch (error) \{\
    // Handle error\
    context.error = error;\
    \
    // Branch to error handler\
    return handlePaymentError;\
  \}\
\}\
\
function handlePaymentError(event, context) \{\
  // Log error\
  logPaymentFailure(context.error);\
  \
  // Return error result\
  return \{\
    success: false,\
    reason: "payment-failed",\
    error: context.error.message\
  \};\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-cdPq7w0MkDBsid2eXNPb-building-complete-workflows"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Building Complete Workflows\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The Event Continuum naturally supports building complex workflows:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Entry point\
orderNode.on("process-order", validateOrder);\
\
// Define workflow steps as functions\
function validateOrder(event, context) \{\
  const validation = performValidation(event.payload);\
  \
  if (!validation.valid) \{\
    return \{ success: false, errors: validation.errors \};\
  \}\
  \
  // Store in context and continue\
  context.validation = validation;\
  return checkInventory;\
\}\
\
function checkInventory(event, context) \{\
  const inventoryResult = checkStockLevels(event.payload.items);\
  \
  if (!inventoryResult.available) \{\
    return handleInventoryShortage;\
  \}\
  \
  // Store in context and continue\
  context.inventory = inventoryResult;\
  return processPayment;\
\}\
\
function processPayment(event, context) \{\
  const paymentResult = processTransaction(event.payload.payment);\
  \
  if (!paymentResult.success) \{\
    return handlePaymentFailure;\
  \}\
  \
  // Store in context and continue\
  context.payment = paymentResult;\
  return createShipment;\
\}\
\
function createShipment(event, context) \{\
  // Create shipment\
  const shipment = generateShipment(event.payload.address, event.payload.items);\
  context.shipment = shipment;\
  \
  return finalizeOrder;\
\}\
\
function finalizeOrder(event, context) \{\
  // Finalize the order\
  const finalOrder = \{\
    orderId: generateOrderId(),\
    customer: event.payload.customer,\
    payment: context.payment,\
    shipment: context.shipment,\
    status: "completed"\
  \};\
  \
  // Save order\
  saveOrderToDatabase(finalOrder);\
  \
  // Return final result\
  return \{\
    success: true,\
    order: finalOrder\
  \};\
\}\
\
// Error handling functions\
function handleInventoryShortage(event, context) \{\
  notifyInventoryTeam(event.payload.items);\
  \
  return \{\
    success: false,\
    reason: "inventory-shortage",\
    availableOn: estimateRestockDate(event.payload.items)\
  \};\
\}\
\
function handlePaymentFailure(event, context) \{\
  // Log failure\
  logPaymentFailure(event.payload.payment);\
  \
  return \{\
    success: false,\
    reason: "payment-failed",\
    paymentError: context.payment.error\
  \};\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-cdPq7w0MkDBsid2eXNPb-the-power-of-pure-functional-flows"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 The Power of Pure Functional Flows\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 This pure functional approach offers several benefits:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls20\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Ultimate Simplicity
\f2\b0 : One consistent pattern for all event handling\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Maximum Flexibility
\f2\b0 : Functions can compose and branch in unlimited ways\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Transparent Logic
\f2\b0 : Flow control is explicit in function returns\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Perfect Testability
\f2\b0 : Each function can be tested independently\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Minimal API Surface
\f2\b0 : Just 
\f4\fs21 \cb7 .on()
\f2\fs24 \cb4  with a single handler\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 This approach embodies Happen's philosophy in its purest form - a single registration method and function returns create a system of unlimited expressiveness.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-cdPq7w0MkDBsid2eXNPb-examples-of-the-event-continuum-in-action"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Examples of the Event Continuum in Action\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-cdPq7w0MkDBsid2eXNPb-simple-event-handling"}}{\fldrslt 
\f5\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Simple Event Handling\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Simple handler that completes immediately\
orderNode.on("order-created", (event) => \{\
  console.log("Order created:", event.payload.id);\
  return \{ acknowledged: true \};\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-cdPq7w0MkDBsid2eXNPb-validation-pattern"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Validation Pattern\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Entry point with validation\
orderNode.on("create-user", (event) => \{\
  const validation = validateUserData(event.payload);\
  \
  if (!validation.valid) \{\
    return \{ success: false, errors: validation.errors \};\
  \}\
  \
  // Continue to user creation\
  return createUserRecord;\
\});\
\
function createUserRecord(event, context) \{\
  // Create user in database\
  const userId = createUser(event.payload);\
  \
  // Return success\
  return \{ success: true, userId \};\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-cdPq7w0MkDBsid2eXNPb-request-response-with-direct-return"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Request-Response with Direct Return\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Direct communication with explicit return\
dataNode.on("get-user-data", (event, context) => \{\
  const \{ userId, fields \} = event.payload;\
  \
  // Fetch user data\
  const userData = fetchUserData(userId, fields);\
  \
  // Return directly to requester - this value will be sent back\
  return userData;\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-cdPq7w0MkDBsid2eXNPb-ending-flow-with-bare-return"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Ending Flow with Bare Return\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 A bare 
\f4\fs21 \cb7 return
\f2\fs24 \cb4  statement will end the flow without returning any value:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // End flow with a bare return statement\
dataNode.on("log-activity", (event, context) => \{\
  // Log the activity\
  logUserActivity(event.payload.userId, event.payload.action);\
  \
  // End the flow with a bare return\
  return;\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This is equivalent to returning 
\f4\fs21 \cb7 undefined
\f2\fs24 \cb4  but is more explicit about the intention to end the flow without a value.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-cdPq7w0MkDBsid2eXNPb-building-reusable-flow-patterns"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Building Reusable Flow Patterns\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The functional nature of the Event Continuum encourages building reusable patterns:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Create a validation wrapper\
function withValidation(validator, nextStep) \{\
  return function(event, context) \{\
    const validation = validator(event.payload);\
    \
    if (!validation.valid) \{\
      return \{ success: false, errors: validation.errors \};\
    \}\
    \
    // Store validation result\
    context.validation = validation;\
    \
    // Continue to next step\
    return nextStep;\
  \};\
\}\
\
// Create a retry wrapper\
function withRetry(handler, maxRetries = 3) \{\
  return function retryHandler(event, context) \{\
    // Initialize retry count\
    context.retryCount = context.retryCount || 0;\
    \
    try \{\
      // Attempt to execute handler\
      return handler(event, context);\
    \} catch (error) \{\
      // Increment retry count\
      context.retryCount++;\
      \
      // Check if we can retry\
      if (context.retryCount <= maxRetries) \{\
        console.log(`Retrying ($\{context.retryCount\}/$\{maxRetries\})...`);\
        return retryHandler; // Recurse to retry\
      \}\
      \
      // Too many retries\
      return \{\
        success: false,\
        error: error.message,\
        retries: context.retryCount\
      \};\
    \}\
  \};\
\}\
\
// Usage\
orderNode.on("create-order", \
  withValidation(validateOrder, \
    withRetry(processOrder)\
  )\
);\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-cdPq7w0MkDBsid2eXNPb-parallel-processing"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Parallel Processing\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 For more advanced scenarios, you can implement parallel processing:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Parallel execution helper\
function parallel(functions) \{\
  return async function(event, context) \{\
    // Execute all functions in parallel\
    const results = await Promise.all(\
      functions.map(fn => fn(event, context))\
    );\
    \
    // Store results\
    context.parallelResults = results;\
    \
    // Return the continuation function\
    return context.continuation;\
  \};\
\}\
\
// Usage\
orderNode.on("process-order", (event, context) => \{\
  // Set up the continuation\
  context.continuation = finalizeOrder;\
  \
  // Execute these functions in parallel\
  return parallel([\
    validateInventory,\
    processPayment,\
    prepareShipping\
  ]);\
\});\
\
function finalizeOrder(event, context) \{\
  // Access results from parallel execution\
  const [inventoryResult, paymentResult, shippingResult] = context.parallelResults;\
  \
  // Proceed based on all results\
  if (inventoryResult.success && paymentResult.success && shippingResult.success) \{\
    return \{ success: true, order: combineResults(context.parallelResults) \};\
  \} else \{\
    return \{ success: false, failures: findFailures(context.parallelResults) \};\
  \}\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 By treating event handling as a pure functional flow where each function determines what happens next, Happen enables a system of unlimited expressiveness that can handle everything from simple events to complex workflows with the same consistent pattern.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 Ready to explore more? Continue to the Communication Patterns section to see how the Event Continuum integrates with other aspects of the Happen framework.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs72 \cf3 \cb4 Communication Patterns\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 The lifeblood of any Happen system is communication between nodes. Happen distills communication down to fundamental patterns that can be composed to create any interaction model.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-ZXxfwYY21Yz9PCv9X7ja-system-wide-broadcasting"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 System-wide Broadcasting\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 System-wide broadcasting creates an environment where information flows freely throughout the entire ecosystem. Any node can transmit events that propagate across the system, reaching all nodes without targeting specific recipients.\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Weather monitoring service broadcasts a system-wide alert\
weatherMonitor.broadcast(\{\
  type: "severe-weather",\
  payload: \{\
    condition: "hurricane",\
    region: "Gulf Coast",\
    expectedImpact: "severe",\
    timeframe: "36 hours",\
  \},\
\});\
\
// Any node in the system can listen for these alerts\
emergencyServices.on(type => type === "severe-weather", event => \{\
  deployEmergencyTeams(event.payload.region);\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 Broadcasting is ideal for:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls21\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 System-wide notifications\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Important state changes that many nodes might care about\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Environmental changes affecting the entire system\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Crisis or exceptional condition alerts\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-ZXxfwYY21Yz9PCv9X7ja-direct-communication"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Direct Communication\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Direct communication establishes dedicated point-to-point channels between nodes, enabling private exchanges, guaranteed delivery, and response-oriented interactions.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-ZXxfwYY21Yz9PCv9X7ja-request-response-pattern"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Request-Response Pattern\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Order service directly communicates with payment service\
async function processOrder(event, context) \{\
  // Send to payment service and await response using .return()\
  const result = await orderNode.send(paymentNode, \{\
    type: "process-payment",\
    payload: \{\
      orderId: event.payload.orderId,\
      amount: calculateTotal(event.payload.items),\
      currency: "USD",\
      customerId: event.payload.customerId,\
    \}\
  \}).return();\
  \
  // Handle the response\
  if (result.status === "approved") \{\
    return createShipment;\
  \} else \{\
    return handlePaymentFailure;\
  \}\
\}\
\
// Payment service handles the request\
paymentNode.on("process-payment", event => \{\
  // Process the payment\
  const result = chargeCustomer(event.payload);\
  \
  // Return result directly\
  return \{\
    status: result.success ? "approved" : "declined",\
    transactionId: result.transactionId,\
    message: result.message\
  \};\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 The 
\f4\fs21 \cb7 .return()
\f2\fs24 \cb4  method explicitly indicates that you're expecting a response, making the code more readable and intention-clear. The receiving node simply returns a value from its handler as usual.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-ZXxfwYY21Yz9PCv9X7ja-response-handling-with-callbacks"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Response Handling with Callbacks\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 For more sophisticated response handling, you can provide a callback to 
\f4\fs21 \cb7 .return()
\f2\fs24 \cb4 :\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Send request and handle response with a callback\
orderNode.send(inventoryNode, \{\
  type: "check-inventory",\
  payload: \{ itemId: "123", quantity: 5 \}\
\}).return(response => \{\
  if (response.available) \{\
    processAvailableItem(response);\
  \} else \{\
    handleOutOfStock(response);\
  \}\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-ZXxfwYY21Yz9PCv9X7ja-fire-and-forget-communication"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Fire-and-Forget Communication\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 When no response is needed, simply don't call 
\f4\fs21 \cb7 .return()
\f2\fs24 \cb4 :\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Notification without needing a response\
function notifyCustomer(event, context) \{\
  // Send notification without calling .return()\
  orderNode.send(emailNode, \{\
    type: "send-email",\
    payload: \{\
      to: event.payload.customerEmail,\
      subject: "Order Confirmation",\
      orderId: event.payload.orderId\
    \}\
  \});\
  \
  // Continue processing immediately\
  return finalizeOrder;\
\}\
\
// Email node doesn't need to return anything\
emailNode.on("send-email", event => \{\
  sendCustomerEmail(event.payload);\
  // No explicit return needed for fire-and-forget\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This approach has several advantages:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls22\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 The sending node clearly indicates its expectations\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 The API is more extensible for future enhancements\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 It provides a cleaner way to handle responses\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 It avoids relying on node context details\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 Direct communication is best for:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls23\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Request-response interactions\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Private or sensitive information exchange\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Operations requiring acknowledgment\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Complex workflows requiring coordination\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-ZXxfwYY21Yz9PCv9X7ja-implicit-contracts"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Implicit Contracts\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 In Happen, contracts between nodes emerge naturally from event patterns:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls24\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 A node's interface is defined by the events it handles and emits\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 The causal relationships between events form a natural contract\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 New nodes can understand existing patterns through observation\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Contracts can evolve naturally as systems change\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 This emergent approach eliminates the need for formal interface definitions or schema registries.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-ZXxfwYY21Yz9PCv9X7ja-choosing-the-right-pattern"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Choosing the Right Pattern\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 While Happen allows you to freely mix communication patterns, here are some guidelines:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls25\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Use broadcasting when information needs to reach multiple recipients\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Use direct communication for targeted interactions\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Use 
\f4\fs21 \cb7 .return()
\f2\fs24 \cb4  when you need a response\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Skip 
\f4\fs21 \cb7 .return()
\f2\fs24 \cb4  for fire-and-forget operations\cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 The right combination of patterns will depend on your specific domain and requirements. By leveraging these fundamental communication patterns and composing them in different ways, you can create a wide range of interaction models that fit your specific needs.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs72 \cf3 \cb4 Confluence\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-rIIxK5mF8LmrJXDKFupp-unified-fan-in-and-fan-out-event-processing"}}{\fldrslt 
\f3\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Unified Fan-in and Fan-out Event Processing\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Confluence is Happen's system for handling multiple events and multiple nodes with minimal API surface. It provides powerful capabilities for both event batching (fan-in) and multi-node distribution (fan-out) through a single, intuitive container pattern.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-rIIxK5mF8LmrJXDKFupp-core-idea"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Core Idea\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Confluence embodies a simple concept: 
\f1\b When something is in a container, it represents a collection
\f2\b0 . This principle applies consistently whether you're working with nodes or events:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls26\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 An array of nodes means "multiple receivers"\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 An array of events means "a batch of events"\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Handlers naturally work with both individual items and collections\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 This symmetry creates a powerful system with virtually no new API surface.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-rIIxK5mF8LmrJXDKFupp-api-surface"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 API Surface\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The entire Confluence system introduces zero new methods, instead extending Happen's existing API to work with arrays:\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-rIIxK5mF8LmrJXDKFupp-fan-out-one-event-multiple-nodes"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Fan-out: One Event, Multiple Nodes\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Register a handler across multiple nodes using an array\
[orderNode, paymentNode, inventoryNode].on("update", (event, context) => \{\
  // Handler receives events from any of these nodes\
  console.log(`Processing update in $\{context.node.id\}`);\
\});\
\
// Send an event to multiple nodes using an array\
[orderNode, shippingNode, notificationNode].send(\{\
  type: "order-completed",\
  payload: \{ orderId: "ORD-123" \}\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-rIIxK5mF8LmrJXDKFupp-fan-in-multiple-events-one-handler"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Fan-in: Multiple Events, One Handler\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Send multiple events as a batch using an array\
node.send(targetNode, [\
  \{ type: "data-point", payload: \{ value: 10 \} \},\
  \{ type: "data-point", payload: \{ value: 20 \} \},\
  \{ type: "data-point", payload: \{ value: 30 \} \}\
]);\
\
// Handler naturally works with both individual events and batches\
node.on("data-point", (eventOrEvents, context) => \{\
  // Simple array check tells you what you received\
  if (Array.isArray(eventOrEvents)) \{\
    console.log(`Processing batch of $\{eventOrEvents.length\} events`);\
    return processBatch(eventOrEvents);\
  \} else \{\
    console.log(`Processing single event: $\{eventOrEvents.payload.value\}`);\
    return processSingle(eventOrEvents);\
  \}\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-rIIxK5mF8LmrJXDKFupp-the-event-continuum-and-divergent-flows"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 The Event Continuum and Divergent Flows\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 When an event is sent to multiple nodes using Confluence, each node processes it through its own independent flow chain, creating "divergent flows" - parallel processing paths that naturally extend the Event Continuum model:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Register with multiple nodes\
[orderNode, inventoryNode, notificationNode].on("order-updated", function validateUpdate(event, context) \{\
  // This function runs independently for each node\
  console.log(`Validating update in $\{context.node.id\}`);\
  \
  // Each node can return a different next function\
  if (context.node.id === "order-service") \{\
    return updateOrderRecord;\
  \} else if (context.node.id === "inventory-service") \{\
    return updateInventoryLevels;\
  \} else \{\
    return sendNotifications;\
  \}\
\});\
\
// Node-specific continuation functions\
function updateOrderRecord(event, context) \{\
  // Only runs in the order node's flow\
  console.log("Updating order records");\
  return \{ updated: true \};\
\}\
\
function updateInventoryLevels(event, context) \{\
  // Only runs in the inventory node's flow\
  console.log("Updating inventory levels");\
  return \{ inventoryUpdated: true \};\
\}\
\
function sendNotifications(event, context) \{\
  // Only runs in the notification node's flow\
  console.log("Sending notifications");\
  return \{ notificationsSent: true \};\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This creates a causal tree structure where:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls27\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Each node has its own isolated context\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Flow paths can diverge based on node-specific logic\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Return values are tracked per node\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 The complete causal history is preserved\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 When you need the results from multiple nodes:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Send to multiple nodes and await results using the standard return method\
const results = await sender.send([node1, node2, node3], event).return();\
\
// Results contains node-specific returns in a keyed object\
console.log(`Node1 result: $\{results.node1\}`);\
console.log(`Node2 result: $\{results.node2\}`);\
console.log(`Node3 result: $\{results.node3\}`);\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-rIIxK5mF8LmrJXDKFupp-no-config-needed"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 No Config Needed\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Since batching is fully explicit with arrays, there's no magical configuration needed. Batches are simply arrays of events that you create and send directly:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Send a single event\
node.send(targetNode, \{\
  type: "data-point",\
  payload: \{ value: 42 \}\
\});\
\
// Send a batch as an explicit array of events\
node.send(targetNode, [\
  \{ type: "data-point", payload: \{ value: 10 \} \},\
  \{ type: "data-point", payload: \{ value: 20 \} \},\
  \{ type: "data-point", payload: \{ value: 30 \} \}\
]);\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This direct approach ensures complete predictability with no behind-the-scenes magic.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-rIIxK5mF8LmrJXDKFupp-causality-preservation"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Causality Preservation\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Even with batches and multi-node processing, Confluence maintains Happen's causality guarantees:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls28\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 The causal context is preserved for each event in a batch\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Each event maintains its position in the causal chain\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Batch processing still records each event's causal history\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Divergent flows are tracked as branches in the causal tree\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 This means you can always trace the complete history of events, even when they've been processed in batches or across multiple nodes.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-rIIxK5mF8LmrJXDKFupp-context-in-multi-node-operations"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Context in Multi-Node Operations\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 When working with multiple nodes, context handling is structured to maintain node-specific isolation while providing clear access to relevant information:\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-rIIxK5mF8LmrJXDKFupp-node-specific-context-structure"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Node-Specific Context Structure\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 When a handler receives an event in a multi-node operation, the context structure clearly identifies which node is processing it:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 [orderNode, inventoryNode, shippingNode].on("order-updated", (event, context) => \{\
  // The context.node property identifies the specific node\
  console.log(`Processing in: $\{context.node.id\}`);\
  \
  // Each node maintains its own isolated context\
  context.nodeState = context.nodeState || \{\};\
  context.nodeState.lastProcessed = Date.now();\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-rIIxK5mF8LmrJXDKFupp-results-collection"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Results Collection\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 When collecting results from multiple nodes, the returned object has a clear structure with node IDs as keys:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Send to multiple nodes and collect results\
const results = await sender.send([orderNode, inventoryNode, shippingNode], \{\
  type: "verify-order",\
  payload: \{ orderId: "ORD-123" \}\
\}).return();\
\
// Results object is structured by node ID\
console.log(`Order verification: $\{results[orderNode.id].verified\}`);\
console.log(`Inventory status: $\{results[inventoryNode.id].available\}`);\
console.log(`Shipping estimate: $\{results[shippingNode.id].estimatedDays\}`);\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-rIIxK5mF8LmrJXDKFupp-batch-context-structure"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Batch Context Structure\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 For batch operations (multiple events to a single node), the context provides batch-level information at the root, with individual event contexts in an array:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 node.on("data-point", (events, context) => \{\
  if (Array.isArray(events)) \{\
    // Batch-level information at the root\
    console.log(`Processing batch of $\{events.length\} events`);\
    console.log(`Batch received at: $\{context.receivedAt\}`);\
    \
    // Each event has its own context in the events array\
    events.forEach((event, index) => \{\
      // context.events contains the individual event contexts\
      const eventContext = context.events[index];\
      console.log(`Event $\{index\} causation: $\{eventContext.causal.causationId\}`);\
    \});\
  \}\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-rIIxK5mF8LmrJXDKFupp-combined-multi-node-and-batch-operations"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Combined Multi-Node and Batch Operations\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 In the rare case of both batching and multi-node operations, the context structure maintains clear separation:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 [nodeA, nodeB].on("process-batch", (eventsOrEvent, context) => \{\
  // First determine which node we are\
  const nodeId = context.node.id;\
  \
  // Then check if we're processing a batch\
  if (Array.isArray(eventsOrEvent)) \{\
    // We're in a specific node, processing a batch\
    console.log(`Node $\{nodeId\} processing batch of $\{eventsOrEvent.length\} events`);\
    \
    // Access node-specific batch processing logic\
    return nodeProcessingStrategies[nodeId].processBatch(eventsOrEvent, context);\
  \} else \{\
    // We're in a specific node, processing a single event\
    console.log(`Node $\{nodeId\} processing single event`);\
    \
    // Access node-specific individual processing logic\
    return nodeProcessingStrategies[nodeId].processSingle(eventsOrEvent, context);\
  \}\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This context structure ensures that no matter how complex the operation, each node maintains its own isolated processing environment while still providing clear access to all necessary information.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-rIIxK5mF8LmrJXDKFupp-examples"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Examples\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-rIIxK5mF8LmrJXDKFupp-explicit-batch-creation-and-processing"}}{\fldrslt 
\f5\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Explicit Batch Creation and Processing\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Efficiently handle high-volume sensor data\
const telemetryNode = createNode("telemetry-processor");\
\
// Explicitly create batches - no magic behind the scenes\
function sendSensorData(readings) \{\
  // Create batches of appropriate size\
  const batchSize = 50;\
  \
  for (let i = 0; i < readings.length; i += batchSize) \{\
    // Explicitly create a batch as an array of events\
    const batch = readings.slice(i, i + batchSize).map(reading => (\{\
      type: "sensor-reading",\
      payload: \{ \
        sensorId: reading.sensorId, \
        value: reading.value \
      \}\
    \}));\
    \
    // Send the batch explicitly as an array\
    sensorNode.send(telemetryNode, batch);\
  \}\
\}\
\
// Generate some sample readings\
const readings = Array.from(\{ length: 1000 \}, (_, i) => (\{\
  sensorId: `sensor-$\{i % 10\}`,\
  value: Math.random() * 100\
\}));\
\
// Send readings in explicit batches\
sendSensorData(readings);\
\
// Handler processes either single events or explicitly sent batches\
telemetryNode.on("sensor-reading", (eventOrEvents, context) => \{\
  if (Array.isArray(eventOrEvents)) \{\
    // Process an explicitly sent batch\
    const readings = eventOrEvents.map(e => e.payload.value);\
    const average = readings.reduce((sum, v) => sum + v, 0) / readings.length;\
    \
    console.log(`Processed batch of $\{eventOrEvents.length\} readings, avg: $\{average\}`);\
    return \{ processed: readings.length \};\
  \} else \{\
    // Process single event\
    processSingleReading(eventOrEvents.payload);\
    return \{ processed: 1 \};\
  \}\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-rIIxK5mF8LmrJXDKFupp-distributed-notification-system-with-divergent-flows"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Distributed Notification System with Divergent Flows\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // System monitor that alerts multiple subsystems\
const monitorNode = createNode("system-monitor");\
const alertNode = createNode("alert-service");\
const loggingNode = createNode("logging-service");\
const adminNode = createNode("admin-dashboard");\
\
// Send critical alerts to multiple services\
function reportCriticalIssue(issue) \{\
  [alertNode, loggingNode, adminNode].send(\{\
    type: "critical-alert",\
    payload: \{\
      issue,\
      timestamp: Date.now(),\
      severity: "critical"\
    \}\
  \});\
\}\
\
// Each node processes alerts through its own flow\
[alertNode, loggingNode, adminNode].on("critical-alert", function processAlert(event, context) \{\
  // Common processing logic\
  console.log(`Alert received in $\{context.node.id\}`);\
  \
  // Node-specific next step\
  if (context.node.id === "alert-service") \{\
    return sendUserAlerts;\
  \} else if (context.node.id === "logging-service") \{\
    return createLogEntry;\
  \} else \{\
    return updateDashboard;\
  \}\
\});\
\
// Node-specific continuation functions\
function sendUserAlerts(event, context) \{\
  // Alert service sends notifications to users\
  return \{ alertsSent: 10 \};\
\}\
\
function createLogEntry(event, context) \{\
  // Logging service creates permanent record\
  return \{ loggedAt: Date.now() \};\
\}\
\
function updateDashboard(event, context) \{\
  // Admin dashboard updates UI\
  return \{ dashboardUpdated: true \};\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-rIIxK5mF8LmrJXDKFupp-manual-batch-processing"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Manual Batch Processing\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Explicitly create and send a batch of events\
const orderBatch = [\
  \{ type: "process-order", payload: \{ orderId: "ORD-001", total: 125.00 \} \},\
  \{ type: "process-order", payload: \{ orderId: "ORD-002", total: 75.50 \} \},\
  \{ type: "process-order", payload: \{ orderId: "ORD-003", total: 240.00 \} \}\
];\
\
// Send the batch\
node.send(processingNode, orderBatch);\
\
// Handle the batch on the receiving side\
processingNode.on("process-order", (eventOrEvents, context) => \{\
  if (Array.isArray(eventOrEvents)) \{\
    // Batch processing\
    const totalValue = eventOrEvents.reduce((sum, e) => sum + e.payload.total, 0);\
    return \{ totalProcessed: eventOrEvents.length, totalValue \};\
  \} else \{\
    // Individual processing\
    return \{ processed: eventOrEvents.payload.orderId \};\
  \}\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-rIIxK5mF8LmrJXDKFupp-performance-considerations"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Performance Considerations\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Confluence is designed to be explicit and predictable while still providing performance benefits:\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-rIIxK5mF8LmrJXDKFupp-when-to-use-batching"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 When to Use Batching\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls29\ilvl0
\f2\b0\fs48 \AppleTypeServices \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 High-volume event streams with similar event types\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Processing that benefits from aggregation (like analytics)\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Networks with significant latency where reducing round-trips helps\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Calculations that can be optimized when performed on multiple items together\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-rIIxK5mF8LmrJXDKFupp-when-to-use-multi-node-operations"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 When to Use Multi-node Operations\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls30\ilvl0
\f2\b0\fs48 \AppleTypeServices \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Broadcast notifications that multiple subsystems need to process\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Commands that affect multiple services simultaneously\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Cross-cutting concerns like logging, monitoring, or security\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Redundant processing for critical operations\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-rIIxK5mF8LmrJXDKFupp-batch-processing-efficiency"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Batch Processing Efficiency\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 For maximum efficiency when processing batches:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls31\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Use Specialized Algorithms
\f2\b0 : Many operations are more efficient on batches (like bulk database inserts)\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Minimize Per-event Overhead
\f2\b0 : Amortize setup costs across multiple events\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Leverage Memory Locality
\f2\b0 : Process related data together to improve cache efficiency\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Prefer Single Passes
\f2\b0 : Process the entire batch in one pass rather than multiple iterations\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-rIIxK5mF8LmrJXDKFupp-memory-management"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Memory Management\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Batch processing can also help with memory efficiency:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Process high-volume data with controlled memory usage\
node.on("high-volume-data", (eventOrEvents, context) => \{\
  if (Array.isArray(eventOrEvents)) \{\
    // Process incrementally to avoid memory spikes\
    let results = [];\
    const batchSize = 100;\
    \
    for (let i = 0; i < eventOrEvents.length; i += batchSize) \{\
      const chunk = eventOrEvents.slice(i, i + batchSize);\
      const chunkResults = processChunk(chunk);\
      results = results.concat(chunkResults);\
      \
      // Allow event loop to run between chunks if needed\
      if (i + batchSize < eventOrEvents.length) \{\
        yield \{ progress: Math.round((i + batchSize) / eventOrEvents.length * 100) \};\
      \}\
    \}\
    \
    return \{ results \};\
  \}\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-rIIxK5mF8LmrJXDKFupp-conclusion"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Conclusion\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Confluence provides powerful capabilities for handling multiple events and multiple nodes while maintaining Happen's commitment to radical simplicity. Through a single intuitive container pattern - using arrays for both nodes and events - it enables sophisticated batch processing and multi-node communication without introducing special methods or complex APIs.\cb1 \
\cb4 The system offers:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls32\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Pure Symmetry
\f2\b0 : The same pattern works for both nodes and events\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Explicit Control
\f2\b0 : No "magic" - batching and multi-node operations are explicit\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Divergent Flows
\f2\b0 : Natural extension of the Event Continuum to parallel processing\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Zero New Methods
\f2\b0 : Works entirely through existing APIs with array support\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Powerful Capabilities
\f2\b0 : Enables sophisticated patterns with minimal complexity\cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 Staying true to Happen's core philosophy of simplicity by recognizing that arrays naturally represent collections enables a powerful system with virtually no learning curve.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs72 \cf3 \cb4 Dependency Management\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 In line with Happen's philosophy of simplicity, our approach to dependencies emphasizes direct runtime access with minimal framework abstractions.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-D4QZKZCRuHLkWworSlsW-core-principles"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Core Principles\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen's dependency management follows three key principles:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls33\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Runtime Transparency
\f2\b0 : Your code has direct access to the runtime environment\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Minimal System Dependencies
\f2\b0 : Only essential framework dependencies (primarily NATS) are injected at initialization\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Event-Based Communication
\f2\b0 : Nodes interact through events, not traditional dependency injection\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-D4QZKZCRuHLkWworSlsW-system-level-dependencies"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 System-Level Dependencies\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 System dependencies are configured once during framework initialization:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Initialize Happen with system-level dependencies\
const happen = initializeHappen(\{\
  // NATS configuration as the primary dependency\
  nats: \{\
    // Direct NATS client for server environments\
    server: \{\
      servers: ['nats://localhost:4222'],\
      jetstream: true\
    \},\
    // WebSocket client for browser environments\
    browser: \{\
      servers: ['wss://localhost:8443'],\
      jetstream: true\
    \}\
  \},\
  \
  // Optional: Override crypto implementation\
  crypto: cryptoImplementation\
\});\
\
// The initialized framework provides the node creation function\
const \{ createNode \} = happen;\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 These system dependencies represent the minimal set required for Happen to function across different runtime environments. By injecting them at initialization, we maintain runtime agnosticism while ensuring consistent behavior.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-D4QZKZCRuHLkWworSlsW-direct-runtime-access"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Direct Runtime Access\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Rather than exposing a subset of features through abstraction layers, Happen encourages direct access to the runtime:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Import runtime capabilities directly\
import \{ WebSocketServer \} from 'ws';\
import * as fs from 'fs';\
\
const notificationNode = createNode('notification-service');\
\
// Set up WebSocket server directly using runtime capabilities\
const wss = new WebSocketServer(\{ port: 8080 \});\
const clients = new Map();\
\
// Use runtime WebSocket events directly\
wss.on('connection', (ws, req) => \{\
  const userId = getUserIdFromRequest(req);\
  clients.set(userId, ws);\
  \
  ws.on('close', () => \{\
    clients.delete(userId);\
  \});\
\});\
\
// Process events using the Event Continuum\
notificationNode.on('notify-user', function notifyUser(event, context) \{\
  const \{ userId, message \} = event.payload;\
  \
  // Direct runtime access - no framework abstraction\
  const clientSocket = clients.get(userId);\
  if (!clientSocket || clientSocket.readyState !== WebSocket.OPEN) \{\
    return \{\
      success: false,\
      reason: "user-not-connected"\
    \};\
  \}\
  \
  // Send notification\
  clientSocket.send(JSON.stringify(\{\
    type: 'notification',\
    message\
  \}));\
  \
  return \{\
    success: true,\
    delivered: true\
  \};\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This approach provides several benefits:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls34\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Zero overhead
\f2\b0 : No performance penalty for accessing runtime features\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Full capabilities
\f2\b0 : Access to everything the runtime offers, not just what the framework exposes\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Runtime evolution
\f2\b0 : Immediate access to new runtime features without framework updates\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Ecosystem compatibility
\f2\b0 : Works seamlessly with the broader ecosystem\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-D4QZKZCRuHLkWworSlsW-framework-agnosticism-for-third-party-libraries"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Framework Agnosticism for Third-Party Libraries\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 When you need external libraries, import and use them directly:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Import NATS client directly - no framework-specific imports\
import \{ connect \} from 'nats';\
\
const databaseNode = createNode('database-service');\
\
// Use the NATS client directly\
const nc = await connect(\{ servers: 'nats://localhost:4222' \});\
const js = nc.jetstream();\
\
databaseNode.on('query-users', function queryUsers(event, context) \{\
  const \{ searchTerm \} = event.payload;\
  \
  // Direct use of NATS client with KV store\
  const kv = js.keyValue("users");\
  const values = [];\
  \
  for await (const k of kv.keys()) \{\
    if (k.includes(searchTerm)) \{\
      const entry = await kv.get(k);\
      values.push(JSON.parse(entry.string()));\
    \}\
  \}\
  \
  return \{\
    success: true,\
    results: values\
  \};\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-D4QZKZCRuHLkWworSlsW-dependency-injection-through-closures"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Dependency Injection Through Closures\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Use closures to create handlers with access to dependencies:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Initialize node with dependencies\
function initializeDataNode() \{\
  // Create NATS client and JetStream KV store\
  const nc = await connect(\{ servers: 'nats://localhost:4222' \});\
  const js = nc.jetstream();\
  const kv = js.keyValue("data");\
  \
  // Create node\
  const dataNode = createNode('data-service');\
  \
  // Register handler using closure to capture dependencies\
  dataNode.on('query-data', (event, context) => \{\
    // Use kv from closure scope\
    return processQuery(kv, event, context);\
  \});\
  \
  return dataNode;\
\}\
\
// Function that uses dependency passed via parameters\
function processQuery(kv, event, context) \{\
  const \{ query, params \} = event.payload;\
  \
  // Use dependency from parameters\
  return new Promise((resolve, reject) => \{\
    // Use NATS KV store for data access\
    try \{\
      const results = [];\
      for (const key of query.keys) \{\
        const entry = await kv.get(key);\
        if (entry) \{\
          results.push(JSON.parse(entry.string()));\
        \}\
      \}\
      resolve(\{\
        success: true,\
        results\
      \});\
    \} catch (err) \{\
      reject(err);\
    \}\
  \});\
\}\
\
// Create node\
const dataNode = initializeDataNode();\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-D4QZKZCRuHLkWworSlsW-flow-state-through-closures"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Flow State Through Closures\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Although Happen provides a common object to share data across each flow you can also use closures to manage both dependencies and flow state, with explicit control over the flow through function returns:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 function initializeOrderNode() \{\
  // Create dependencies including NATS client\
  const nc = await connect(\{ servers: 'nats://localhost:4222' \});\
  const js = nc.jetstream();\
  const orderKV = js.keyValue("orders");\
  const emailService = createEmailService();\
  \
  // Create node\
  const orderNode = createNode('order-service');\
  \
  // Register initial handler with dependencies captured in closure\
  orderNode.on('process-order', (event, context) => \{\
    // Create initial flow state\
    const flowState = \{\
      orderId: generateOrderId(),\
      items: event.payload.items,\
      customer: event.payload.customer\
    \};\
    \
    // Return the first step function with dependencies and state in closure\
    // This function will be executed next in the flow\
    return validateOrder(orderKV, emailService, flowState);\
  \});\
  \
  return orderNode;\
\}\
\
// Each flow function creates and returns the next handler in the chain\
function validateOrder(orderKV, emailService, state) \{\
  // This function is returned by the initial handler and executed by the framework\
  return (event, context) => \{\
    // Validate order\
    const validationResult = validateOrderData(state.items);\
    \
    if (!validationResult.valid) \{\
      // Return a value (not a function) to complete the flow with error\
      return \{\
        success: false,\
        errors: validationResult.errors\
      \};\
    \}\
    \
    // Update state (immutably)\
    const updatedState = \{\
      ...state,\
      validated: true,\
      validatedAt: Date.now()\
    \};\
    \
    // Return the next function to be executed in the flow\
    return processPayment(orderKV, emailService, updatedState);\
  \};\
\}\
\
function processPayment(orderKV, emailService, state) \{\
  // Return a function that will be executed as the next step\
  return (event, context) => \{\
    // Process payment asynchronously\
    const paymentResult = processCustomerPayment(state.customer, calculateTotal(state.items));\
    \
    if (!paymentResult.success) \{\
      // Return a value (not a function) to complete the flow with error\
      return \{\
        success: false,\
        reason: "payment-failed"\
      \};\
    \}\
    \
    // Update state (immutably)\
    const updatedState = \{\
      ...state,\
      paymentId: paymentResult.transactionId,\
      paymentMethod: paymentResult.method,\
      paidAt: Date.now()\
    \};\
    \
    // Return the next function to be executed in the flow\
    return finalizeOrder(orderKV, emailService, updatedState);\
  \};\
\}\
\
function finalizeOrder(orderKV, emailService, state) \{\
  // Return a function that will be executed as the next step\
  return async (event, context) => \{\
    // Create order in KV store\
    await orderKV.put(state.orderId, JSON.stringify(\{\
      id: state.orderId,\
      customer: state.customer,\
      items: state.items,\
      payment: \{\
        id: state.paymentId,\
        method: state.paymentMethod\
      \}\
    \}));\
    \
    // Send confirmation email\
    emailService.sendOrderConfirmation(\
      state.customer.email,\
      state.orderId,\
      state.items\
    );\
    \
    // Return a value (not a function) to complete the flow with success\
    return \{\
      success: true,\
      orderId: state.orderId,\
      transactionId: state.paymentId\
    \};\
  \};\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-D4QZKZCRuHLkWworSlsW-how-flow-control-works-with-closures"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 How Flow Control Works With Closures\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 In this pattern, the flow is controlled through a clear mechanism:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls35\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Each flow step returns a function
\f2\b0 : When a handler wants to continue the flow, it returns a function that becomes the next handler.\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Flow continues while functions are returned
\f2\b0 : The framework executes each returned function in sequence, as long as functions are being returned.\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Flow ends when a non-function is returned
\f2\b0 : When a handler returns anything other than a function (like an object), the flow completes with that value as the result.\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Dependencies and state flow through function parameters
\f2\b0 : Each step receives dependencies and state through its parameters, not through context.\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Each step creates the next step with updated state
\f2\b0 : Functions create and return the next function in the chain, passing updated state and dependencies.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-D4QZKZCRuHLkWworSlsW-benefits-of-closure-based-dependency-management"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Benefits of Closure-Based Dependency Management\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 This closure-based approach offers several advantages:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls36\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Pure Functions
\f2\b0 : Flow handlers become pure functions with explicit dependencies\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Clear Data Flow
\f2\b0 : Dependencies and state are explicitly passed between functions\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Testability
\f2\b0 : Each flow step can be easily tested in isolation with mocked dependencies\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Immutability
\f2\b0 : Encourages immutable state updates through function parameters\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Separation of Concerns
\f2\b0 : Clearly separates framework concerns from application logic\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-D4QZKZCRuHLkWworSlsW-nats-as-the-primary-dependency"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 NATS as the Primary Dependency\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 In the Happen framework, NATS serves as the primary dependency, providing core messaging, persistence, and coordination capabilities. This focused approach means:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls37\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Single Core Dependency
\f2\b0 : NATS is the primary external dependency you need to understand\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Mature Ecosystem
\f2\b0 : NATS has clients for all major languages and platforms\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Unified Capability Set
\f2\b0 : One system provides messaging, persistence, and coordination\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Direct NATS Access
\f2\b0 : Your code can access NATS capabilities directly when needed\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-D4QZKZCRuHLkWworSlsW-dependency-management-philosophy"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Dependency Management Philosophy\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen's approach to dependencies reflects its broader philosophy: provide just enough framework to enable powerful capabilities, while getting out of the way and letting your code work directly with the runtime.\cb1 \
\cb4 By limiting injected dependencies to only essential system needs (primarily NATS) and embracing direct runtime access and closure-based dependency management, Happen reduces complexity while maximizing flexibility.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 There's no complex dependency injection system because, in most cases, you simply use JavaScript's natural closure mechanism to capture and pass dependencies where needed.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs72 \cf3 \cb4 Closures, A Primer\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 Closures are a fundamental concept in JavaScript that provide an elegant solution for managing state and dependencies in event-driven systems like Happen. This primer will help you understand what closures are, how they work, and how they enable powerful patterns in your applications.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-K8D8CEb5RoM0lqWAooJT-what-is-a-closure"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 What is a Closure?\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 A closure is a function that "remembers" the environment in which it was created. More specifically, a closure is formed when a function retains access to variables from its outer (enclosing) scope, even after that outer function has completed execution.\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 function createGreeter(greeting) \{\
  // The inner function is a closure that "captures" the greeting variable\
  return function(name) \{\
    return `$\{greeting\}, $\{name\}!`;\
  \};\
\}\
\
// Create closures with different captured values\
const sayHello = createGreeter("Hello");\
const sayHi = createGreeter("Hi");\
\
// Use the closures\
console.log(sayHello("Alice")); // "Hello, Alice!"\
console.log(sayHi("Bob"));      // "Hi, Bob!"\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 In this example, 
\f4\fs21 \cb7 createGreeter
\f2\fs24 \cb4  returns a function that "closes over" the 
\f4\fs21 \cb7 greeting
\f2\fs24 \cb4  parameter. Each returned function remembers its own specific greeting, even after 
\f4\fs21 \cb7 createGreeter
\f2\fs24 \cb4  has finished executing.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-K8D8CEb5RoM0lqWAooJT-how-closures-work"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 How Closures Work\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 To understand closures, you need to understand two key JavaScript concepts: lexical scope and the function execution context.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-K8D8CEb5RoM0lqWAooJT-lexical-scope"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Lexical Scope\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 JavaScript uses lexical scoping, which means that functions are executed in the scope where they were defined, not where they are called:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 function outer() \{\
  const message = "Hello from outer scope!";\
  \
  function inner() \{\
    console.log(message); // Accesses variable from outer scope\
  \}\
  \
  inner();\
\}\
\
outer(); // "Hello from outer scope!"\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-K8D8CEb5RoM0lqWAooJT-execution-context-and-environment"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Execution Context and Environment\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 When a function is created, it stores a reference to its lexical environment\'97the set of variables and their values that were in scope when the function was created. This environment reference stays with the function, even if the function is returned or passed elsewhere.\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 function createCounter() \{\
  let count = 0; // Private state variable\
  \
  return \{\
    increment: function() \{\
      count++; // Accesses the count variable from the outer scope\
      return count;\
    \},\
    decrement: function() \{\
      count--; // Also accesses the same count variable\
      return count;\
    \},\
    getCount: function() \{\
      return count;\
    \}\
  \};\
\}\
\
const counter = createCounter();\
console.log(counter.increment()); // 1\
console.log(counter.increment()); // 2\
console.log(counter.decrement()); // 1\
console.log(counter.getCount());  // 1\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 In this example, all three functions share access to the same 
\f4\fs21 \cb7 count
\f2\fs24 \cb4  variable, creating a private state that can't be accessed directly from outside.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-K8D8CEb5RoM0lqWAooJT-memory-management-and-garbage-collection"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Memory Management and Garbage Collection\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Understanding how closures affect memory management is important for building efficient applications:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls38\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Retained References
\f2\b0 : When a function forms a closure, the JavaScript engine keeps all captured variables in memory as long as the function itself is reachable.\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Selective Retention
\f2\b0 : The engine is smart enough to only retain variables that are actually referenced in the closure, not the entire scope.\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Potential Memory Leaks
\f2\b0 : Closures can lead to memory leaks if you inadvertently keep references to large objects that are no longer needed.\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Automatic Cleanup
\f2\b0 : When no references to a closure remain, both the closure and its environment will be garbage collected.\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 function potentialLeak() \{\
  // Large data structure\
  const hugeData = new Array(1000000).fill("data");\
  \
  // This closure references hugeData\
  function processingFunction() \{\
    return hugeData.length;\
  \}\
  \
  // This closure doesn't reference hugeData\
  function safeFunction() \{\
    return "Safe result";\
  \}\
  \
  // processingFunction retains hugeData in memory\
  // safeFunction doesn't retain hugeData\
  \
  return \{\
    withReference: processingFunction,\
    withoutReference: safeFunction\
  \};\
\}\
\
const result = potentialLeak();\
// hugeData is still in memory because processingFunction references it\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 To avoid memory leaks, it's good practice to:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls39\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Only capture what you need in closures\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Set captured references to null when you're done with them\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Be mindful of large objects in closure scope\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-K8D8CEb5RoM0lqWAooJT-practical-uses-of-closures"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Practical Uses of Closures\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Closures enable several powerful programming patterns:\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-K8D8CEb5RoM0lqWAooJT-id-1.-data-encapsulation-and-privacy"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 1. Data Encapsulation and Privacy\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Closures provide a way to create private variables that can't be accessed directly from outside:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 function createUser(name, initialBalance) \{\
  // Private variables\
  let userName = name;\
  let balance = initialBalance;\
  \
  return \{\
    getName: () => userName,\
    getBalance: () => balance,\
    deposit: amount => \{\
      balance += amount;\
      return balance;\
    \},\
    withdraw: amount => \{\
      if (amount <= balance) \{\
        balance -= amount;\
        return balance;\
      \}\
      return "Insufficient funds";\
    \}\
  \};\
\}\
\
const user = createUser("Alice", 100);\
console.log(user.getBalance()); // 100\
user.deposit(50);\
console.log(user.getBalance()); // 150\
// Cannot access balance directly\
console.log(user.balance);      // undefined\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-K8D8CEb5RoM0lqWAooJT-id-2.-function-factories"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 2. Function Factories\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Closures allow you to create specialized functions based on parameters:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 function createValidator(validationFn, errorMessage) \{\
  return function(value) \{\
    if (!validationFn(value)) \{\
      return \{ valid: false, error: errorMessage \};\
    \}\
    return \{ valid: true \};\
  \};\
\}\
\
const validateEmail = createValidator(\
  email => /^[^@]+@[^@]+\\.[^@]+$/.test(email),\
  "Invalid email format"\
);\
\
const validatePassword = createValidator(\
  password => password.length >= 8,\
  "Password must be at least 8 characters"\
);\
\
console.log(validateEmail("user@example.com")); // \{ valid: true \}\
console.log(validatePassword("123"));          // \{ valid: false, error: "Password must be at least 8 characters" \}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-K8D8CEb5RoM0lqWAooJT-id-3.-maintaining-state-in-async-operations"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 3. Maintaining State in Async Operations\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Closures are invaluable for preserving state across asynchronous operations:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 function processUserData(userId) \{\
  // State captured in closure\
  const processingStart = Date.now();\
  const metrics = \{ steps: 0 \};\
  \
  // Get user data\
  fetchUser(userId).then(userData => \{\
    metrics.steps++;\
    \
    // Process user preferences\
    return fetchPreferences(userData.preferencesId).then(preferences => \{\
      metrics.steps++;\
      \
      // Combine data\
      const result = \{\
        user: userData,\
        preferences: preferences,\
        processingTime: Date.now() - processingStart,\
        processingSteps: metrics.steps\
      \};\
      \
      // All async operations have access to the same captured state\
      displayResults(result);\
    \});\
  \});\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-K8D8CEb5RoM0lqWAooJT-id-4.-event-handlers-with-preset-data"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 4. Event Handlers with Preset Data\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Closures are perfect for creating event handlers that include specific data:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 function setupButtonHandlers(buttons) \{\
  buttons.forEach(button => \{\
    // Each handler is a closure with its own reference to the specific button\
    button.addEventListener('click', () => \{\
      console.log(`Button $\{button.id\} was clicked`);\
      processButtonAction(button.dataset.action);\
    \});\
  \});\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-K8D8CEb5RoM0lqWAooJT-closures-in-happens-event-continuum"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Closures in Happen's Event Continuum\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 In Happen, closures provide an elegant solution for managing dependencies and state across event flows:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 function setupOrderProcessing(orderRepository, emailService) \{\
  const orderNode = createNode('order-service');\
  \
  orderNode.on('process-order', event => \{\
    // Initialize flow state\
    const state = \{\
      orderId: generateOrderId(),\
      items: event.payload.items,\
      customer: event.payload.customer\
    \};\
    \
    // Return first step with dependencies and state in closure\
    return validateOrder(orderRepository, emailService, state);\
  \});\
  \
  return orderNode;\
\}\
\
function validateOrder(repository, emailService, state) \{\
  // Return a handler function that has captured dependencies and state\
  return (event, context) => \{\
    // Validate using captured state\
    const validationResult = validateItems(state.items);\
    \
    if (!validationResult.valid) \{\
      return \{ success: false, errors: validationResult.errors \};\
    \}\
    \
    // Update state immutably\
    const updatedState = \{\
      ...state,\
      validatedAt: Date.now()\
    \};\
    \
    // Return next step with updated state\
    return processPayment(repository, emailService, updatedState);\
  \};\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This pattern provides several benefits:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls40\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Explicit Dependency Injection
\f2\b0 : Dependencies are passed explicitly rather than through global state\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Immutable State Flow
\f2\b0 : State changes are explicit and traceable\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Testable Units
\f2\b0 : Each step can be tested independently with mocked dependencies\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Freedom from Context
\f2\b0 : No need to rely on the event context for state\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-K8D8CEb5RoM0lqWAooJT-best-practices-for-closures"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Best Practices for Closures\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 To use closures effectively:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls41\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Keep closures focused
\f2\b0 : Capture only what you need to minimize memory usage.\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Use immutable patterns
\f2\b0 : Update state by creating new objects rather than mutating existing ones.\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Be mindful of 
\f6\fs21 \cb7 this
\f2\b0\fs24 \cb4 : Arrow functions capture the lexical 
\f4\fs21 \cb7 this
\f2\fs24 \cb4 , while regular functions have their own 
\f4\fs21 \cb7 this
\f2\fs24 \cb4  context.\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Watch for circular references
\f2\b0 : These can prevent garbage collection.\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Prefer pure functions
\f2\b0 : Closures that don't modify external state are easier to reason about.\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Consider performance
\f2\b0 : For extremely hot code paths, be aware that closures have a small overhead compared to direct function calls.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 By understanding and leveraging closures effectively, you can create elegant, maintainable code that naturally manages dependencies and state throughout your Happen applications.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs72 \cf3 \cb4 The Information System: State, Context, and Views\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 In Happen, information flows naturally through the system in multiple complementary forms. The Information System builds on our core primitives\'97Nodes and Events\'97while providing powerful capabilities for managing, accessing, and transforming information across your application. This document explains the conceptual model and practical implementation of state, context, and views in Happen.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 The Information System is built on three fundamental concepts:\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-Dz0hhYoMhaKPlQeWtUhD-state-what-you-own"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 State: What You Own\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 State is information that a node has authority over. It's the internal data that the node manages, updates, and is responsible for. State represents "what you know and control" within your domain.\cb1 \
\cb4 State in Happen is:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls42\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Authoritative
\f2\b0  - The owning node is the single source of truth\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Persisted
\f2\b0  - State can be saved and restored\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Encapsulated
\f2\b0  - Direct modification is restricted to the owning node\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Verifiable
\f2\b0  - State changes are tracked in the causal chain\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Basic state access\
const orderNode = createNode("order-service");\
\
// Read state directly\
const state = orderNode.state.get();\
const pendingOrders = Object.values(state.orders || \{\})\
  .filter(order => order.status === "pending");\
\
// Transform state using a function approach\
orderNode.state.set(state => \{\
  return \{\
    ...state,\
    orders: \{\
      ...state.orders,\
      "order-123": \{\
        customerId: "cust-456",\
        items: [\{productId: "prod-789", quantity: 2\}],\
        status: "pending"\
      \}\
    \}\
  \};\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 State can also be accessed selectively, using transformations to extract only the required data:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Focused state access\
const activeOrderCount = orderNode.state.get(state => \
  Object.values(state.orders || \{\})\
    .filter(order => order.status === "active")\
    .length\
);\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-Dz0hhYoMhaKPlQeWtUhD-global-state-implementation"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Global State Implementation\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen's provides system-wide, crossboundary global state for universal data access throughout the unified event space. Global state is implemented using NATS Key-Value store and is accessible from all environments:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls43\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Unified Access
\f2\b0 : All nodes use the same 
\f4\fs21 \cb7 node.global
\f2\fs24 \cb4  API regardless of environment\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Native Transport Adapters
\f2\b0 : NATS provides native support for various transports:\cb1 \
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\partightenfactor0
\ls43\ilvl1
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 TCP for server-to-server communication\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 WebSocket for browser and edge clients\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 TLS/WSS for secure communication\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls43\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Consistent Experience
\f2\b0 : The same operations work identically across all environments\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 This approach leverages NATS' built-in transport capabilities to provide a seamless global state experience without requiring custom protocol adaptations.\cb1 \
\cb4 For example, storing and retrieving data works the same way everywhere:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Store data in global state\
await node.global.set('user:profile:123', userProfile);\
\
// Retrieve data from global state\
const profile = await node.global.get('user:profile:123');\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-Dz0hhYoMhaKPlQeWtUhD-context-what-happened-and-why"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Context: What Happened and Why\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Context is information that flows with events, providing essential metadata about causality, origin, and relationships. Context represents the "why" and "how" of information flow in the system.\cb1 \
\cb4 Context in Happen is:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls44\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Causal
\f2\b0  - Tracks relationships between events\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Automatic
\f2\b0  - Flows naturally with events\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Enriched
\f2\b0  - Gains additional information as it flows\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Structured
\f2\b0  - Organized into specific categories\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Event with context\
orderNode.broadcast(\{\
  type: "order-created",\
  payload: \{\
    orderId: "ORD-123",\
    items: [\{ productId: "PROD-456", quantity: 2 \}]\
  \}\
  // Context is automatically managed by the framework\
  // context: \{\
  //   causal: \{\
  //     id: "evt-789", // Unique identifier\
  //     sender: "order-service", // Origin node\
  //     causationId: "evt-456", // Direct cause\
  //     correlationId: "order-123", // Transaction identifier\
  //     path: ["customer-node", "order-service"] // Event path\
  //   \},\
  //   system: \{\
  //     environment: "production",\
  //     region: "us-west"\
  //   \},\
  //   user: \{\
  //     id: "user-123",\
  //     permissions: ["create-order"]\
  //   \}\
  // \}\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 Context is system-managed and automatically flows with events, requiring no manual manipulation.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-Dz0hhYoMhaKPlQeWtUhD-views-windows-into-other-nodes"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Views: Windows Into Other Nodes\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Views in Happen provide a window into other nodes' state, enabling coordinated operations across node boundaries. While conceptually simple, views are implemented using an elegant recursive traversal approach that leverages JavaScript's reference passing.\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f1\b \cf3 \cb4 The Recursive Reference Collection Mechanism
\f2\b0 \cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 At the core of Happen's view implementation is a recursive traversal of the node graph, combined with a shared reference mechanism.\cb1 \
\cb4 When a node accesses a view, the system:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls45\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Creates a shared reference container (typically an object or array)\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Passes this container to the target node\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 The target node deposits its state into the container\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 The original node can then access this state through the container\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 This mechanism provides several key advantages:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls46\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Performance
\f2\b0 : No need to copy large state objects\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Freshness
\f2\b0 : Always gets the latest state when accessed\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Simplicity
\f2\b0 : Minimal API surface for powerful functionality\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Consistency
\f2\b0 : Predictable access patterns across different node types\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f1\b \cf3 \cb4 Basic View Usage
\f2\b0 \cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Transform state with views into other nodes' state\
orderNode.state.set((state, views) => \{\
  // Access customer data through views\
  const customerData = views.customer.get(state => \
    state.customers[order.customerId]\
  );\
  \
  // Access inventory data through views\
  const inventoryData = views.inventory.get(state =>\
    state.products[order.productId]\
  );\
  \
  // Return updated state that incorporates external data\
  return \{\
    ...state,\
    orders: \{\
      ...state.orders,\
      [order.id]: \{\
        ...order,\
        canShip: inventoryData.inStock,\
        shippingAddress: customerData.address\
      \}\
    \}\
  \};\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f1\b\fs24 \cf3 \cb4 Enhanced View Collection
\f2\b0 \cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 For more efficient collection of state from multiple nodes in a single operation, Happen provides an enhanced collection capability:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 orderNode.state.set((state, views) => \{\
  // Collect state from multiple nodes in a single operation\
  const data = views.collect(\{\
    customer: state => (\{\
      name: state.customers[order.customerId].name,\
      address: state.customers[order.customerId].address\
    \}),\
    inventory: state => (\{\
      inStock: state.products[order.productId].quantity > 0,\
      leadTime: state.products[order.productId].leadTime\
    \}),\
    shipping: state => (\{\
      rates: state.ratesByRegion[customerRegion],\
      methods: state.availableMethods\
    \})\
  \});\
  \
  // Use the collected data\
  return \{\
    ...state,\
    orders: \{\
      ...state.orders,\
      [order.id]: \{\
        ...order,\
        fulfillmentPlan: createFulfillmentPlan(data)\
      \}\
    \}\
  \};\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This approach:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls47\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Traverses the node graph only once\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Collects specific slices of state from each relevant node\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Transforms the state during collection\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Returns a unified object with all the collected data\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 For more advanced view patterns and usage, see the dedicated {\field{\*\fldinst{HYPERLINK "https://claude.ai/chat/state-management.md"}}{\fldrslt \cf5 \ul \ulc5 \strokec5 State Management}} page.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-Dz0hhYoMhaKPlQeWtUhD-the-unified-information-system"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 The Unified Information System\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 These three concepts\'97State, Context, and Views\'97form a unified information model:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls48\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 State represents what a node owns and controls\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Context represents the causal flow of information through events\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Views represent windows into state owned by others\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 Each serves a distinct purpose in the system, creating a complete information model without redundancy or overlap.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-Dz0hhYoMhaKPlQeWtUhD-how-these-systems-work-together"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 How These Systems Work Together\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The power of Happen's information system comes from how these complementary systems work together:\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-Dz0hhYoMhaKPlQeWtUhD-context--views"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Context + Views\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Context and views work together to provide a complete picture of system behavior:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Both context and views working together\
orderNode.on("payment-received", event => \{\
  const \{ orderId, amount \} = event.payload;\
  const \{ correlationId \} = event.context.causal;\
  \
  // Update order with view-aware state transformation\
  orderNode.state.set((state, views) => \{\
    // Get the current order\
    const currentOrder = state.orders[orderId];\
    \
    // Collect payment information through enhanced views\
    const paymentData = views.collect(\{\
      payments: state => (\{\
        details: state[event.payload.paymentId],\
        methods: state.methods\
      \})\
    \});\
    \
    // Return updated state\
    return \{\
      ...state,\
      orders: \{\
        ...state.orders,\
        [orderId]: \{\
          ...currentOrder,\
          status: "paid",\
          paymentId: event.payload.paymentId,\
          paymentMethod: paymentData.payments.details.method,\
          transactionId: paymentData.payments.details.transactionId,\
          correlationId: correlationId, // From context\
          paymentTimestamp: Date.now()\
        \}\
      \}\
    \};\
  \});\
  \
  // Emit event with proper context\
  orderNode.broadcast(\{\
    type: "order-paid",\
    payload: \{\
      orderId,\
      amount\
    \}\
    // Context is automatically managed by the framework\
  \});\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-Dz0hhYoMhaKPlQeWtUhD-state--context-causal-state-history"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 State + Context = Causal State History\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The combination of state and context enables rich causal state history:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // State history using context\
function getStateHistory(nodeId, statePath) \{\
  // Get all events that affected this state path\
  const events = eventStore.getEventsForPath(nodeId, statePath);\
  \
  // Sort by causal order using context information\
  const sortedEvents = sortByCausalOrder(events);\
  \
  // Reconstruct state history\
  let state = undefined;\
  const history = [];\
  \
  for (const event of sortedEvents) \{\
    state = applyEvent(state, event);\
    history.push(\{\
      state: \{ ...state \},\
      event: event.type,\
      timestamp: event.metadata.timestamp,\
      causedBy: event.context.causal.causationId,\
      by: event.context.causal.sender\
    \});\
  \}\
  \
  return history;\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-Dz0hhYoMhaKPlQeWtUhD-state--views-system-wide-view"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 State + Views = System-Wide View\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The combination of state and views provides a system-wide view:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // System-wide view using state and views\
dashboardNode.on("generate-dashboard", event => \{\
  // Use view-aware state transformation to gather system-wide data\
  dashboardNode.state.set((state, views) => \{\
    // Collect data from various services through enhanced views\
    const systemData = views.collect(\{\
      orders: state => (\{\
        pending: Object.values(state).filter(o => o.status === "pending").length,\
        completed: Object.values(state).filter(o => o.status === "completed").length,\
        failed: Object.values(state).filter(o => o.status === "failed").length\
      \}),\
      inventory: state => (\{\
        lowStock: Object.values(state.products).filter(p => p.stock < 10).length,\
        outOfStock: Object.values(state.products).filter(p => p.stock === 0).length\
      \}),\
      customers: state => (\{\
        active: Object.values(state).filter(c => c.active).length,\
        new: Object.values(state).filter(c => \{\
          const oneDayAgo = Date.now() - (24 * 60 * 60 * 1000);\
          return c.createdAt >= oneDayAgo;\
        \}).length\
      \}),\
      payments: state => (\{\
        daily: Object.values(state)\
          .filter(p => p.timestamp >= Date.now() - (24 * 60 * 60 * 1000))\
          .reduce((sum, p) => sum + p.amount, 0),\
        weekly: Object.values(state)\
          .filter(p => p.timestamp >= Date.now() - (7 * 24 * 60 * 60 * 1000))\
          .reduce((sum, p) => sum + p.amount, 0)\
      \})\
    \});\
    \
    // Return updated dashboard state\
    return \{\
      ...state,\
      dashboard: systemData\
    \};\
  \});\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-Dz0hhYoMhaKPlQeWtUhD-practical-example-coordinated-operations"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Practical Example: Coordinated Operations\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Here's a complete example showing how views enable coordinated operations across node boundaries:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Order fulfillment process using views\
fulfillmentNode.on('fulfill-order', (event) => \{\
  const \{ orderId \} = event.payload;\
  \
  // Update fulfillment state based on views of other nodes\
  fulfillmentNode.state.set((state, views) => \{\
    // Collect data from multiple services in one operation\
    const fulfillmentData = views.collect(\{\
      orders: state => \{\
        const order = state[orderId];\
        return order ? \{ order \} : null;\
      \},\
      inventory: state => (\{\
        products: state.products\
      \}),\
      customers: state => \{\
        // We need the order first to get the customerId\
        const order = views.orders.get(s => s[orderId]);\
        if (!order) return null;\
        return \{\
          customer: state.customers[order.customerId]\
        \};\
      \},\
      shipping: state => (\{\
        rates: state.rates\
      \})\
    \});\
    \
    // Check if order exists\
    if (!fulfillmentData.orders) \{\
      return state; // No change\
    \}\
    \
    const order = fulfillmentData.orders.order;\
    const customer = fulfillmentData.customers?.customer;\
    \
    if (!customer) \{\
      return state; // No change, customer not found\
    \}\
    \
    // Check inventory availability\
    const itemsAvailable = order.items.every(item => \{\
      const product = fulfillmentData.inventory.products[item.productId];\
      return product && product.stock >= item.quantity;\
    \});\
    \
    if (!itemsAvailable) \{\
      return state; // No change, items not available\
    \}\
    \
    // Get shipping option\
    const shippingOption = fulfillmentData.shipping.rates[customer.region].standard;\
    \
    // Return updated fulfillment state\
    return \{\
      ...state,\
      fulfillments: \{\
        ...state.fulfillments,\
        [orderId]: \{\
          orderId,\
          items: order.items,\
          customer: \{\
            id: order.customerId,\
            name: customer.name,\
            address: customer.address\
          \},\
          shippingMethod: shippingOption.method,\
          shippingCost: shippingOption.cost,\
          estimatedDelivery: calculateDelivery(customer.address, shippingOption),\
          status: "ready",\
          createdAt: Date.now()\
        \}\
      \}\
    \};\
  \});\
  \
  // Check if fulfillment was created\
  const fulfillment = fulfillmentNode.state.get(state => \
    state.fulfillments?.[orderId]\
  );\
  \
  if (!fulfillment) \{\
    return \{\
      success: false,\
      reason: "Could not create fulfillment"\
    \};\
  \}\
  \
  // Continue to next step\
  return initiateShipment;\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 The Information System provides a complete model for managing, accessing, and transforming information through three complementary concepts:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls49\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 State
\f2\b0 : What nodes own and control\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Context
\f2\b0 : The causal flow of information through events\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Views
\f2\b0 : Windows into state owned by others\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 Each plays a distinct role, working together to create a powerful yet conceptually clean information model:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls50\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 State provides ownership and authority\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Context provides causality and correlation\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Views provide access and visibility\cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 With enhanced view collection capabilities, the Information System enables complex, coordinated operations across node boundaries while maintaining clean separation of concerns and adhering to Happen's philosophy of radical simplicity.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs72 \cf3 \cb4 State Management\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 State management in Happen provides powerful capabilities through minimal abstractions. This guide explores patterns and approaches for effectively managing state across your Happen applications.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-otClASbiLgV2BqVQRqQ9-core-principles"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Core Principles\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen's approach to state management follows these foundational principles:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls51\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Clear Ownership
\f2\b0 : Each node owns and is responsible for its specific state\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Functional Transformations
\f2\b0 : State changes occur through pure functional transformations\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Event-Driven Updates
\f2\b0 : State typically changes in response to events\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Decentralized Intelligence
\f2\b0 : Nodes make autonomous decisions based on their local state\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Composition Over Complexity
\f2\b0 : Complex state management emerges from composing simple patterns\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 Under the hood, Happen uses NATS JetStream's Key-Value store to provide durable, distributed state storage with high consistency guarantees.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-otClASbiLgV2BqVQRqQ9-basic-state-operations"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Basic State Operations\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-otClASbiLgV2BqVQRqQ9-accessing-state"}}{\fldrslt 
\f5\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Accessing State\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen provides a clean, functional approach to accessing state:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Access the complete state\
const orderState = orderNode.state.get();\
\
// Access with transformation (focused state access)\
const activeOrders = orderNode.state.get(state =>\
  (state.orders || \{\}).filter(order => order.status === "active")\
);\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-otClASbiLgV2BqVQRqQ9-transforming-state"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Transforming State\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 State transformations use a functional approach:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Transform state with a function\
orderNode.state.set(state => \{\
  return \{\
    ...state,\
    orders: \{\
      ...state.orders,\
      "order-123": \{\
        ...state.orders["order-123"],\
        status: "shipped",\
        shippedAt: Date.now()\
      \}\
    \}\
  \};\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-otClASbiLgV2BqVQRqQ9-composing-transformations"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Composing Transformations\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 You can compose transformations for cleaner code:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Define reusable transformers\
const markShipped = (orderId) => (state) => (\{\
  ...state,\
  orders: \{\
    ...state.orders,\
    [orderId]: \{\
      ...state.orders[orderId],\
      status: "shipped",\
      shippedAt: Date.now()\
    \}\
  \}\
\});\
\
// Apply transformer\
orderNode.state.set(markShipped("order-123"));\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-otClASbiLgV2BqVQRqQ9-view-system"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 View System\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Views provide a window into other nodes' state, enabling coordinated operations across node boundaries.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-otClASbiLgV2BqVQRqQ9-basic-view-usage"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Basic View Usage\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Transform state with views into other nodes' state\
orderNode.state.set((state, views) => \{\
  // Get customer data through views\
  const customerData = views.customer.get(state =>\
    state.customers[order.customerId]\
  );\
  \
  // Get inventory data through views\
  const inventoryData = views.inventory.get(state =>\
    state.products[order.productId]\
  );\
  \
  // Return updated state that incorporates external data\
  return \{\
    ...state,\
    orders: \{\
      ...state.orders,\
      [order.id]: \{\
        ...order,\
        canShip: inventoryData.inStock,\
        shippingAddress: customerData.address\
      \}\
    \}\
  \};\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-otClASbiLgV2BqVQRqQ9-enhanced-collection"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Enhanced Collection\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 For more efficient collection of state from multiple nodes, use the collect pattern:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 orderNode.state.set((state, views) => \{\
  // Collect state from multiple nodes in a single operation\
  const data = views.collect(\{\
    customer: state => (\{\
      name: state.customers[order.customerId].name,\
      address: state.customers[order.customerId].address\
    \}),\
    inventory: state => (\{\
      inStock: state.products[order.productId].quantity > 0,\
      leadTime: state.products[order.productId].leadTime\
    \}),\
    shipping: state => (\{\
      rates: state.ratesByRegion[customerRegion],\
      methods: state.availableMethods\
    \})\
  \});\
  \
  // Use the collected data\
  return \{\
    ...state,\
    orders: \{\
      ...state.orders,\
      [order.id]: \{\
        ...order,\
        fulfillmentPlan: createFulfillmentPlan(data)\
      \}\
    \}\
  \};\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This approach:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls52\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Traverses the node graph only once\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Collects specific slices of state from each relevant node\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Transforms the state during collection\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Returns a unified object with all the collected data\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-otClASbiLgV2BqVQRqQ9-scaling-patterns"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Scaling Patterns\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 As your application grows, these patterns help manage increasing state complexity.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-otClASbiLgV2BqVQRqQ9-selective-state-access"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Selective State Access\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Access only what you need to minimize memory footprint:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Instead of loading the entire state\
const allOrders = orderNode.state.get();\
\
// Access only what you need\
const orderCount = orderNode.state.get(state =>\
  Object.keys(state.orders || \{\}).length\
);\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-otClASbiLgV2BqVQRqQ9-domain-partitioning"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Domain Partitioning\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Partition state across multiple domain-specific nodes:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Instead of one large node with all state\
const monolithNode = createNode("monolith");\
\
// Create domain-specific nodes\
const orderNode = createNode("order-service");\
const customerNode = createNode("customer-service");\
const inventoryNode = createNode("inventory-service");\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 Each node maintains state for its specific domain, communicating via events when necessary.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-otClASbiLgV2BqVQRqQ9-event-driven-state-synchronization"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Event-Driven State Synchronization\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Use events to communicate state changes between nodes:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // When state changes, broadcast an event\
orderNode.on("update-order", event => \{\
  // Update local state\
  orderNode.state.set(state => (\{\
    ...state,\
    orders: \{\
      ...state.orders,\
      [event.payload.orderId]: event.payload\
    \}\
  \}));\
  \
  // Broadcast change event\
  orderNode.broadcast(\{\
    type: "order-updated",\
    payload: \{\
      orderId: event.payload.orderId,\
      status: event.payload.status\
    \}\
  \});\
\});\
\
// Other nodes maintain caches of relevant order data\
dashboardNode.on("order-updated", event => \{\
  // Update local cache\
  dashboardNode.state.set(state => (\{\
    ...state,\
    orderCache: \{\
      ...state.orderCache,\
      [event.payload.orderId]: \{\
        status: event.payload.status,\
        updatedAt: Date.now()\
      \}\
    \}\
  \}));\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-otClASbiLgV2BqVQRqQ9-chunked-processing"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Chunked Processing\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 For large state objects, process in manageable chunks:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 orderNode.on("process-large-dataset", async function* (event) \{\
  const \{ dataset \} = event.payload;\
  \
  // Process in chunks\
  for (let i = 0; i < dataset.length; i += 100) \{\
    const chunk = dataset.slice(i, i + 100);\
    \
    // Process this chunk\
    for (const item of chunk) \{\
      processItem(item);\
    \}\
    \
    // Yield progress\
    yield \{\
      progress: Math.round((i + chunk.length) / dataset.length * 100),\
      processed: i + chunk.length\
    \};\
  \}\
  \
  return \{ completed: true \};\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-otClASbiLgV2BqVQRqQ9-advanced-patterns"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Advanced Patterns\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-otClASbiLgV2BqVQRqQ9-state-versioning"}}{\fldrslt 
\f5\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 State Versioning\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Track state versions for debugging and auditing:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Modify state with version tracking\
orderNode.state.set(state => \{\
  const newVersion = (state.version || 0) + 1;\
  \
  return \{\
    ...state,\
    version: newVersion,\
    orders: \{\
      ...state.orders,\
      "order-123": \{\
        ...state.orders["order-123"],\
        status: "processing",\
        updatedAt: Date.now(),\
        version: newVersion\
      \}\
    \}\
  \};\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-otClASbiLgV2BqVQRqQ9-computed-state"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Computed State\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Define computed values based on raw state:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 orderNode.state.set((state, views) => \{\
  // Compute derived values\
  const orderSummary = Object.values(state.orders || \{\}).reduce((summary, order) => \{\
    summary.total += order.total;\
    summary.count += 1;\
    summary[order.status] = (summary[order.status] || 0) + 1;\
    return summary;\
  \}, \{ total: 0, count: 0 \});\
  \
  // Return state with computed values\
  return \{\
    ...state,\
    computed: \{\
      ...state.computed,\
      orderSummary,\
      averageOrderValue: orderSummary.count > 0 ?\
        orderSummary.total / orderSummary.count : 0\
    \}\
  \};\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-otClASbiLgV2BqVQRqQ9-state-based-event-generation"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 State-Based Event Generation\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Generate events based on state conditions:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 orderNode.state.set((state, views) => \{\
  // Update order state\
  const updatedState = \{\
    ...state,\
    orders: \{\
      ...state.orders,\
      "order-123": \{\
        ...state.orders["order-123"],\
        status: "payment-received"\
      \}\
    \}\
  \};\
  \
  // Check conditions\
  const order = updatedState.orders["order-123"];\
  const inventory = views.inventory.get(state =>\
    state.products[order.productId]\
  );\
  \
  // Emit events based on state conditions\
  if (order.status === "payment-received" && inventory.inStock) \{\
    orderNode.broadcast(\{\
      type: "order-ready-for-fulfillment",\
      payload: \{ orderId: "order-123" \}\
    \});\
  \}\
  \
  return updatedState;\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-otClASbiLgV2BqVQRqQ9-nats-jetstream-key-value-store-integration"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 NATS JetStream Key-Value Store Integration\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Under the hood, Happen uses NATS JetStream's Key-Value store capability to provide durable, distributed state storage. The framework handles all the details of storing and retrieving state, ensuring:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls53\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Persistence
\f2\b0 : State is preserved even if nodes or processes restart\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Distributed Access
\f2\b0 : State can be accessed across different processes and machines\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Consistency
\f2\b0 : State updates maintain causal ordering\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Performance
\f2\b0 : High-performance storage with minimal overhead\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 This integration happens transparently - your code uses the same state API regardless of where nodes are running or how state is stored.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-otClASbiLgV2BqVQRqQ9-best-practices"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Best Practices\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-otClASbiLgV2BqVQRqQ9-keep-state-focused"}}{\fldrslt 
\f5\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Keep State Focused\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Each node should maintain state relevant to its domain:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Too broad - mixing domains\
const monolithNode = createNode("app");\
monolithNode.state.set(\{\
  orders: \{ /* ... */ \},\
  customers: \{ /* ... */ \},\
  inventory: \{ /* ... */ \},\
  shipping: \{ /* ... */ \}\
\});\
\
// Better - focused domains\
const orderNode = createNode("orders");\
orderNode.state.set(\{ orders: \{ /* ... */ \} \});\
\
const customerNode = createNode("customers");\
customerNode.state.set(\{ customers: \{ /* ... */ \} \});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-otClASbiLgV2BqVQRqQ9-use-immutable-patterns"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Use Immutable Patterns\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Always update state immutably to maintain predictability:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // AVOID: Direct mutation\
orderNode.state.set(state => \{\
  state.orders["order-123"].status = "shipped"; // Mutation!\
  return state;\
\});\
\
// BETTER: Immutable updates\
orderNode.state.set(state => (\{\
  ...state,\
  orders: \{\
    ...state.orders,\
    "order-123": \{\
      ...state.orders["order-123"],\
      status: "shipped"\
    \}\
  \}\
\}));\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-otClASbiLgV2BqVQRqQ9-prefer-event-communication"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Prefer Event Communication\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Use events to communicate state changes between nodes:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // When state changes\
orderNode.state.set(/* update state */);\
\
// Broadcast the change\
orderNode.broadcast(\{\
  type: "order-status-changed",\
  payload: \{\
    orderId: "order-123",\
    status: "shipped"\
  \}\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-otClASbiLgV2BqVQRqQ9-let-event-flow-drive-state-changes"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Let Event Flow Drive State Changes\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Instead of directly modifying state in response to external conditions, let events drive state changes:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Respond to events with state transformations\
orderNode.on("payment-received", event => \{\
  orderNode.state.set(state => (\{\
    ...state,\
    orders: \{\
      ...state.orders,\
      [event.payload.orderId]: \{\
        ...state.orders[event.payload.orderId],\
        status: "paid",\
        paymentId: event.payload.paymentId,\
        paidAt: Date.now()\
      \}\
    \}\
  \}));\
\});\cb1 \
\pard\pardeftab720\partightenfactor0

\f2\fs24 \cf3 \cb4 By focusing on clear ownership, functional transformations, and event-driven communication, you can create systems that are both powerful and maintainable. The integration with NATS JetStream's Key-Value store provides a robust foundation for distributed state management without adding complexity to your application code.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs72 \cf3 \cb4 Data Flow\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 Happen offers a unique approach to system design by providing two complementary layers that form a cohesive fabric for the movement, management, and manipulation of data: an event system and a state system. Rather than forcing you to choose between these approaches, Happen enables you to use both simultaneously, allowing you to leverage the strengths of each where appropriate.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-z4Jes3RPdaCAB03YhZGv-two-complementary-layers"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Two Complementary Layers\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 At the heart of Happen are two fundamentally different but complementary architectural layers:\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-z4Jes3RPdaCAB03YhZGv-event-system-the-communication-layer"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Event System: The Communication Layer\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The event system forms the communication layer where nodes interact through message passing. Each event represents something that happened, and nodes react to these events by processing them and potentially emitting new events.\cb1 \
\cb4 This layer excels at modeling:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls54\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Distributed systems where components operate independently\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Real-time reactions to external stimuli\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Complex communication patterns with rich history tracking\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Systems where the sequence and timing of interactions matter\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-z4Jes3RPdaCAB03YhZGv-state-system-the-data-layer"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 State System: The Data Layer\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The state system forms the data layer where each node manages its internal state. State evolves through well-defined transformations, and nodes can access and modify their state in a consistent manner.\cb1 \
\cb4 This layer excels at modeling:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls55\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Entity lifecycles with clear states and transformations\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Consistent, atomic updates across multiple entities\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Business processes with well-defined rules\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Systems where the current state determines what can happen next\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-z4Jes3RPdaCAB03YhZGv-distinct-apis-for-distinct-concerns"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Distinct APIs for Distinct Concerns\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen provides separate APIs for each layer, making it clear which layer you're working with:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 const orderNode = createNode("order-service");\
\
// Event System: Process events through handlers\
orderNode.on(type => type === "order-submitted", (event) => \{\
  validateOrder(event.payload);\
  orderNode.broadcast(\{\
    type: "order-validated",\
    payload: \{\
      orderId: event.payload.orderId,\
      items: event.payload.items\
    \}\
  \});\
\});\
\
// State System: Transform state through the .state namespace\
orderNode.state.set(state => \{\
  return \{\
    ...state,\
    orders: \{\
      ...state.orders,\
      "order-123": \{\
        ...state.orders["order-123"],\
        status: "processing",\
        processedAt: Date.now()\
      \}\
    \}\
  \};\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This clear separation of concerns allows you to use the right tool for each task without artificial constraints.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-z4Jes3RPdaCAB03YhZGv-layer-interaction"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Layer Interaction\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 While the event and state layers are conceptually distinct, they interact seamlessly within nodes:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Event processing triggering state changes\
paymentNode.on(type => type === "payment-received", (event) => \{\
  const \{ orderId, amount \} = event.payload;\
  \
  // Process the payment\
  const result = processPayment(event.payload);\
  \
  // Update state in response to the event\
  paymentNode.state.set(state => \{\
    const orders = state.orders || \{\};\
    const order = orders[orderId] || \{\};\
    \
    return \{\
      ...state,\
      orders: \{\
        ...orders,\
        [orderId]: \{\
          ...order,\
          paymentStatus: "paid",\
          paymentId: result.transactionId,\
          paidAt: Date.now()\
        \}\
      \}\
    \};\
  \});\
  \
  // Emit another event based on the state change\
  paymentNode.broadcast(\{\
    type: "payment-confirmed",\
    payload: \{\
      orderId,\
      transactionId: result.transactionId\
    \}\
  \});\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This ability to seamlessly move between layers allows you to create systems where communication and state management work together naturally.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-z4Jes3RPdaCAB03YhZGv-state-operations"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 State Operations\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The state system provides powerful capabilities for managing state at different granularities.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-z4Jes3RPdaCAB03YhZGv-individual-entity-operations"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Individual Entity Operations\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 For focused state updates on specific entities:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Individual entity transformation\
orderNode.state.set(state => \{\
  const orders = state.orders || \{\};\
  const order = orders["order-123"] || \{\};\
  \
  return \{\
    ...state,\
    orders: \{\
      ...orders,\
      "order-123": \{\
        ...order,\
        status: "processing"\
      \}\
    \}\
  \};\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-z4Jes3RPdaCAB03YhZGv-multi-entity-operations"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Multi-Entity Operations\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 For operations that need to maintain consistency across multiple entities:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Multi-entity transformation\
orderNode.state.set((state, views) => \{\
  // Get state from this node\
  const orders = state.orders || \{\};\
  const order = orders["order-123"];\
  \
  if (!order) return state;\
  \
  // Get state from inventory node through views\
  const inventory = views.inventory.get();\
  \
  // Update both order and inventory\
  const updatedInventory = updateInventory(inventory, order.items);\
  \
  // Return transformed state\
  return \{\
    ...state,\
    orders: \{\
      ...orders,\
      "order-123": \{\
        ...order,\
        status: "processing"\
      \}\
    \}\
  \};\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-z4Jes3RPdaCAB03YhZGv-functional-composition"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Functional Composition\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The state system embraces functional composition as a core principle, allowing you to build complex transformations from simpler ones:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Define transformation functions\
const validateOrder = (state) => (\{\
  ...state,\
  validated: true,\
  validatedAt: Date.now()\
\});\
\
const processPayment = (state) => (\{\
  ...state,\
  paymentProcessed: true,\
  paymentProcessedAt: Date.now()\
\});\
\
const prepareShipment = (state) => (\{\
  ...state,\
  shipmentPrepared: true,\
  shipmentPreparedAt: Date.now()\
\});\
\
// Apply composed transformation\
orderNode.state.set(state => \{\
  // Get the order\
  const orders = state.orders || \{\};\
  const order = orders["order-123"] || \{\};\
  \
  // Base transformation\
  const baseState = \{\
    ...order,\
    status: "processing"\
  \};\
  \
  // Apply composed transformations\
  const processedOrder = [validateOrder, processPayment, prepareShipment]\
    .reduce((currentState, transform) => transform(currentState), baseState);\
  \
  // Return the updated state\
  return \{\
    ...state,\
    orders: \{\
      ...orders,\
      "order-123": processedOrder\
    \}\
  \};\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This functional approach allows for powerful, flexible composition without requiring special helpers or syntax.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-z4Jes3RPdaCAB03YhZGv-when-to-use-each-layer"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 When to Use Each Layer\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 While Happen allows you to freely use both layers, here are some guidelines for choosing the right approach:\cb1 \
\cb4 Use the Event System when:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls56\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 You need to communicate between nodes\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Events arrive from external sources\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 The history and sequence of interactions matter\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 You need to broadcast information to multiple recipients\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 You're modeling reactive behavior\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 Use the State System when:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls57\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 You need atomic updates to a node's state\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 State consistency is critical\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 You're working with well-defined entity lifecycles\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 You need to validate state changes before applying them\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 You're modeling procedural behavior\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-z4Jes3RPdaCAB03YhZGv-the-best-of-both-worlds"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 The Best of Both Worlds\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 By providing both event and state layers, Happen allows you to build systems that are:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls58\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Reactive to external events and stimuli\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Consistent in their state management\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Distributed across multiple components\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Predictable in their behavior\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Flexible in their evolution\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Comprehensible to developers\cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 This dual-layer architecture gives Happen a unique power: the ability to create complex systems where communication and state management work together seamlessly, using the right approach for each concern.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs72 \cf3 \cb4 Temporal State\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 In Happen, the journey is just as important as the destination. Temporal State leverages NATS JetStream's powerful capabilities to provide access to your state across time, enabling powerful historical analysis and recovery with minimal complexity.\cb1 \
\cb4 Temporal State gives nodes the ability to access and work with historical state\'97allowing you to see not just what your state 
\f7\i is
\f2\i0  now, but what it 
\f7\i was
\f2\i0  at important points in your application's history.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-Z3q4uIhCiNB8sSMqpCc5-how-temporal-state-works-with-jetstream"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 How Temporal State Works with JetStream\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 At its core, Temporal State in Happen is built on NATS JetStream's key features:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls59\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Durable Streams
\f2\b0 : JetStream stores sequences of messages with configurable retention\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Key-Value Store
\f2\b0 : Built on streams, preserves state changes as versioned entries\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Message Headers
\f2\b0 : Carry metadata about events, including causal relationships\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Event Sourcing Pattern
\f2\b0 : Natural event sourcing capabilities through message ordering\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 When an event flows through a node and modifies state, both the event and the resulting state change are recorded in JetStream:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Conceptually, a temporal state snapshot includes:\
\{\
  state: \{ /* state at this point in time */ \},\
  context: \{ // Essential event context\
    id: 'evt-456', // The event that created this state\
    causationId: 'evt-123', // What caused this event\
    correlationId: 'order-789', // Transaction this event belongs to\
    sender: 'payment-service', // Node that sent the event\
    timestamp: 1621452789000, // When it happened\
    eventType: 'payment-processed' // Type of event\
  \}\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This combination of event and state history provides a complete record of how your system evolved over time.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-Z3q4uIhCiNB8sSMqpCc5-jetstream-key-value-store-for-historical-state"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 JetStream Key-Value Store for Historical State\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen uses JetStream's Key-Value store capabilities to implement Temporal State:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Initialize with Temporal State configuration\
const happen = initializeHappen(\{\
  nats: \{\
    capabilities: \{\
      persistence: \{\
        enabled: true,\
        keyValue: \{\
          enabled: true,\
          buckets: \{\
            state: "happen-state",\
            temporal: "happen-temporal"\
          \}\
        \},\
        // Temporal state configuration\
        temporal: \{\
          enabled: true,\
          history: 100,  // Keep 100 versions per key\
          maxAge: "30d"  // Keep history for 30 days\
        \}\
      \}\
    \}\
  \}\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This configuration creates a specialized Key-Value bucket that preserves historical versions of state entries.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-Z3q4uIhCiNB8sSMqpCc5-accessing-temporal-state"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Accessing Temporal State\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen provides a clean and intuitive way to access historical state through the 
\f4\fs21 \cb7 .when()
\f2\fs24 \cb4  function:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Access state after a specific event\
orderNode.state.when('evt-123', (snapshots) => \{\
  // Work with the complete historical snapshot\
  const \{ state, context \} = snapshots[0];\
  \
  console.log(`Order status was: $\{state.orders["order-123"].status\}`);\
  console.log(`Event type: $\{context.eventType\}`);\
  console.log(`Caused by: $\{context.causationId\}`);\
  \
  return processHistoricalState(state, context);\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 The 
\f4\fs21 \cb7 when
\f2\fs24 \cb4  function follows Happen's pattern-matching approach, accepting either:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls60\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 A string event ID: 'evt-123'\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 A function matcher: 
\f4\fs21 \cb7 eventId => eventId.startsWith('payment-')
\f2\fs24 \cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-Z3q4uIhCiNB8sSMqpCc5-traversing-causal-chains"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Traversing Causal Chains\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Since each snapshot includes context information, you can easily traverse causal chains using pattern matching:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Find all states caused by a specific event\
orderNode.state.when(\
  event => event.causationId === 'evt-123',\
  (snapshots) => \{\
    // Process all snapshots directly caused by evt-123\
    const eventTypes = snapshots.map(snap => snap.context.eventType);\
    \
    console.log(`Event evt-123 caused these events: $\{eventTypes.join(', ')\}`);\
    \
    return analyzeEffects(snapshots);\
  \}\
);\
\
// Or use correlation IDs to get entire transaction flows\
orderNode.state.when(\
  event => event.correlationId === 'order-789',\
  (snapshots) => \{\
    // Process all snapshots in the transaction\
    // Arrange by timestamp to see the sequence\
    const eventSequence = [...snapshots]\
      .sort((a, b) => a.context.timestamp - b.context.timestamp)\
      .map(snap => snap.context.eventType);\
    \
    console.log(`Transaction order-789 flow: $\{eventSequence.join(' \uc0\u8594  ')\}`);\
    \
    return createAuditTrail(snapshots);\
  \}\
);\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-Z3q4uIhCiNB8sSMqpCc5-efficient-implementation-through-jetstream"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Efficient Implementation through JetStream\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Rather than storing complete copies of state for every event, Happen leverages JetStream's efficient storage capabilities:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls61\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 JetStream automatically compresses and deduplicates data\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Key revisions are tracked with minimal overhead\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 The system intelligently manages resource usage\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Historical data is pruned based on configurable policies\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 This approach balances efficient storage with powerful historical access capabilities.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-Z3q4uIhCiNB8sSMqpCc5-customizing-retention-policies"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Customizing Retention Policies\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen allows you to customize which historical states are retained through JetStream's retention policies:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Node with custom retention policy\
const orderNode = createNode('order-service', \{\
  persistence: \{\
    temporal: \{\
      history: 50,         // Keep up to 50 versions\
      maxAge: "7d",        // Keep history for 7 days\
      subject: "order.*"   // Only track states for order events\
    \}\
  \}\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This gives you control over:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls62\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 How many historical versions to keep\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 How long to keep historical versions\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Which events should create temporal snapshots\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-Z3q4uIhCiNB8sSMqpCc5-event-sourcing"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Event Sourcing\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Temporal State makes implementing the Event Sourcing pattern remarkably straightforward:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Rebuild state at a specific point in time\
orderNode.state.when('evt-123', (snapshot) => \{\
  // Replace current state with historical state\
  orderNode.state.set(() => snapshot.state);\
  \
  // Let the system know we rebuilt state\
  orderNode.broadcast(\{\
    type: 'state-rebuilt',\
    payload: \{\
      fromEvent: snapshot.context.id,\
      timestamp: snapshot.context.timestamp\
    \}\
  \});\
  \
  return \{ rebuilt: true \};\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-Z3q4uIhCiNB8sSMqpCc5-recovery-and-resilience"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Recovery and Resilience\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Temporal State provides natural resilience capabilities:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // After node restart, recover from latest known state\
function recoverLatestState() \{\
  // Find the latest event we processed before crashing\
  const latestEventId = loadLatestEventIdFromDisk();\
  \
  if (latestEventId) \{\
    // Recover state from that point\
    orderNode.state.when(latestEventId, (snapshot) => \{\
      if (snapshot) \{\
        // Restore state\
        orderNode.state.set(() => snapshot.state);\
        console.log('State recovered successfully');\
      \}\
    \});\
  \}\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-Z3q4uIhCiNB8sSMqpCc5-benefits-of-jetstream-powered-temporal-state"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Benefits of JetStream-Powered Temporal State\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen's JetStream-based approach to Temporal State offers several key advantages:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls63\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Durable History
\f2\b0 : State history persists even across system restarts\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Efficient Storage
\f2\b0 : JetStream optimizes storage with minimal overhead\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Causal Tracking
\f2\b0 : Event relationships are preserved throughout history\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Tunable Retention
\f2\b0 : Customize retention based on your specific needs\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Cross-Node Consistency
\f2\b0 : Historical state is consistent across node instances\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Performance
\f2\b0 : JetStream provides high-performance access to historical data\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Scalability
\f2\b0 : Works from single-process to globally distributed systems\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 By leveraging NATS JetStream's capabilities, Happen provides powerful temporal state features without the complexity typically associated with time-travel debugging and historical analysis.\cb1 \
\cb4 Adding the dimension of time to your application's data model, Temporal State opens up powerful capabilities with minimal added complexity. Since it builds on NATS JetStream's existing features, it provides powerful capabilities that feel natural and integrated.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 With Temporal State, your applications gain new powers for auditing, debugging, analysis, recovery, and understanding\'97all while maintaining Happen's commitment to simplicity and power through minimal primitives.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs72 \cf3 \cb4 The Unified Event Space\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 In Happen, events flow seamlessly across process, network, and environment boundaries through a unified NATS backbone. This approach eliminates the artificial boundaries typically found in distributed systems, enabling you to build applications that span multiple processes and environments with the same simplicity as local ones.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-1qSkEqXxH5AE5BS6rQfw-beyond-boundaries"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Beyond Boundaries\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen's unified event space means you write code the same way regardless of where nodes are deployed:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // The exact same code works whether nodes are:\
// - In the same process\
// - In different processes on the same machine\
// - Distributed across different machines\
// - In completely different environments (server, browser, edge)\
orderNode.send(inventoryNode, \{\
  type: "check-inventory",\
  payload: \{ orderId: "123", items: [...] \}\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This isn't just an API convenience\'97it's a fundamental design principle that creates location transparency throughout your system. Nodes can be deployed wherever makes the most sense for your architecture, and your code remains unchanged.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-1qSkEqXxH5AE5BS6rQfw-how-the-unified-event-space-works"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 How the Unified Event Space Works\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 At the heart of Happen's unified event space is the NATS messaging system with its JetStream persistence layer. When an event crosses boundaries:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls64\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 The event is automatically serialized using MessagePack\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 NATS delivers it to the appropriate destination\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 The event is deserialized on arrival\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 The receiving node processes it using standard event handlers\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 All of this happens transparently\'97your code simply uses 
\f4\fs21 \cb7 send()
\f2\fs24 \cb4  and 
\f4\fs21 \cb7 on()
\f2\fs24 \cb4  without needing to know whether communication is local or remote.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-1qSkEqXxH5AE5BS6rQfw-cross-boundary-serialization"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Cross-Boundary Serialization\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 When events cross process or network boundaries in Happen, they are efficiently handled through a streamlined serialization strategy:\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-1qSkEqXxH5AE5BS6rQfw-json-interface-binary-transport"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 JSON Interface, Binary Transport\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen provides a natural JSON-like interface for developers while using efficient binary serialization under the hood:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls65\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Developer Experience
\f2\b0 : Work with standard JavaScript objects in your code\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Transport Efficiency
\f2\b0 : MessagePack binary format used for actual transmission\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Transparent Conversion
\f2\b0 : Serialization/deserialization happens automatically\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 No Schema Required
\f2\b0 : Maintains Happen's schema-free flexibility\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 This approach gives you the best of both worlds - the simplicity of working with native JavaScript objects and the efficiency of binary transport.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-1qSkEqXxH5AE5BS6rQfw-preserving-causality-across-boundaries"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Preserving Causality Across Boundaries\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 One of the most powerful aspects of Happen's unified event space is how it maintains causality across boundaries. Every event carries its complete causal context:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // When an event crosses a boundary, its context is preserved\
\{\
  type: "inventory-reserved",\
  payload: \{\
    orderId: "order-123",\
    items: [/* ... */]\
  \},\
  context: \{\
    causal: \{\
      id: "evt-789", // Unique event ID\
      sender: "inventory-node", // Originating node\
      causationId: "evt-456", // Event that caused this one\
      correlationId: "txn-123", // Transaction this belongs to\
      path: [ // Complete journey\
        ["user-node", "order-node"],\
        ["order-node", "inventory-node"]\
      ]\
    \}\
  \}\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This causal context creates a complete web of relationships that spans your entire distributed system.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-1qSkEqXxH5AE5BS6rQfw-unified-configuration"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Unified Configuration\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen provides a clean, explicit approach to configuration that separates environment concerns from application logic:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Initialize Happen with NATS as the universal backbone\
const happen = initializeHappen(\{\
  // NATS configuration\
  nats: \{\
    // Connection configuration\
    connection: \{\
      // Server environment (direct NATS)\
      server: \{\
        servers: ['nats://server:4222'],\
        jetstream: true\
      \},\
      // Browser environment (WebSocket)\
      browser: \{\
        servers: ['wss://server:8443'],\
        jetstream: true\
      \}\
    \},\
    \
    // Enable key features\
    capabilities: \{\
      // Persistence through JetStream\
      persistence: \{\
        enabled: true,\
        // Use Key-Value store for state\
        keyValue: \{\
          enabled: true,\
          buckets: \{\
            state: "happen-state",\
            temporal: "happen-temporal"\
          \}\
        \}\
      \},\
      \
      // Delivery guarantees\
      delivery: \{\
        exactlyOnce: true,\
        deduplication: true\
      \}\
    \}\
  \}\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-1qSkEqXxH5AE5BS6rQfw-node-level-configuration"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Node-Level Configuration\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Individual nodes can specify their own delivery requirements:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Node with specific reliability requirements\
const paymentNode = createNode("payment-service", \{\
  // Delivery guarantees for this specific node\
  delivery: \{\
    exactlyOnce: true,\
    acknowledge: true,\
    timeout: 5000, // ms\
    retries: 3\
  \}\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-1qSkEqXxH5AE5BS6rQfw-large-payload-management"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Large Payload Management\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 For handling large data across boundaries, Happen leverages NATS Key-Value store to provide a global namespace:\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-1qSkEqXxH5AE5BS6rQfw-the-global-namespace"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 The Global Namespace\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Store large data\
const key = `data:$\{generateId()\}`;\
node.global.set(key, largeData);\
\
// Reference in events\
node.send(targetNode, \{\
  type: "process-data",\
  payload: \{ dataKey: key \}\
\});\
\
// Retrieve on the other side\
const data = await targetNode.global.get(event.payload.dataKey);\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-1qSkEqXxH5AE5BS6rQfw-handling-network-realities"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Handling Network Realities\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Real-world networks are unreliable. Happen's NATS-based transport layer addresses these realities directly:\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-1qSkEqXxH5AE5BS6rQfw-persistent-delivery"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Persistent Delivery\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Events can be stored in JetStream's durable storage until successfully processed, ensuring:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls66\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Durability
\f2\b0 : Events survive process restarts\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Guaranteed Delivery
\f2\b0 : Events reach their destination even after network issues\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Natural Backpressure
\f2\b0 : JetStream provides backpressure for overloaded consumers\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-1qSkEqXxH5AE5BS6rQfw-network-partitions"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Network Partitions\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 During network partitions:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls67\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Nodes continue operating within their connected segments\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Events destined for disconnected nodes are stored in JetStream\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 When connectivity resumes, stored events are delivered\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Causality is preserved throughout this process\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 This happens automatically through JetStream's durable storage capabilities.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-1qSkEqXxH5AE5BS6rQfw-cross-environment-communication"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Cross-Environment Communication\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The unified transport system makes cross-environment communication seamless:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Server-side node sending to browser client\
serverNode.on("update-client", (event) => \{\
  // Use the standard send method - routing happens automatically\
  serverNode.send(browserNode, \{\
    type: "data-updated",\
    payload: event.payload.data\
  \});\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-1qSkEqXxH5AE5BS6rQfw-benefits-of-the-unified-event-space"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Benefits of the Unified Event Space\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 This approach to distributed events creates powerful capabilities:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls68\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Location Transparency
\f2\b0 : Your code doesn't need to know or care where nodes are deployed\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Protocol Flexibility
\f2\b0 : The right protocol is selected automatically for each environment\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Environment Adaptability
\f2\b0 : Seamlessly bridge between server, browser, and edge environments\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Deployment Freedom
\f2\b0 : Components can move between environments by simply changing deployment configuration\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Resilient Architecture
\f2\b0 : Systems naturally handle network fluctuations through JetStream\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Future Extensibility
\f2\b0 : Easily adopt new NATS capabilities as they become available\cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 By providing a truly unified event space powered by NATS, Happen enables you to focus on your application's domain rather than the complexities of distributed systems.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs72 \cf3 \cb4 Identity & Auth\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 Happen provides the minimal, essential tools that enable developers to build their own identity models. Here's what that looks like:\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-4hO7JkNVZ1t56qfcUMfJ-id-1.-node-identity"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 1. Node Identity\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Every node in Happen possesses a unique identity established at creation:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 const orderNode = createNode('order-service');\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This creates a node with a cryptographic identity that:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls69\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Is established automatically at node creation\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Is used to verify the origin of events\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Remains consistent throughout the node's lifecycle\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Can be referenced by other nodes\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 Node identity is foundational to Happen's event flow, enabling verifiable communication between components without requiring elaborate identity infrastructure.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-4hO7JkNVZ1t56qfcUMfJ-id-2.-origin-context"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 2. Origin Context\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Events in Happen carry origin information in their context, providing a clear record of where events came from:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 \{\
  type: "order-created",\
  payload: \{\
    // Domain-specific data\
    orderId: "order-123",\
    items: [/* items data */]\
  \},\
  context: \{\
    causal: \{\
      id: "evt-789",\
      sender: "checkout-node",\
      causationId: "evt-456",\
      correlationId: "txn-123"\
    \},\
    origin: \{\
      nodeId: "checkout-node",      // The immediate sender node (added automatically)\
      sourceId: "user-456",         // Original source (optional, application-provided)\
      sourceType: "user"            // Type of source (optional)\
    \}\
  \}\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 The origin context provides:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls70\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 nodeId
\f2\b0 : The node that immediately sent the event (added automatically)\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 sourceId
\f2\b0 : The original source identity (e.g., user ID, service ID)\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 sourceType
\f2\b0 : The type of source (e.g., "user", "system", "service")\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 This minimal but powerful primitive allows events to carry essential identity information without prescribing how that information should be structured or used.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-4hO7JkNVZ1t56qfcUMfJ-id-3.-acceptance-controls"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 3. Acceptance Controls\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Nodes can specify which origins they're willing to accept events from:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 const paymentNode = createNode("payment-service", \{\
  acceptFrom: [\
    "checkout-node",     // Accept from specific node\
    "user:admin",        // Accept from specific user type/role\
    "order-*"            // Accept from nodes matching pattern\
  ]\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This declarative approach provides a simple way to control event flow based on origin, without requiring complex configuration or policy engines.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-4hO7JkNVZ1t56qfcUMfJ-how-happen-enables-identity-models"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 How Happen Enables Identity Models\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 By providing these blocks rather than a complete identity system, Happen enables developers to:\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-4hO7JkNVZ1t56qfcUMfJ-build-custom-identity-models"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Build Custom Identity Models\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Example: Multi-tenant identity model\
function createTenantNode(tenantId, nodeId) \{\
  return createNode(nodeId, \{\
    // Only accept events from the same tenant\
    acceptFrom: [`tenant:$\{tenantId\}:*`]\
  \});\
\}\
\
// When sending events, include tenant context\
sourceNode.send(targetNode, \{\
  type: "process-data",\
  payload: \{/* data */\},\
  context: \{\
    origin: \{\
      sourceId: `tenant:$\{tenantId\}:user-123`,\
      sourceType: "user"\
    \}\
  \}\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-4hO7JkNVZ1t56qfcUMfJ-create-domain-specific-authorization"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Create Domain-Specific Authorization\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Custom authorization using the Event Continuum\
orderNode.on("update-order", (event, context) => \{\
  // Extract origin information\
  const \{ sourceId, sourceType \} = event.context.origin;\
  \
  // Get the order\
  const order = getOrder(event.payload.orderId);\
  \
  // Check if the source has permission to update this order\
  if (sourceType === "user" && order.customerId !== sourceId) \{\
    return \{\
      success: false,\
      reason: "unauthorized",\
      message: "Users can only update their own orders"\
    \};\
  \}\
  \
  // Continue with authorized flow\
  return processOrderUpdate;\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-4hO7JkNVZ1t56qfcUMfJ-implement-delegation-patterns"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Implement Delegation Patterns\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Forward events while preserving original source\
apiNode.on("create-order", (event, context) => \{\
  // Preserve the original source when forwarding\
  return apiNode.send(orderNode, \{\
    type: "process-order",\
    payload: event.payload,\
    context: \{\
      origin: \{\
        // Keep original source information\
        sourceId: event.context.origin.sourceId,\
        sourceType: event.context.origin.sourceType\
      \}\
    \}\
  \});\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-4hO7JkNVZ1t56qfcUMfJ-embracing-causality"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Embracing Causality\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The identity system in Happen is designed to work seamlessly with its causal model:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls71\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Each event naturally references its sender node\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 The causal chain provides a complete history of who did what\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Origin information flows through event chains\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 The combination creates a natural audit trail\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 This integration means that identity becomes an inherent property of the event flow rather than a separate concern requiring special handling.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-4hO7JkNVZ1t56qfcUMfJ-the-power-of-minimalism"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 The Power of Minimalism\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 By providing just the essential identity apparatus, Happen enables:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls72\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Simple Identity Tracking
\f2\b0 : Basic origin tracking with zero configuration\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Powerful Custom Models
\f2\b0 : Build sophisticated identity systems when needed\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Domain-Specific Authorization
\f2\b0 : Implement authorization that matches your domain\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Clean Mental Model
\f2\b0 : Identity as a natural property of events\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs72 \cf3 \cb4 Security\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 Happen provides the minimal, essential tools that enable developers to build their own security models.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-ebAerOG7qSSi90heZILB-id-1.-event-identity-and-integrity-tooling"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 1. Event Identity and Integrity Tooling\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f1\fs24 \AppleTypeServices \cf3 \cb4 Event ID Generation
\f2\b0 : Every event in Happen automatically receives a unique, cryptographically secure identifier generated by the framework.\cb1 \

\f1\b \cb4 Automatic Event Hash
\f2\b0 : The framework automatically calculates and includes a cryptographic hash of each event's contents in its causal context:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Example of what an event looks like internally\
\{\
  type: "payment-processed",\
  payload: \{ amount: 100 \},\
  context: \{\
    causal: \{\
      id: "evt-789",          // Unique ID \
      hash: "a1b2c3...",      // Cryptographic hash\
      sender: "payment-node",\
      causationId: "evt-456",\
      correlationId: "order-123"\
    \}\
  \}\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This hash is calculated from the canonicalized event (without the hash itself) using a hashing algorithm provided by the runtime environment.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-ebAerOG7qSSi90heZILB-id-2.-node-identity"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 2. Node Identity\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f1\fs24 \AppleTypeServices \cf3 \cb4 Identity Container
\f2\b0 : Every node in Happen has an inherent identity established at creation:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Node identity is established automatically\
const paymentNode = createNode('payment-service');\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This identity is used to track the origin of events and forms the foundation of security verification.\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f1\b \cf3 \cb4 Identity Propagation
\f2\b0 : Node identity is automatically included in the causal context of emitted events:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // The framework automatically includes the sender information\
// in the causal context of every event\
orderNode.send(paymentNode, \{\
  type: "process-payment",\
  payload: \{ amount: 100 \}\
\});\
\
// Resulting event includes sender identity\
// \{\
//   type: "process-payment", \
//   payload: \{ amount: 100 \},\
//   context: \{\
//     causal: \{\
//       sender: "order-service",  // Added automatically\
//       ...\
//     \}\
//   \}\
// \}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f1\b\fs24 \cf3 \cb4 Origin Context
\f2\b0 : For tracking the original source of events (not just the immediate sender):\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Adding origin information to events\
orderNode.send(paymentNode, \{\
  type: "process-payment",\
  payload: \{ amount: 100 \},\
  context: \{\
    origin: \{\
      sourceId: "user-123",     // Original source (e.g., user ID)\
      sourceType: "user"        // Type of source\
    \}\
  \}\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This allows developers to build their own identity models on top of Happen.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-ebAerOG7qSSi90heZILB-id-3.-causal-chain"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 3. Causal Chain\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The causal relationships between events provide a natural foundation for security verification:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Events naturally form a causal chain\
event.context.causal = \{\
  id: "evt-789",\
  sender: "user-service",\
  causationId: "evt-456",    // Links to the event that caused this one\
  correlationId: "session-123"  // Groups related events\
\};\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This causality enables:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls73\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Tracking the complete flow of events\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Verifying that events occurred in the expected sequence\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Building audit trails based on causal relationships\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Detecting replay or injection attacks\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-ebAerOG7qSSi90heZILB-id-4.-the-event-continuum-for-verification"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 4. The Event Continuum for Verification\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The Event Continuum provides a natural place to implement security verification:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Security verification using the Event Continuum\
paymentNode.on("process-payment", function verifyAndProcess(event, context) \{\
  // Extract security information\
  const \{ signature \} = event.context.integrity || \{\};\
  const \{ hash \} = event.context.causal;\
  \
  // Verify using runtime crypto\
  if (signature) \{\
    const senderPublicKey = getPublicKey(event.context.causal.sender);\
    if (!verifySignature(hash, signature, senderPublicKey)) \{\
      return \{\
        success: false,\
        reason: "invalid-signature"\
      \};\
    \}\
  \}\
  \
  // Continue to payment processing\
  return processPayment;\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This allows security verification to integrate seamlessly with the normal event flow.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-ebAerOG7qSSi90heZILB-how-these-enable-security"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 How These Enable Security\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 By providing building blocks rather than implementations, Happen enables developers to build their own security models:\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-ebAerOG7qSSi90heZILB-integrity-verification"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Integrity Verification\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Using the automatic hash for integrity verification\
paymentNode.on("process-payment", (event, context) => \{\
  // Hash verification happens automatically by the framework\
  \
  // Can perform additional custom verification if needed\
  if (!customVerification(event)) \{\
    return \{ success: false, reason: "verification-failed" \};\
  \}\
  \
  // Continue processing\
  return processPayment;\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-ebAerOG7qSSi90heZILB-digital-signatures-and-tamper-evidence"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Digital Signatures and Tamper Evidence\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Signing events using runtime crypto\
orderNode.on("create-order", (event, context) => \{\
  // Generate order and prepare payment event\
  const paymentEvent = \{\
    type: "process-payment",\
    payload: \{ \
      orderId: generateOrderId(),\
      amount: calculateTotal(event.payload.items)\
    \},\
    context: \{\
      // Add signature using runtime crypto\
      integrity: \{\
        signature: signWithRuntimeCrypto(\
          event.context.causal.hash, \
          getPrivateKey()\
        )\
      \}\
    \}\
  \};\
  \
  // Send signed event\
  return orderNode.send(paymentNode, paymentEvent);\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-ebAerOG7qSSi90heZILB-authorization-patterns"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Authorization Patterns\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Authorization using the Event Continuum\
resourceNode.on("access-resource", (event, context) => \{\
  // Extract source information\
  const \{ sourceId, sourceType \} = context.origin || \{\};\
  \
  // Check permissions\
  if (!hasPermission(sourceId, event.payload.resourceId, "read")) \{\
    return \{\
      success: false,\
      reason: "unauthorized",\
      message: "User does not have permission to access this resource"\
    \};\
  \}\
  \
  // Continue to resource access\
  return provideResource;\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-ebAerOG7qSSi90heZILB-multi-tenant-isolation"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Multi-tenant Isolation\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Tenant isolation using origin information\
dataNode.on("query-data", (event, context) => \{\
  // Extract tenant from origin\
  const tenantId = extractTenantFromSource(context.origin?.sourceId);\
  \
  // Enforce tenant isolation\
  const tenantScopedQuery = \{\
    ...event.payload.query,\
    tenantId // Add tenant filter to query\
  \};\
  \
  // Execute scoped query\
  const results = executeQuery(tenantScopedQuery);\
  \
  return \{ results \};\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-ebAerOG7qSSi90heZILB-end-to-end-encryption"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 End-to-End Encryption\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Encrypting sensitive payload data\
userNode.on("send-sensitive-message", (event, context) => \{\
  // Get recipient's public key\
  const recipientPublicKey = getPublicKey(event.payload.recipientId);\
  \
  // Create encrypted message\
  const encryptedMessage = encryptWithRuntimeCrypto(\
    event.payload.sensitiveContent,\
    recipientPublicKey\
  );\
  \
  // Send message with encrypted content\
  return userNode.send(messagingNode, \{\
    type: "deliver-message",\
    payload: \{\
      recipientId: event.payload.recipientId,\
      encryptedContent: encryptedMessage\
    \}\
  \});\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-ebAerOG7qSSi90heZILB-minimal-but-powerful"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Minimal but Powerful \cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The key is to expose the right features in the core event system, without baking in specific security implementations by giving developers all the building blocks they need without restricting their options.\cb1 \
\cb4 These features enable developers to implement:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls74\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Digital signatures for event verification\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Role-based access control for node interactions\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Attribute-based access policies\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Multi-layer security models\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Custom authentication mechanisms\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Auditing and compliance systems\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 End-to-end encryption for sensitive data\cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 While keeping the core framework minimal and focused on its primary responsibility: the flow of events between nodes.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs72 \cf3 \cb4 Error Handling\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 Error handling implements robust recovery patterns without introducing new primitives beyond Nodes and Events.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-LVm0P1GueEEewVP7wf7e-core-principles"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Core Principles\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen's approach to error handling is built on these fundamental principles:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls75\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Errors as Flow Branches
\f2\b0 : Errors are treated as natural branches in the event flow\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Functional Error Handling
\f2\b0 : Error handlers are just functions that can be returned\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Context for Error Information
\f2\b0 : Error details flow through context between functions\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Causal Error Tracking
\f2\b0 : Errors maintain causal relationships like normal events\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Decentralized Recovery
\f2\b0 : Nodes make local recovery decisions when possible\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 This approach achieves remarkable power with minimal complexity by leveraging existing primitives rather than introducing special error-handling constructs.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-LVm0P1GueEEewVP7wf7e-the-functional-error-model"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 The Functional Error Model\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 In Happen, error handling is fully integrated into the Event Continuum through function returns:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Register an event handler\
orderNode.on("process-order", function validateOrder(event, context) \{\
  // Validate the order\
  const validation = validateOrderData(event.payload);\
  \
  if (!validation.valid) \{\
    // Return error handler function on validation failure\
    return handleInvalidOrder;\
  \}\
  \
  // Proceed with valid order\
  context.validated = true;\
  return processOrder;\
\});\
\
// Error handler function\
function handleInvalidOrder(event, context) \{\
  // Log the validation failure\
  logValidationFailure(event.payload);\
  \
  // Return error result\
  return \{\
    success: false,\
    reason: "validation-failed",\
    details: "Invalid order data"\
  \};\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This functional approach means:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls76\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Errors are just another branch in the flow\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Error handlers are regular functions\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Error information flows through context\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 No special syntax or constructs are needed\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-LVm0P1GueEEewVP7wf7e-error-propagation-and-context"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Error Propagation and Context\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Error information naturally flows through context:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 function processPayment(event, context) \{\
  try \{\
    // Process the payment\
    const paymentResult = chargeCustomer(event.payload.payment);\
    \
    if (!paymentResult.success) \{\
      // Store error details in context\
      context.error = \{\
        code: paymentResult.code,\
        message: paymentResult.message,\
        timestamp: Date.now(),\
        correlationId: event.context.causal.correlationId\
      \};\
      \
      return handlePaymentFailure;\
    \}\
    \
    // Success path\
    return createShipment;\
  \} catch (error) \{\
    // Unexpected error - store and return handler\
    context.error = \{\
      unexpected: true,\
      message: error.message,\
      stack: error.stack,\
      timestamp: Date.now()\
    \};\
    \
    return handleUnexpectedError;\
  \}\
\}\
\
function handlePaymentFailure(event, context) \{\
  // Access error from context\
  const \{ error \} = context;\
  \
  // Log structured error\
  logError("Payment failed", error);\
  \
  // Return result with error details\
  return \{\
    success: false,\
    reason: "payment-failed",\
    details: error.message,\
    code: error.code\
  \};\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This approach allows error information to flow naturally through the event chain, maintaining complete context for diagnostics and recovery.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-LVm0P1GueEEewVP7wf7e-recovery-patterns"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Recovery Patterns\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen's functional approach enables powerful recovery patterns through composition.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-LVm0P1GueEEewVP7wf7e-retry-pattern"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Retry Pattern\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 function processPayment(event, context) \{\
  // Initialize retry count\
  context.retryCount = context.retryCount || 0;\
  \
  try \{\
    // Attempt payment processing\
    const result = chargeCustomer(event.payload.payment);\
    \
    // Success - continue to shipping\
    context.payment = result;\
    return createShipment;\
  \} catch (error) \{\
    // Store error\
    context.lastError = error;\
    \
    // Increment retry count\
    context.retryCount++;\
    \
    // Determine if we should retry\
    if (context.retryCount < 3) \{\
      console.log(`Retrying payment ($\{context.retryCount\}/3)...`);\
      \
      // Return self to retry\
      return processPayment;\
    \}\
    \
    // Too many retries\
    return handlePaymentFailure;\
  \}\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-LVm0P1GueEEewVP7wf7e-circuit-breaker-pattern"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Circuit Breaker Pattern\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Shared circuit state (could be in external store)\
const circuits = \{\
  payment: \{\
    failures: 0,\
    status: "closed", // closed, open, half-open\
    lastFailure: null\
  \}\
\};\
\
function processPayment(event, context) \{\
  const circuit = circuits.payment;\
  \
  // Check if circuit is open\
  if (circuit.status === "open") \{\
    return \{\
      success: false,\
      reason: "service-unavailable",\
      message: "Payment service is temporarily unavailable"\
    \};\
  \}\
  \
  try \{\
    // Process payment\
    const result = chargeCustomer(event.payload.payment);\
    \
    // Success - reset circuit if in half-open state\
    if (circuit.status === "half-open") \{\
      circuit.status = "closed";\
      circuit.failures = 0;\
    \}\
    \
    // Continue with success\
    context.payment = result;\
    return createShipment;\
  \} catch (error) \{\
    // Update circuit state\
    circuit.failures++;\
    circuit.lastFailure = Date.now();\
    \
    // Check threshold for opening circuit\
    if (circuit.status === "closed" && circuit.failures >= 5) \{\
      // Open the circuit\
      circuit.status = "open";\
      \
      // Schedule reset to half-open\
      setTimeout(() => \{\
        circuit.status = "half-open";\
      \}, 30000); // 30 second timeout\
    \}\
    \
    // Return error result\
    return \{\
      success: false,\
      reason: "payment-failed",\
      message: error.message,\
      circuitStatus: circuit.status\
    \};\
  \}\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-LVm0P1GueEEewVP7wf7e-fallback-pattern"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Fallback Pattern\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 function processPayment(event, context) \{\
  try \{\
    // Try primary payment processor\
    const result = primaryPaymentProcessor.charge(event.payload.payment);\
    context.payment = result;\
    return createShipment;\
  \} catch (error) \{\
    // Store error for context\
    context.primaryError = error;\
    \
    // Return fallback function\
    return useBackupPaymentProcessor;\
  \}\
\}\
\
function useBackupPaymentProcessor(event, context) \{\
  console.log("Primary payment processor failed. Using backup.");\
  \
  try \{\
    // Try fallback processor\
    const result = backupPaymentProcessor.charge(event.payload.payment);\
    \
    // Success - continue normal flow\
    context.payment = result;\
    context.usedFallback = true;\
    return createShipment;\
  \} catch (error) \{\
    // Both processors failed\
    return \{\
      success: false,\
      reason: "payment-failed",\
      message: "Both primary and backup payment processors failed",\
      primaryError: context.primaryError.message,\
      backupError: error.message\
    \};\
  \}\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-LVm0P1GueEEewVP7wf7e-error-events-as-first-class-citizens"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Error Events as First-Class Citizens\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 In Happen, errors can also be treated as normal events, enabling system-wide error handling:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // When detecting an error, broadcast an error event\
paymentNode.on("process-payment", (event, context) => \{\
  try \{\
    // Process payment\
    const result = processPayment(event.payload);\
    return \{ success: true, transactionId: result.id \};\
  \} catch (error) \{\
    // Broadcast error event\
    paymentNode.broadcast(\{\
      type: "payment.error",\
      payload: \{\
        orderId: event.payload.orderId,\
        error: \{\
          message: error.message,\
          code: error.code || "UNKNOWN"\
        \},\
        timestamp: Date.now()\
      \}\
    \});\
    \
    // Return failure to the original sender\
    return \{\
      success: false,\
      reason: "payment-error",\
      message: error.message\
    \};\
  \}\
\});\
\
// Error monitoring node can observe all error events\
monitoringNode.on(type => type.endsWith(".error"), (event) => \{\
  // Extract service name from event type\
  const service = event.type.split('.')[0];\
  \
  // Record error\
  recordServiceError(service, event.payload);\
  \
  // Check thresholds for alerts\
  checkErrorThresholds(service);\
  \
  return \{ monitored: true \};\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-LVm0P1GueEEewVP7wf7e-distributed-error-handling"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Distributed Error Handling\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 When errors cross node boundaries, they naturally maintain their causal context:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Node A: Original error occurs\
nodeA.on("process-task", async (event) => \{\
  try \{\
    // Process task\
    const result = await processTask(event.payload);\
    return \{ success: true, result \};\
  \} catch (error) \{\
    // Return error result\
    return \{\
      success: false,\
      reason: "task-failed",\
      error: error.message,\
      timestamp: Date.now()\
    \};\
  \}\
\});\
\
// Node B: Handles failure from Node A\
nodeB.on("orchestrate-workflow", async (event) => \{\
  // Call Node A\
  const result = await nodeB.send(nodeA, \{\
    type: "process-task",\
    payload: event.payload.taskData\
  \}).return();\
  \
  // Check for error\
  if (!result.success) \{\
    // The error from Node A is now available in Node B\
    // with the causal chain intact\
    \
    // Handle error based on reason\
    if (result.reason === "task-failed") \{\
      return handleTaskFailure;\
    \}\
    \
    return \{\
      success: false,\
      reason: "workflow-failed",\
      cause: result.reason,\
      error: result.error\
    \};\
  \}\
  \
  // Continue with success path\
  return continueWorkflow;\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-LVm0P1GueEEewVP7wf7e-supervisor-pattern"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Supervisor Pattern\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 For system-wide resilience, you can create supervisor nodes that monitor and manage error recovery:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Create a supervisor node\
const supervisorNode = createNode("system-supervisor");\
\
// Monitor error events across the system\
supervisorNode.on(type => type.endsWith(".error"), (event) => \{\
  // Extract service from event type\
  const service = event.type.split('.')[0];\
  \
  // Track error frequency\
  supervisorNode.state.set(state => \{\
    const services = state.services || \{\};\
    const serviceState = services[service] || \{ errors: 0, lastError: 0 \};\
    \
    return \{\
      ...state,\
      services: \{\
        ...services,\
        [service]: \{\
          ...serviceState,\
          errors: serviceState.errors + 1,\
          lastError: Date.now()\
        \}\
      \}\
    \};\
  \});\
  \
  // Check for restart threshold\
  const serviceState = supervisorNode.state.get(state => \
    (state.services && state.services[service]) || \{ errors: 0 \}\
  );\
  \
  if (serviceState.errors >= 5) \{\
    // Too many errors - trigger restart\
    supervisorNode.broadcast(\{\
      type: "service.restart",\
      payload: \{ \
        service,\
        reason: "excessive-errors",\
        count: serviceState.errors\
      \}\
    \});\
    \
    // Reset error count\
    supervisorNode.state.set(state => (\{\
      ...state,\
      services: \{\
        ...state.services,\
        [service]: \{\
          ...state.services[service],\
          errors: 0,\
          lastRestart: Date.now()\
        \}\
      \}\
    \}));\
  \}\
  \
  return \{ monitored: true \};\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-LVm0P1GueEEewVP7wf7e-composing-error-handling-with-normal-flow"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Composing Error Handling with Normal Flow\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Error handling in Happen integrates seamlessly with normal event processing:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Complete order processing flow with error handling\
orderNode.on("process-order", validateOrder);\
\
function validateOrder(event, context) \{\
  // Validate order\
  const validation = validateOrderData(event.payload);\
  \
  if (!validation.valid) \{\
    return handleInvalidOrder;\
  \}\
  \
  // Store validation result\
  context.validatedOrder = \{\
    ...event.payload,\
    validated: true,\
    validatedAt: Date.now()\
  \};\
  \
  // Continue to inventory check\
  return checkInventory;\
\}\
\
function checkInventory(event, context) \{\
  // Check inventory\
  const inventoryResult = checkInventoryLevels(context.validatedOrder.items);\
  \
  if (!inventoryResult.available) \{\
    // Store inventory problem\
    context.inventoryIssue = inventoryResult;\
    return handleInventoryShortage;\
  \}\
  \
  // Continue to payment\
  return processPayment;\
\}\
\
function processPayment(event, context) \{\
  try \{\
    // Process payment\
    const paymentResult = chargeCustomer(\
      context.validatedOrder.payment,\
      calculateTotal(context.validatedOrder.items)\
    );\
    \
    if (!paymentResult.success) \{\
      context.paymentIssue = paymentResult;\
      return handlePaymentFailure;\
    \}\
    \
    // Store payment result\
    context.payment = paymentResult;\
    \
    // Continue to shipment creation\
    return createShipment;\
  \} catch (error) \{\
    context.error = error;\
    return handleUnexpectedError;\
  \}\
\}\
\
function createShipment(event, context) \{\
  // Create shipment\
  const shipment = createShipmentRecord(\{\
    order: context.validatedOrder,\
    payment: context.payment\
  \});\
  \
  // Return success result\
  return \{\
    success: true,\
    orderId: context.validatedOrder.id,\
    shipmentId: shipment.id,\
    trackingNumber: shipment.trackingNumber\
  \};\
\}\
\
// Error handlers\
function handleInvalidOrder(event, context) \{\
  return \{\
    success: false,\
    reason: "validation-failed",\
    details: "Invalid order data"\
  \};\
\}\
\
function handleInventoryShortage(event, context) \{\
  const \{ inventoryIssue \} = context;\
  \
  // Try to get availability estimate\
  const availability = estimateAvailability(inventoryIssue.missingItems);\
  \
  return \{\
    success: false,\
    reason: "inventory-shortage",\
    unavailableItems: inventoryIssue.missingItems,\
    estimatedAvailability: availability\
  \};\
\}\
\
function handlePaymentFailure(event, context) \{\
  return \{\
    success: false,\
    reason: "payment-failed",\
    details: context.paymentIssue.message,\
    code: context.paymentIssue.code\
  \};\
\}\
\
function handleUnexpectedError(event, context) \{\
  // Log unexpected error\
  logError("Unexpected error processing order", context.error);\
  \
  return \{\
    success: false,\
    reason: "system-error",\
    message: "An unexpected error occurred"\
  \};\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 Treating errors as branches in the functional flow provides sophisticated error handling capabilities without introducing special constructs.\cb1 \
\cb4 Key takeaways:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls77\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Use Function Returns for Error Flow: Return error handler functions to handle errors\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Leverage Context: Store error information in the context object for diagnostics\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Implement Recovery Patterns: Build error recovery using function composition\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Apply Resilience Patterns: Implement retry, circuit breakers, and fallbacks as needed\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Decentralized Recovery: Let nodes make local decisions about error handling\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs72 \cf3 \cb4 Network Resilience\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 In distributed systems, network failures are inevitable. Nodes become unreachable, connections fail, and partitions occur. Happen provides comprehensive resilience capabilities through NATS and JetStream, creating a system that maintains causal integrity even during the most challenging network disruptions.\cb1 \
\cb4 Happen's approach to network resilience stays true to its philosophy of radical simplicity by leveraging NATS' battle-tested features:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls78\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Durable Storage
\f2\b0 : Events are preserved in JetStream before delivery attempts\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Guaranteed Delivery
\f2\b0 : At-least-once and exactly-once delivery semantics\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Automatic Reconnection
\f2\b0 : NATS clients intelligently reconnect after network failures\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Message Replay
\f2\b0 : Unacknowledged messages are automatically replayed when connections recover\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Cross-Region Replication
\f2\b0 : Messages remain available across geographic regions\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Causal Ordering
\f2\b0 : Events maintain their causal relationships throughout disruptions\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 This creates a self-healing system that requires minimal configuration while providing enterprise-grade resilience.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-lrAAq6YftdgY56OUyzeR-comprehensive-resilience-features"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Comprehensive Resilience Features\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen combines multiple NATS capabilities to solve the full spectrum of network resilience challenges:\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-lrAAq6YftdgY56OUyzeR-id-1.-persistent-message-storage"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 1. Persistent Message Storage\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Events are automatically stored in NATS JetStream streams before delivery is attempted:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // When a node sends an event (internal implementation using NATS)\
function sendEvent(targetNode, event) \{\
  // FIRST: Publish to JetStream stream with the event's ID as message ID\
  // This happens automatically\
  \
  // THEN: Deliver to recipient\
  // If successful, the recipient acknowledges\
  // If unsuccessful, the event remains in JetStream for later delivery\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This ensures events survive process crashes, network failures, and other disruptions.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-lrAAq6YftdgY56OUyzeR-id-2.-delivery-guarantees"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 2. Delivery Guarantees\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen supports both at-least-once and exactly-once delivery semantics:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Configure delivery guarantees at system level\
const happen = initializeHappen(\{\
  nats: \{\
    capabilities: \{\
      delivery: \{\
        // Choose your delivery semantics\
        mode: "exactly-once", // or "at-least-once"\
        deduplication: true,\
        deduplicationWindow: "5m" // 5 minute window\
      \}\
    \}\
  \}\
\});\
\
// Or configure per node\
const paymentNode = createNode("payment-service", \{\
  delivery: \{\
    mode: "exactly-once",\
    acknowledge: true\
  \}\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 With exactly-once delivery, even if messages are redelivered due to network issues, they'll only be processed once.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-lrAAq6YftdgY56OUyzeR-id-3.-automatic-reconnection"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 3. Automatic Reconnection\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 NATS clients automatically attempt to reconnect when network connections fail:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Configure reconnection behavior\
const happen = initializeHappen(\{\
  nats: \{\
    connection: \{\
      // Reconnection settings\
      reconnect: true,\
      reconnectTimeWait: 2000, // 2 seconds between attempts\
      maxReconnectAttempts: -1  // Unlimited reconnect attempts\
    \}\
  \}\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 During reconnection attempts, outbound messages are queued locally until the connection is restored.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-lrAAq6YftdgY56OUyzeR-id-4.-flow-control-and-backpressure"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 4. Flow Control and Backpressure\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 NATS provides natural backpressure mechanisms that prevent overwhelming recipients during recovery:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Configure flow control\
const happen = initializeHappen(\{\
  nats: \{\
    capabilities: \{\
      flowControl: \{\
        enabled: true,\
        maxPending: 256 * 1024 // 256KB of pending messages\
      \}\
    \}\
  \}\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This ensures that when a node recovers after network issues, it won't be flooded with a sudden burst of messages.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-lrAAq6YftdgY56OUyzeR-id-5.-multi-region-resilience"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 5. Multi-Region Resilience\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen leverages NATS SuperClusters to provide cross-region resilience:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Configure multi-region operation\
const happen = initializeHappen(\{\
  nats: \{\
    // SuperCluster configuration\
    connection: \{\
      servers: ['nats://local-region:4222'],\
      jetstream: true\
    \},\
    // Region configuration\
    regions: \{\
      primary: "us-west",\
      replicas: ["us-east", "eu-central"],\
      // Configuration for handling cross-region communication\
      coordination: \{\
        strategy: "primary-replica",\
        conflictResolution: "last-writer-wins"\
      \}\
    \}\
  \}\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This enables:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls79\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Geographic Redundancy
\f2\b0 : System continues operating even if an entire region fails\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Data Locality
\f2\b0 : Process data in the optimal region for performance and compliance\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Disaster Recovery
\f2\b0 : Automatic failover and recovery between regions\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-lrAAq6YftdgY56OUyzeR-id-6.-causal-event-recovery"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 6. Causal Event Recovery\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 When network connections recover, events are replayed while preserving causal relationships:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Receive events in proper causal order after reconnection\
orderNode.on("process-order", (event) => \{\
  // After reconnection, events will arrive in causal order\
  // with exactly-once processing guarantees\
  \
  const \{ orderId \} = event.payload;\
  // Process normally - framework handles recovery\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This ensures that even after severe network disruptions, your application's causal integrity is maintained.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-lrAAq6YftdgY56OUyzeR-resilience-across-environment-boundaries"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Resilience Across Environment Boundaries\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen's resilience capabilities work seamlessly across different runtime environments:\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-lrAAq6YftdgY56OUyzeR-server-environments"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Server Environments\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 In server environments, NATS clients connect directly to the NATS server:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Server node connecting directly to NATS\
const serverNode = createNode("backend-service");\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-lrAAq6YftdgY56OUyzeR-browser-environments"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Browser Environments\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 In browser environments, clients connect through WebSockets:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Browser node connecting via WebSockets\
const browserNode = createNode("frontend-client");\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-lrAAq6YftdgY56OUyzeR-edge-iot-environments"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Edge/IoT Environments\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 For edge or IoT devices with intermittent connectivity:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Edge node with specialized configuration\
const edgeNode = createNode("sensor-device", \{\
  // Configuration for intermittent connectivity\
  connectivity: \{\
    mode: "intermittent",\
    localBuffering: true,\
    syncOnConnect: true\
  \}\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 In all these environments, the same resilience guarantees apply, providing consistent behavior regardless of where nodes are running.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-lrAAq6YftdgY56OUyzeR-application-integration"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Application Integration\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 While network resilience operates automatically, applications can optionally integrate with the system for enhanced awareness:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Listen for connection status events\
orderNode.on('system.connection-status', (event) => \{\
  const \{ status, reason \} = event.payload;\
  \
  if (status === 'disconnected') \{\
    // Update UI to show connectivity issue\
    updateConnectionStatus('degraded', reason);\
    \
    // Enable offline mode\
    enableOfflineMode();\
  \} else if (status === 'reconnected') \{\
    // Update UI to show restored connectivity\
    updateConnectionStatus('connected');\
    \
    // Return to normal operation\
    disableOfflineMode();\
  \}\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This allows applications to:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls80\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Notify users about connectivity issues\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Adapt UI behavior during disruptions\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Log network problems for diagnostics\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Enable offline capabilities when appropriate\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-lrAAq6YftdgY56OUyzeR-key-value-store-for-persistent-state"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Key-Value Store for Persistent State\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 In addition to message persistence, Happen leverages NATS JetStream's Key-Value store for durable state:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // State is automatically persisted in JetStream KV store\
orderNode.state.set(state => (\{\
  ...state,\
  orders: \{\
    ...state.orders,\
    "order-123": \{\
      status: "processing",\
      updatedAt: Date.now()\
    \}\
  \}\
\}));\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This ensures that node state persists across restarts and can be shared across instances, providing:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls81\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Durable State
\f2\b0 : State persists even if nodes restart\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Consistent State
\f2\b0 : Updates maintain causal ordering\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Shared State
\f2\b0 : State can be accessed from multiple instances\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Versioned State
\f2\b0 : Each update creates a new version that can be tracked\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-lrAAq6YftdgY56OUyzeR-comprehensive-network-failure-handling"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Comprehensive Network Failure Handling\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen's NATS-based architecture handles the full spectrum of network failures:\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-lrAAq6YftdgY56OUyzeR-process-crashes"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Process Crashes\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 If a process crashes:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls82\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Events are preserved in JetStream\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 State is preserved in the Key-Value store\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Upon restart, the node resumes processing where it left off\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-lrAAq6YftdgY56OUyzeR-network-partitions"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Network Partitions\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 During network partitions:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls83\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Nodes continue functioning in their connected segments\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Events for unreachable nodes are stored in JetStream\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 When the partition heals, normal operation resumes automatically\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-lrAAq6YftdgY56OUyzeR-regional-outages"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Regional Outages\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 During regional outages:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls84\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Traffic automatically routes to available regions\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 When the region recovers, it synchronizes with the rest of the system\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Causal relationships are preserved across regions\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-lrAAq6YftdgY56OUyzeR-temporary-disconnections"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Temporary Disconnections\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 During temporary disconnections:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls85\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 NATS clients automatically attempt to reconnect\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Outbound messages queue locally\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Upon reconnection, normal event flow resumes\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-lrAAq6YftdgY56OUyzeR-long-term-outages"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Long-Term Outages\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 For long-term outages:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls86\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Events are preserved in JetStream for the configured retention period\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 State remains in the Key-Value store\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 When connectivity is restored, normal operation resumes\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-lrAAq6YftdgY56OUyzeR-benefits-of-nats-powered-resilience"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Benefits of NATS-Powered Resilience\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen's NATS-based approach to network resilience offers several key advantages:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls87\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Battle-Tested Foundation
\f2\b0 : Built on NATS' proven resilience capabilities\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Zero Data Loss
\f2\b0 : Events are preserved even during severe disruptions\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Exactly-Once Processing
\f2\b0 : No duplicate processing, even during recovery\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Self-Healing
\f2\b0 : System automatically recovers when issues resolve\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Cross-Environment Consistency
\f2\b0 : Same resilience guarantees across all environments\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Minimal Configuration
\f2\b0 : Works out of the box with sensible defaults\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Global Scale
\f2\b0 : Extends from single-process to worldwide deployments\cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 By leveraging NATS and JetStream, Happen provides enterprise-grade resilience capabilities without the complexity typically associated with distributed systems. Your application can focus on business logic while the framework handles the challenging aspects of network resilience.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs72 \cf3 \cb4 A Few Design Patterns\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-TKz99emzYtzDGUWfofvw-event-sourcing-pattern"}}{\fldrslt 
\f5\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Event Sourcing Pattern\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The Event Sourcing pattern stores all changes to an application state as a sequence of events, making it possible to reconstruct past states and provide a complete audit trail. Happen's causality-focused approach makes this pattern particularly elegant.\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Create an event store node\
const eventStore = createNode("event-store");\
\
// Store domain events\
eventStore.on(type => type.startsWith("domain-"), (event) => \{\
  // Store event in append-only log\
  storeEvent(event);\
  return \{ stored: true \};\
\});\
\
// Function to reconstruct state from events\
function rebuildState() \{\
  let state = initialState();\
  for (const event of retrieveEvents()) \{\
    // Apply each event to evolve the state\
    state = applyEvent(state, event);\
  \}\
  return state;\
\}\
\
// Function to get state at a specific point in time\
function getStateAt(timestamp) \{\
  let state = initialState();\
  for (const event of retrieveEvents()) \{\
    if (event.metadata.timestamp <= timestamp) \{\
      state = applyEvent(state, event);\
    \}\
  \}\
  return state;\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This pattern leverages Happen's natural event flow to create an immutable record of all domain changes, enabling powerful historical analysis and debugging.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-TKz99emzYtzDGUWfofvw-command-query-responsibility-segregation-cqrs"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Command Query Responsibility Segregation (CQRS)\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 CQRS separates operations that modify state (commands) from operations that read state (queries), allowing each to be optimized independently.\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Command handling node\
const orderCommandNode = createNode("order-commands");\
\
// Process commands that modify state\
orderCommandNode.on("create-order", (event) => \{\
  // Validate command\
  validateOrderData(event.payload);\
  \
  // Execute command logic\
  const orderId = generateOrderId();\
  \
  // Emit domain event representing the result\
  orderCommandNode.broadcast(\{\
    type: "domain-order-created",\
    payload: \{ orderId, ...event.payload, createdAt: Date.now() \}\
  \});\
  \
  return \{ success: true, orderId \};\
\});\
\
// Query handling node\
const orderQueryNode = createNode("order-queries");\
\
// Update query model when domain events occur\
orderQueryNode.on("domain-order-created", (event) => \{\
  // Update query-optimized state\
  orderQueryNode.state.set(state => \{\
    const orders = state.orders || \{\};\
    return \{\
      ...state,\
      orders: \{\
        ...orders,\
        [event.payload.orderId]: \{ \
          ...event.payload, \
          status: "pending" \
        \}\
      \}\
    \};\
  \});\
  \
  return \{ updated: true \};\
\});\
\
// Handle queries\
orderQueryNode.on("get-order", (event) => \{\
  const \{ orderId \} = event.payload;\
  // Return query result directly\
  return orderQueryNode.state.get(state => state.orders?.[orderId] || null);\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This pattern showcases Happen's ability to separate different concerns (writing vs. reading) while maintaining the causal relationships between them.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-TKz99emzYtzDGUWfofvw-observer-pattern"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Observer Pattern\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The observer pattern lets nodes observe and react to events without the sender needing to know about the observers, promoting loose coupling and modular design.\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Subject node that emits events\
const userNode = createNode("user-service");\
\
// Process user profile updates and notify observers\
userNode.on("update-user-profile", (event) => \{\
  const \{ userId, profileData \} = event.payload;\
  \
  // Update the user profile\
  userNode.state.set(state => \{\
    const users = state.users || \{\};\
    return \{\
      ...state,\
      users: \{\
        ...users,\
        [userId]: \{\
          ...(users[userId] || \{\}),\
          ...profileData,\
          updatedAt: Date.now()\
        \}\
      \}\
    \};\
  \});\
  \
  // Emit an event for observers\
  userNode.broadcast(\{\
    type: "user-profile-updated",\
    payload: \{\
      userId,\
      updatedFields: Object.keys(profileData),\
      timestamp: Date.now()\
    \}\
  \});\
  \
  return \{ success: true \};\
\});\
\
// Observer nodes that react to events\
const notificationNode = createNode("notification-service");\
const analyticsNode = createNode("analytics-service");\
const searchIndexNode = createNode("search-index-service");\
\
// Each observer reacts independently\
notificationNode.on("user-profile-updated", (event) => \{\
  // Send notification about profile update\
  if (event.payload.updatedFields.includes("email")) \{\
    sendEmailChangeNotification(event.payload.userId);\
  \}\
  return \{ notified: true \};\
\});\
\
analyticsNode.on("user-profile-updated", (event) => \{\
  // Track profile update for analytics\
  recordProfileUpdateMetrics(event.payload);\
  return \{ tracked: true \};\
\});\
\
searchIndexNode.on("user-profile-updated", (event) => \{\
  // Update search index with new profile data\
  refreshUserSearchIndex(event.payload.userId);\
  return \{ indexed: true \};\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This pattern demonstrates Happen's natural support for decoupled, event-driven architectures where components can react to system events without direct dependencies.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-TKz99emzYtzDGUWfofvw-strategy-pattern"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Strategy Pattern\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The strategy pattern allows selecting an algorithm at runtime, which Happen implements naturally through event handlers and dynamic routing.\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Create a pricing strategy node\
const pricingStrategyNode = createNode("pricing-strategy");\
\
// Handle pricing requests with different strategies\
pricingStrategyNode.on("calculate-price", (event) => \{\
  const \{ items, strategy, customerInfo \} = event.payload;\
  \
  // Select strategy based on the event payload\
  let total;\
  \
  switch(strategy) \{\
    case "volume-discount":\
      total = calculateVolumeDiscount(items);\
      break;\
    case "premium-customer":\
      total = calculatePremiumPrice(items, customerInfo?.tier);\
      break;\
    case "regular":\
    default:\
      total = calculateRegularPrice(items);\
  \}\
  \
  // Return pricing result\
  return \{ \
    total, \
    appliedStrategy: strategy, \
    calculatedAt: Date.now() \
  \};\
\});\
\
// Strategy implementations\
function calculateRegularPrice(items) \{\
  return items.reduce((total, item) => total + item.price * item.quantity, 0);\
\}\
\
function calculateVolumeDiscount(items) \{\
  let total = 0;\
  for (const item of items) \{\
    let price = item.price;\
    if (item.quantity > 10) \{\
      // 10% discount\
      price = price * 0.9;\
    \}\
    total += price * item.quantity;\
  \}\
  return total;\
\}\
\
function calculatePremiumPrice(items, customerTier) \{\
  const baseTotal = calculateRegularPrice(items);\
  const discountRate = customerTier === "gold" ? 0.15 : 0.1;\
  return baseTotal * (1 - discountRate);\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This pattern shows how Happen supports dynamic behavior selection without requiring complex class hierarchies or inheritance.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-TKz99emzYtzDGUWfofvw-mediator-pattern"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Mediator Pattern\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The mediator pattern provides centralized coordination between multiple components, reducing direct dependencies and simplifying complex workflows.\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Create a mediator node\
const workflowMediator = createNode("workflow-mediator");\
\
// Handle workflow initiation\
workflowMediator.on("start-onboarding", async (event) => \{\
  const \{ userId \} = event.payload;\
  \
  // Step 1: Create user account\
  const accountResult = await workflowMediator.send(accountNode, \{\
    type: "create-account",\
    payload: \{ userId, ...event.payload.userData \}\
  \}).return();\
  \
  if (!accountResult.success) \{\
    return \{ \
      success: false, \
      stage: "account-creation",\
      reason: accountResult.reason\
    \};\
  \}\
  \
  // Step 2: Set up permissions\
  const permissionResult = await workflowMediator.send(permissionNode, \{\
    type: "assign-default-roles",\
    payload: \{ \
      userId, \
      accountId: accountResult.accountId \
    \}\
  \}).return();\
  \
  if (!permissionResult.success) \{\
    return \{ \
      success: false, \
      stage: "permission-setup",\
      reason: permissionResult.reason\
    \};\
  \}\
  \
  // Step 3: Send welcome email\
  await workflowMediator.send(notificationNode, \{\
    type: "send-welcome-email",\
    payload: \{ \
      userId, \
      email: event.payload.userData.email \
    \}\
  \});\
  \
  // Notify about completion\
  workflowMediator.broadcast(\{\
    type: "user-onboarded",\
    payload: \{ userId, status: "completed" \}\
  \});\
  \
  return \{ \
    success: true, \
    userId,\
    accountId: accountResult.accountId\
  \};\
\});\cb1 \
\pard\pardeftab720\partightenfactor0

\f2\fs24 \cf3 \cb4 This pattern showcases Happen's ability to orchestrate complex workflows while keeping individual components focused on their specific responsibilities.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs72 \cf3 \cb4 Introspection & Observability\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 A core philosophy that emerges from Happen's design is the principle of radical observability. Traditional testing often involves writing example-based scripts to verify behavior before deployment. Happen enables a complementary approach: making the system so transparent and interactive that its correctness can be verified by observing it in real time.\cb1 \
\cb4 This is the idea of a system that is "testable through usage." It shifts the focus from post-mortem debugging of logs to live, interactive exploration. Because Happen's\cb1 \
\cb4 Causal Event Web produces a complete, verifiable audit trail of all system activity by default, you have all the raw material needed to build a deeply intuitive and observable application. The following techniques are not built-in features, but rather patterns that the framework's raw primitives make possible.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-GM72PMhtifRLwV9m5g3a-visualizing-event-flows"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Visualizing Event Flows\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The Causal Event Web is, fundamentally, a graph. Every event is a node in this graph, linked by its 
\f4\fs21 \cb7 causationId
\f2\fs24 \cb4  and grouped by its 
\f4\fs21 \cb7 correlationId
\f2\fs24 \cb4 . While this data is powerful, it becomes truly transformative when visualized.\cb1 \
\cb4 By building a simple diagnostic tool that consumes the event stream, you can render the lifecycle of any transaction as a directed graph. Instead of reading logs, you can visually trace how an initial event flowed through the system, which nodes it touched, and what new events it triggered.\cb1 \
\cb4 This provides an unparalleled, intuitive view of your system's behavior, making it immediately obvious if a workflow is behaving as expected.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-GM72PMhtifRLwV9m5g3a-a-repl-for-your-system"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 A REPL for Your System\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 You can create a special "admin" or "diagnostic" node that allows you to interact with your live application. This is similar to the Read-Eval-Print-Loop (REPL) found in languages like Elixir or Lisp and is a powerful tool for live debugging and exploration.\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f1\b \cf3 \cb4 Querying a Live Node's State
\f2\b0 \cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 Your diagnostic node could send a direct request to any other node to inspect its current state.\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // In your diagnostic tool's code\
const apiGatewayState = await diagnosticNode.send(apiGatewayNode, \{\
  type: 'introspect-get-state'\
\}).return();\
\
// The apiGatewayNode would have a handler for this event\
apiGatewayNode.on('introspect-get-state', (event, context) => \{\
  // Return a copy of the current state\
  return apiGatewayNode.state.get();\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f1\b\fs24 \cf3 \cb4 Injecting Events
\f2\b0 \cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 The REPL could also allow you to manually inject an event into the system to trigger a flow and observe the outcome in your visualizer. This is a powerful way to test edge cases or reproduce bugs in a controlled manner.\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // In your diagnostic tool's code\
diagnosticNode.broadcast(\{\
  type: 'create-order',\
  payload: \{\
    // Manually crafted payload to test a specific scenario\
    customerId: 'cust-123',\
    items: [\{ id: 'prod-edge-case', quantity: 1 \}]\
  \}\
\});\cb1 \
\pard\pardeftab720\partightenfactor0

\f2\fs24 \cf3 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-GM72PMhtifRLwV9m5g3a-the-power-of-observation"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 The Power of Observation\cb1 \
\pard\pardeftab720\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 By embracing these patterns, you can create a development experience where observing the "usage" of your live system is the most effective and intuitive way to verify its correctness. This approach embodies the Happen philosophy: providing simple, powerful primitives that can be composed into sophisticated, transparent, and resilient systems.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs96 \cf3 \cb4 Advanced\cb1 \
\pard\pardeftab720\partightenfactor0

\fs72 \cf3 \cb4 Asynchronous Processing\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 Asynchronous processing is a cornerstone of Happen's design, allowing the framework to handle concurrent events efficiently while maintaining its commitment to radical simplicity. This document explains how Happen approaches asynchronous processing through multiple strategies: concurrent event handling, direct runtime capabilities, function-based flows, and streaming results.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-gJp4NQdwuxYeGuk8fqYm-core-approach"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Core Approach\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 In Happen, multiple events arriving at a node are processed concurrently without blocking each other, leveraging JavaScript's asynchronous capabilities while preserving event isolation. This happens as an implementation detail rather than an explicit API feature.\cb1 \
\cb4 When events arrive at a node:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls88\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Each event gets its own independent execution context\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Events are processed concurrently using JavaScript's natural Promise mechanism\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 One event processing never blocks another, even within the same node\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 This approach ensures that slow-running event handlers don't create bottlenecks for unrelated events.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-gJp4NQdwuxYeGuk8fqYm-the-functional-asynchronous-model"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 The Functional Asynchronous Model\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen embraces JavaScript's native asynchronous capabilities while providing a clean, functional interface through the Event Continuum model:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Register an asynchronous handler\
orderNode.on("process-order", async (event, context) => \{\
  // Perform asynchronous validation\
  const validationResult = await validateOrderData(event.payload);\
  \
  // Store in context\
  context.validation = validationResult;\
  \
  if (!validationResult.valid) \{\
    return \{\
      success: false,\
      reason: "validation-failed",\
      errors: validationResult.errors\
    \};\
  \}\
  \
  // Return the next function to execute\
  return processPayment;\
\});\
\
// Asynchronous function in the flow\
async function processPayment(event, context) \{\
  // Process payment asynchronously\
  const paymentResult = await processTransaction(event.payload.payment);\
  \
  // Store in context\
  context.payment = paymentResult;\
  \
  if (!paymentResult.success) \{\
    return handlePaymentFailure;\
  \}\
  \
  // Return next function\
  return createShipment;\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 Happen's event execution engine handles the async nature transparently:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls89\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 When a function returns a Promise, Happen awaits it automatically\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Async functions are fully supported throughout the flow\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Error handling works seamlessly with async/await\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-gJp4NQdwuxYeGuk8fqYm-automatic-queue-management"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Automatic Queue Management\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 For high-volume scenarios, Happen includes internal queue management to prevent overwhelming the system:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Internal queue management - not exposed to users\
class Node \{\
  // Configuration for concurrent execution\
  #concurrencySettings = \{\
    maxConcurrent: 100, // Maximum concurrent executions\
    queueLimit: 10000   // Maximum queued events\
  \};\
  \
  #activeCount = 0;     // Currently executing handlers\
  #queue = [];          // Queue of pending events\
  \
  // Process with queue management\
  process(event) \{\
    // If under concurrent limit, execute immediately\
    if (this.#activeCount < this.#concurrencySettings.maxConcurrent) \{\
      return this.executeImmediately(event);\
    \}\
    \
    // Otherwise, queue the event\
    return this.queueEvent(event);\
  \}\
  \
  // Execute immediately\
  executeImmediately(event) \{\
    this.#activeCount++;\
    \
    // Start the event flow\
    return this.executeFlow(event)\
      .finally(() => \{\
        this.#activeCount--;\
        this.processNextFromQueue();\
      \});\
  \}\
  \
  // Queue for later execution\
  queueEvent(event) \{\
    // Check queue limits\
    if (this.#queue.length >= this.#concurrencySettings.queueLimit) \{\
      return Promise.reject(new Error("Event queue limit exceeded"));\
    \}\
    \
    // Create deferred promise\
    let resolve, reject;\
    const promise = new Promise((res, rej) => \{\
      resolve = res;\
      reject = rej;\
    \});\
    \
    // Add to queue with resolvers\
    this.#queue.push(\{ event, resolve, reject \});\
    \
    return promise;\
  \}\
  \
  // Process next from queue\
  processNextFromQueue() \{\
    // If queue empty or at concurrency limit, do nothing\
    if (this.#queue.length === 0 ||\
        this.#activeCount >= this.#concurrencySettings.maxConcurrent) \{\
      return;\
    \}\
    \
    // Get next event from queue\
    const next = this.#queue.shift();\
    \
    // Process it\
    this.executeImmediately(next.event)\
      .then(result => next.resolve(result))\
      .catch(error => next.reject(error));\
  \}\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This queue management:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls90\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Limits maximum concurrent event handling to prevent resource exhaustion\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Preserves ordered processing within each event type\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Provides backpressure for high-volume scenarios\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Manages memory usage by controlling queue size\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-gJp4NQdwuxYeGuk8fqYm-node-configuration"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Node Configuration\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen manages concurrency through the system configuration. This approach keeps infrastructure concerns separated from domain logic and provides consistent behavior across your application.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-gJp4NQdwuxYeGuk8fqYm-system-level-concurrency-configuration"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 System-Level Concurrency Configuration\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Concurrency settings are defined during framework initialization:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Initialization with system-wide defaults\
const happen = initializeHappen(\{\
  // Core security configuration\
  security: \{\
    // Security settings...\
  \},\
  // System-wide concurrency configuration\
  concurrency: \{\
    // Default settings for all nodes\
    default: \{\
      maxConcurrent: 100,     // Maximum concurrent executions\
      queueLimit: 10000,      // Maximum queued events\
      queueStrategy: "fifo",  // First-in-first-out processing\
      backpressureThreshold: 0.8  // Apply backpressure at 80% capacity\
    \},\
    // Node-specific overrides based on node ID patterns\
    patterns: \{\
      "api-*": \{\
        maxConcurrent: 200,    // Higher concurrency for API nodes\
        queueLimit: 20000      // Larger queue for API nodes\
      \},\
      "worker-*": \{\
        maxConcurrent: 50,     // Lower concurrency for worker nodes\
        queueStrategy: "priority"  // Priority-based queuing\
      \},\
      "realtime-*": \{\
        maxConcurrent: 300,    // Higher concurrency for realtime nodes\
        queueLimit: 5000,      // Smaller queue to avoid stale data\
        backpressureThreshold: 0.6  // Earlier backpressure\
      \}\
    \}\
  \},\
  transport: \{\
    // Transport settings...\
  \}\
\});\
\
// The initialized framework provides the node creation function\
const \{ createNode \} = happen;\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This hierarchical approach ensures consistent behavior while allowing for customization where needed.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-gJp4NQdwuxYeGuk8fqYm-generator-based-streaming"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Generator-Based Streaming\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Building on the foundation of asynchronous processing, Happen supports generator-based streaming for incremental data processing.\cb1 \
\cb4 Instead of introducing separate API methods for streaming, Happen detects generator functions automatically:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Register a handler that happens to be a generator function\
node.on("process-large-dataset", async function* processLargeDataset(event, context) \{\
  const \{ dataset \} = event.payload;\
  \
  // Process in chunks\
  for (let i = 0; i < dataset.length; i += 100) \{\
    const chunk = dataset.slice(i, i + 100);\
    const result = await processChunk(chunk);\
    \
    // Yield intermediate results\
    yield \{\
      progress: Math.min(100, Math.round((i + chunk.length) / dataset.length * 100)),\
      results: result\
    \};\
  \}\
  \
  // Final result\
  return \{ status: "complete" \};\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 When interacting with a generator-based handler, Happen automatically provides an AsyncIterator interface:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Request handling of a large dataset using the flow mechanism\
clientNode.on("process-dataset", async function* handleDatasetProcessing(event, context) \{\
  // Send the request to the processor node\
  const processingEvent = \{\
    type: "process-large-dataset",\
    payload: \{ dataset: event.payload.dataset \}\
  \};\
  \
  // Use the send method without chaining\
  const processingStream = await clientNode.send(processorNode, processingEvent);\
  \
  // Process results incrementally using the event continuum\
  for await (const update of processingStream) \{\
    // Log progress\
    console.log(`Progress: $\{update.progress\}%`);\
    \
    // Display intermediate results\
    displayIntermediateResults(update.results);\
    \
    // Yield progress updates to the caller if needed\
    yield \{\
      status: "processing",\
      progress: update.progress,\
      resultsCount: update.results.length\
    \};\
  \}\
  \
  // Return final result\
  return \{\
    status: "complete",\
    message: "Dataset processing complete"\
  \};\
\});\
\
// To use this handler:\
const result = await userNode.send(clientNode, \{\
  type: "process-dataset",\
  payload: \{ \
    dataset: largeDataset \
  \}\
\});\
\
// The result will be the final return value from the handler\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 Generator functions also work with broadcasting, enabling publish-subscribe patterns for streams:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Continuous system monitoring with generator\
monitorNode.on("system-metrics", async function* generateMetrics() \{\
  while (true) \{\
    const metrics = await collectSystemMetrics();\
    yield metrics;\
    await sleep(5000); // Update every 5 seconds\
  \}\
\});\
\
// Start broadcasting metrics\
monitorNode.broadcast(\{ type: "system-metrics" \});\
\
// Subscribers receive the stream\
dashboardNode.on("system-metrics", async function processMetrics(metricsStream, context) \{\
  // Iterate through metrics stream\
  for await (const metrics of metricsStream) \{\
    // Update dashboard\
    updateDashboard(metrics);\
  \}\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-gJp4NQdwuxYeGuk8fqYm-use-cases-for-streaming"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Use Cases for Streaming\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Generator-based streaming in Happen addresses several key use cases:\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-gJp4NQdwuxYeGuk8fqYm-id-1.-large-dataset-processing"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 1. Large Dataset Processing\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Break down large datasets into manageable chunks:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 dataProcessorNode.on("process-batch", async function* processBatch(event, context) \{\
  const \{ items \} = event.payload;\
  \
  // Process in chunks to avoid memory issues\
  for (let i = 0; i < items.length; i += 100) \{\
    const chunk = items.slice(i, i + 100);\
    const results = await processChunk(chunk);\
    \
    yield \{\
      progress: Math.round((i + chunk.length) / items.length * 100),\
      processedItems: chunk.length,\
      results\
    \};\
  \}\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-gJp4NQdwuxYeGuk8fqYm-id-2.-real-time-progress-updates"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 2. Real-time Progress Updates\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Provide incremental feedback for long-running operations:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 importNode.on("import-file", async function* importFile(event, context) \{\
  const \{ filePath \} = event.payload;\
  const fileSize = await getFileSize(filePath);\
  const reader = createFileReader(filePath);\
  \
  let bytesProcessed = 0;\
  \
  // Process file in chunks\
  while (!reader.eof()) \{\
    const chunk = await reader.readChunk(1024 * 1024); // 1MB chunks\
    const records = parseRecords(chunk);\
    await saveRecords(records);\
    \
    bytesProcessed += chunk.length;\
    \
    // Yield progress update\
    yield \{\
      progress: Math.round(bytesProcessed / fileSize * 100),\
      recordsProcessed: records.length\
    \};\
  \}\
  \
  // Final result\
  return \{ status: "complete", totalRecords: getTotalRecords() \};\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-gJp4NQdwuxYeGuk8fqYm-id-3.-continuous-data-streams"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 3. Continuous Data Streams\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Handle data from sources that produce continuous updates:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 sensorNode.on("monitor-sensors", async function* monitorSensors(event, context) \{\
  const \{ sensorIds, duration \} = event.payload;\
  const endTime = Date.now() + duration;\
  \
  // Connect to sensors\
  const sensors = sensorIds.map(id => connectToSensor(id));\
  \
  try \{\
    // Process sensor data until duration expires\
    while (Date.now() < endTime) \{\
      // Collect readings from all sensors\
      const readings = await Promise.all(\
        sensors.map(sensor => sensor.getReading())\
      );\
      \
      // Process this batch of readings\
      const analysis = analyzeReadings(readings);\
      \
      // Emit real-time analysis\
      yield \{\
        timestamp: Date.now(),\
        readings,\
        analysis\
      \};\
      \
      // Wait before next collection\
      await sleep(1000); // 1 second interval\
    \}\
  \} finally \{\
    // Clean up resources\
    sensors.forEach(sensor => sensor.disconnect());\
  \}\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-gJp4NQdwuxYeGuk8fqYm-id-4.-paginated-api-results"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 4. Paginated API Results\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Fetch and process paginated data from external APIs:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 apiNode.on("fetch-all-records", async function* fetchAllRecords(event, context) \{\
  const \{ endpoint, pageSize = 100 \} = event.payload;\
  let page = 1;\
  let hasMore = true;\
  let totalRecords = 0;\
  \
  // Fetch pages until complete\
  while (hasMore) \{\
    // Fetch this page\
    const response = await fetch(`$\{endpoint\}?page=$\{page\}&size=$\{pageSize\}`);\
    const data = await response.json();\
    \
    // Process records\
    processRecords(data.records);\
    totalRecords += data.records.length;\
    \
    // Yield progress\
    yield \{\
      page,\
      records: data.records,\
      totalRecords,\
      hasMore: data.hasMore\
    \};\
    \
    // Update for next iteration\
    hasMore = data.hasMore;\
    page++;\
    \
    // Respect rate limits\
    if (hasMore) \{\
      await sleep(200); // Small delay between requests\
    \}\
  \}\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-gJp4NQdwuxYeGuk8fqYm-benefits-of-happens-async-processing-model"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Benefits of Happen's Async Processing Model\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The combination of concurrent event processing and generator-based streaming delivers several key benefits:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls91\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Maximized Throughput: Multiple events process concurrently without blocking\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Resource Efficiency: Memory usage is controlled through incremental processing\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Responsive System: Long-running operations don't block other processing\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Natural Backpressure: Consumers process stream results at their own pace\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Minimal API Surface: Power and flexibility without additional primitives\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Clean Isolation: Each processing path maintains its own context and error boundaries\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-gJp4NQdwuxYeGuk8fqYm-choosing-the-right-concurrency-approach"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Choosing the Right Concurrency Approach\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 With multiple approaches to concurrency available in Happen, here's a quick guide to choosing the right one for different scenarios:\cb1 \
\pard\pardeftab720\partightenfactor0

\f8\fs28 \cf3 \cb7 Approach\cb1 \
\cb7 Best For\cb1 \
\cb7 When To Use\cb1 \
\pard\pardeftab720\partightenfactor0

\f2 \cf3 \cb4 Functional Flows\cb1 \
\cb4 Most use cases\cb1 \
\cb4 Default approach for all event handling\cb1 \
\cb4 Async/Await\cb1 \
\cb4 Asynchronous operations\cb1 \
\cb4 When operations need to wait for external results\cb1 \
\cb4 Generator-based Streaming\cb1 \
\cb4 Incremental processing\cb1 \
\cb4 For progress updates and chunked processing\cb1 \
\cb4 Worker Threads\cb1 \
\cb4 CPU-intensive tasks\cb1 \
\cb4 When tasks would block the main thread\cb1 \
\cb4 Distributed Processing\cb1 \
\cb4 Horizontal scaling\cb1 \
\cb4 When single machine capacity is exceeded\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-gJp4NQdwuxYeGuk8fqYm-key-takeaways"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Key Takeaways\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls92\ilvl0
\f2\b0\fs32 \AppleTypeServices \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 The Event Continuum model naturally supports asynchronous processing through JavaScript's native async/await\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Runtime transparency allows direct use of platform-specific concurrency features\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Generator-based streaming provides powerful incremental processing with minimal API additions\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Internal queue management ensures system stability under high load\cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 This multi-faceted approach delivers flexible asynchronous capabilities by providing multiple concurrency strategies that compose seamlessly.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs72 \cf3 \cb4 Flow Balance\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 At the core of Happen's resilience capabilities is Flow Balance, a powerful yet invisible mechanism that leverages NATS features to monitor the health of your distributed system through natural message flow patterns.\cb1 \
\cb4 Flow Balance builds on NATS JetStream's built-in monitoring capabilities to provide insights into your distributed system's health:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls93\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Message Tracking
\f2\b0 : NATS JetStream tracks message delivery and acknowledgment\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Consumer Lag
\f2\b0 : Happens detects when consumers fall behind producers\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Delivery Failures
\f2\b0 : JetStream's acknowledgment system reveals delivery problems\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Partition Detection
\f2\b0 : Patterns in message flow reveal network partitions\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 This NATS-powered approach gives Happen a natural way to detect issues in your distributed system without requiring complex configuration or special APIs.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-qvtwTTwhVphw8TCHl76H-how-flow-balance-works"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 How Flow Balance Works\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Flow Balance operates by monitoring the natural patterns in your message flow through NATS:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls94\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 JetStream Consumer Monitoring
\f2\b0 : Happen leverages JetStream's consumer metrics to track delivery success\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Lag Detection
\f2\b0 : When consumers fall behind producers, Happen detects potential issues\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Event Emission
\f2\b0 : When issues are detected, Happen emits system events that applications can respond to\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 Unlike traditional health monitoring systems that rely on external probes, Flow Balance uses the message flow itself as an indicator of system health.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-qvtwTTwhVphw8TCHl76H-observable-patterns"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Observable Patterns\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Different types of issues create distinctive flow patterns that your handlers can interpret:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls95\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Network Partitions
\f2\b0 :\cb1 \
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\partightenfactor0
\ls95\ilvl1
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Pattern
\f2\b0 : Sharp drop in delivery across node groups\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Distribution
\f2\b0 : Clear grouping pattern - nodes on one side can't reach nodes on the other\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Timing
\f2\b0 : Occurs suddenly and affects multiple nodes simultaneously\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls95\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Node Failures
\f2\b0 :\cb1 \
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\partightenfactor0
\ls95\ilvl1
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Pattern
\f2\b0 : Delivery failures specifically for one node\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Distribution
\f2\b0 : Concentrated around the failed node\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Timing
\f2\b0 : Occurs suddenly for the specific node\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls95\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Processing Bottlenecks
\f2\b0 :\cb1 \
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\partightenfactor0
\ls95\ilvl1
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Pattern
\f2\b0 : Gradually increasing consumer lag for a specific node\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Distribution
\f2\b0 : Usually affects a single node or service\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Timing
\f2\b0 : Develops gradually over time\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls95\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 System Overload
\f2\b0 :\cb1 \
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\partightenfactor0
\ls95\ilvl1
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Pattern
\f2\b0 : Rising consumer lag across most or all nodes\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Distribution
\f2\b0 : Affects most components somewhat equally\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Timing
\f2\b0 : Often correlates with increased event volume\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 By analyzing these patterns in your handlers, you can determine the specific type of issue occurring and implement appropriate recovery strategies.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-qvtwTTwhVphw8TCHl76H-imbalance-events"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Imbalance Events\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 When Flow Balance detects issues, it emits events that your application can listen for and respond to:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Listen for node-specific imbalance events\
happen.on("node.down", (event) => \{\
  const \{ nodeId, lagMetrics, pattern \} = event.payload;\
  \
  // Implement your recovery strategy\
  if (lagMetrics.messagesWaiting > 1000) \{\
    // Severe imbalance - potential failure\
    implementNodeFailureRecovery(nodeId);\
  \} else if (lagMetrics.messagesWaiting > 500) \{\
    // Moderate imbalance - potential bottleneck\
    applyBackpressure(nodeId);\
  \} else \{\
    // Minor imbalance - monitor\
    logImbalance(nodeId, lagMetrics);\
  \}\
\});\
\
// Listen for system-wide imbalance events\
happen.on("system.down", (event) => \{\
  const \{ level, affectedNodes, pattern \} = event.payload;\
  \
  // Implement system-wide recovery\
  if (level === "critical") \{\
    // Severe system-wide issue\
    enableEmergencyMode();\
  \} else if (level === "warning") \{\
    // Moderate system-wide issue\
    throttleNonEssentialOperations();\
  \}\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-qvtwTTwhVphw8TCHl76H-building-recovery-strategies"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Building Recovery Strategies\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen provides the detection capabilities through NATS, and you can implement recovery strategies based on your application's needs:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Listen for potential partition events\
happen.on("node.down", (event) => \{\
  const \{ nodeId, lagMetrics, affectedNodes \} = event.payload;\
  \
  // Check for partition pattern\
  if (isPotentialPartition(nodeId, affectedNodes, lagMetrics)) \{\
    // Implement partition recovery strategy\
    enablePartitionMode(\{\
      isolatedNodes: affectedNodes,\
      prioritizeLocalOperations: true,\
      queueRemoteOperations: true\
    \});\
    \
    // Notify operations team\
    alertOperations(\{\
      type: "network-partition",\
      affectedNodes,\
      detectedAt: Date.now()\
    \});\
  \}\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-qvtwTTwhVphw8TCHl76H-benefits-of-flow-balance"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Benefits of Flow Balance\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 This approach provides several key advantages:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls96\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Zero API Surface
\f2\b0 : No special methods or configuration parameters\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Zero Additional Overhead
\f2\b0 : Uses existing NATS monitoring capabilities\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Natural Detection
\f2\b0 : System issues reveal themselves through flow patterns\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Customizable Response
\f2\b0 : You control how your application responds to different issues\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Transport Independence
\f2\b0 : Works the same across all NATS deployment models\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Observable Patterns
\f2\b0 : Clear indicators of different types of system issues\cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 By leveraging NATS's built-in monitoring capabilities, Happen provides powerful system insights with minimal overhead.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs72 \cf3 \cb4 Zero-Allocation Processing\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-GTpuxvFPVSw0JTy8MG9E-memory-efficient-event-handling-for-performance-critical-paths"}}{\fldrslt 
\f3\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Memory-Efficient Event Handling for Performance-Critical Paths\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen's zero-allocation processing provides a powerful technique for handling high-volume events with minimal memory overhead. This advanced feature allows you to create processing pipelines that operate directly on memory buffers without creating 
\f1\b explicit
\f2\b0  intermediate objects, significantly reducing garbage collection pressure in performance-critical scenarios.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b \cf6 \cb4 \strokec6 JavaScript Reality
\f2\b0 : We use the term "zero-allocation" to describe the framework's guarantee of making no explicit allocations in its processing path. The JavaScript runtime may still perform internal allocations beyond our control. This feature provides a significant reduction in allocation overhead, not a complete elimination of all memory operations.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-GTpuxvFPVSw0JTy8MG9E-core-concept"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \strokec3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 \strokec3 Core Concept\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Most JavaScript applications create thousands of objects during normal operation. Each object allocation consumes memory, and the JavaScript garbage collector must eventually reclaim that memory, which can cause performance hiccups. Zero-allocation processing aims to minimize these allocations by working directly with preallocated memory buffers.\cb1 \
\cb4 In Happen, zero-allocation processing provides:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls97\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Direct buffer-based event representation\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Minimal object creation during event processing\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Reduced garbage collection overhead\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Higher sustained throughput for critical event paths\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-GTpuxvFPVSw0JTy8MG9E-when-to-use-zero-allocation-processing"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 When to Use Zero-Allocation Processing\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Zero-allocation processing adds complexity to your code, so it's important to use it selectively. Here are scenarios where it provides genuine value:\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-GTpuxvFPVSw0JTy8MG9E-particularly-valuable-for"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Particularly Valuable For:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls98\ilvl0
\f2\b0\fs48 \AppleTypeServices \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 High-frequency event processing
\f2\b0  (thousands per second) where GC pauses impact throughput\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Memory-constrained JavaScript environments
\f2\b0  like IoT devices running Node.js, JerryScript, or Espruino\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Edge computing scenarios
\f2\b0  processing continuous streams of telemetry or sensor data\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Real-time applications
\f2\b0  with consistent latency requirements that GC pauses would disrupt\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Time-series data processing
\f2\b0  with predictable memory usage patterns\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-GTpuxvFPVSw0JTy8MG9E-less-beneficial-for"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Less Beneficial For:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls99\ilvl0
\f2\b0\fs48 \AppleTypeServices \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Standard business logic with moderate event volumes\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Infrequent or complex events where developer readability is more valuable\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Applications already running on high-memory environments where GC is not a bottleneck\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 Remember that in a JavaScript environment, the runtime still handles memory management. Zero-allocation processing minimizes the framework's allocations, but doesn't eliminate all memory operations at the language level.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-GTpuxvFPVSw0JTy8MG9E-the-api-surface"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 The API Surface\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Unlike many advanced features, zero-allocation processing in Happen requires learning just one additional method:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Register a zero-allocation handler\
node.zero("event-type", (buffer, offsets) => \{\
  // Work directly with buffer\
  // Return value or next function as usual\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This minimal API extension maintains Happen's commitment to simplicity while providing access to powerful performance optimization.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-GTpuxvFPVSw0JTy8MG9E-working-with-event-buffers"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Working with Event Buffers\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 When your handler is invoked through the zero-allocation path, it receives:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls100\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f4\fs21 \cf3 \cb7 \strokec3 buffer
\f2\fs24 \cb4  - A specialized interface to the underlying memory buffer containing event data\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f4\fs21 \cf3 \cb7 \strokec3 offsets
\f2\fs24 \cb4  - A map of offsets indicating where different event components are located in the buffer\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 Here's how you access event data:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 node.zero("sensor-reading", (buffer, offsets) => \{\
  // Get simple values\
  const sensorId = buffer.getString(offsets.payload.sensorId);\
  const temperature = buffer.getFloat64(offsets.payload.temperature);\
  const timestamp = buffer.getUint64(offsets.payload.timestamp);\
  \
  // Access nested structures\
  const latitude = buffer.getFloat64(offsets.payload.location.latitude);\
  const longitude = buffer.getFloat64(offsets.payload.location.longitude);\
  \
  // Process data without creating objects\
  const convertedTemp = (temperature * 9/5) + 32;\
  \
  // Return result directly\
  return \{ processed: true, convertedValue: convertedTemp \};\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 The 
\f4\fs21 \cb7 buffer
\f2\fs24 \cb4  object provides methods for accessing different data types:\cb1 \
\pard\pardeftab720\partightenfactor0

\f8\fs28 \cf3 \cb7 Method\cb1 \
\cb7 Description\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs24\fsmilli12250 \cf3 \cb7 getInt8/16/32/64(offset)
\f2\fs28 \cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 Get signed integer of specified bit width\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs24\fsmilli12250 \cf3 \cb7 getUint8/16/32/64(offset)
\f2\fs28 \cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 Get unsigned integer of specified bit width\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs24\fsmilli12250 \cf3 \cb7 getFloat32/64(offset)
\f2\fs28 \cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 Get floating point number\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs24\fsmilli12250 \cf3 \cb7 getString(offset)
\f2\fs28 \cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 Get string from internal string table\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs24\fsmilli12250 \cf3 \cb7 getBoolean(offset)
\f2\fs28 \cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 Get boolean value\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-GTpuxvFPVSw0JTy8MG9E-how-it-works-under-the-hood"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 How It Works Under the Hood\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Understanding the implementation can help you set realistic expectations and maximize the benefits:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls101\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Pre-allocated Buffer Pool
\f2\b0 : Happen maintains a pool of preallocated ArrayBuffers for events, eliminating the need for per-event allocations.\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 String Table
\f2\b0 : Since strings can't be stored directly in ArrayBuffers with variable length, Happen maintains a string table where strings are stored once and referenced by offset.\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Memory Layout
\f2\b0 : Each event in the buffer has a consistent memory layout with fixed offsets for common fields and a dynamic section for payload data.\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Minimal-Copy Processing
\f2\b0 : When possible, event data is processed in-place with minimal copying.\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Buffer Reuse
\f2\b0 : After an event is processed, its buffer slot returns to the pool for reuse.\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Automatic Conversion
\f2\b0 : When zero-allocation handlers need to interact with standard handlers, Happen automatically handles the conversion at the boundary.\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f1\b \cf3 \cb4 JavaScript Engine Considerations
\f2\b0 \cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 It's important to understand that even with our zero-allocation approach:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls102\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 The JavaScript engine may still perform hidden allocations internally\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 JIT optimization might influence actual memory behavior\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Garbage collection can still occur, though less frequently\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Performance characteristics vary across JavaScript engines (V8, SpiderMonkey, JavaScriptCore)\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 These realities don't diminish the value of the approach, but they do set proper expectations for what's achievable in a managed language environment.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-GTpuxvFPVSw0JTy8MG9E-the-event-continuum-with-zero-allocation"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 The Event Continuum with Zero-Allocation\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Zero-allocation handlers seamlessly integrate with Happen's Event Continuum flow control:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 node.zero("process-batch", (buffer, offsets) => \{\
  // Process first stage with zero allocations\
  \
  // Return next function to continue flow\
  return secondStage;\
\});\
\
// Second stage can be a standard or zero-allocation function\
function secondStage(bufferOrEvent, offsetsOrContext) \{\
  // Check which type we received\
  if (bufferOrEvent.isBuffer) \{\
    // Continue zero-allocation processing\
  \} else \{\
    // Handle as standard event\
  \}\
  \
  // Return next function or result as usual\
  return \{ completed: true \};\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This allows you to build sophisticated processing pipelines that combine the performance of zero-allocation with the flexibility of standard event handling.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-GTpuxvFPVSw0JTy8MG9E-memory-layout-and-buffer-structure"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Memory Layout and Buffer Structure\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 For those who need to understand the details, here's how event data is structured in memory:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 \uc0\u9484 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9488 \
\uc0\u9474  Event Header (32 bytes)\u9474 \
\uc0\u9500 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9508 \
\uc0\u9474  Type Reference (8 bytes)\u9474 \
\uc0\u9500 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9508 \
\uc0\u9474  Context Block (64 bytes)\u9474 \
\uc0\u9500 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9508 \
\uc0\u9474  Payload Block (variable)\u9474 \
\uc0\u9492 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9472 \u9496 \cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 Each value in the payload is stored at a specific offset, with complex nested structures mapped to a flat offset structure. The 
\f4\fs21 \cb7 offsets
\f2\fs24 \cb4  parameter provides this mapping so you don't need to calculate positions manually.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-GTpuxvFPVSw0JTy8MG9E-performance-considerations"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Performance Considerations\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 To maximize the benefits of zero-allocation processing:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls103\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Minimize Conversions
\f2\b0 : Try to keep data in buffer form as long as possible. Each conversion between standard and buffer representations has a cost.\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Avoid Creating Objects
\f2\b0 : Creating objects inside zero handlers defeats the purpose. Work with primitive values where possible.\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Use Primitive Operations
\f2\b0 : Stick to arithmetic and direct buffer manipulation rather than object-oriented operations.\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Consider Buffer Size
\f2\b0 : Very large events may not benefit as much from zero-allocation.\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Measure Actual Impact
\f2\b0 : The benefits of zero-allocation processing are highly dependent on your specific workload, environment, and event characteristics. Always profile before and after implementation to ensure the complexity is justified by measurable improvements.\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Consider WebAssembly
\f2\b0 : For absolute performance requirements where JavaScript limitations are too constraining, consider WebAssembly modules for the most performance-critical operations.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-GTpuxvFPVSw0JTy8MG9E-real-world-benefits"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Real-World Benefits\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Despite JavaScript's limitations, we can generate significant improvements in specific scenarios:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls104\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 40-60% reduction in garbage collection frequency\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 More consistent performance with fewer GC-related latency spikes\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Better predictability in memory-constrained IoT deployments\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Higher sustainable throughput for sensor data processing\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Prevention of out-of-memory conditions on edge devices\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 The key is applying this technique selectively where its benefits outweigh the added complexity.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-GTpuxvFPVSw0JTy8MG9E-example-processing-sensor-readings"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Example: Processing Sensor Readings\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Here's a complete example of using zero-allocation processing for high-frequency sensor data:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Create a sensor data processor\
const sensorNode = createNode("sensor-processor");\
\
// Handle individual readings with standard processing\
sensorNode.on("sensor-reading", (event, context) => \{\
  const \{ sensorId, value, timestamp \} = event.payload;\
  \
  // Process the reading\
  const processed = processReading(sensorId, value, timestamp);\
  \
  // Store result\
  sensorNode.state.set(state => (\{\
    ...state,\
    readings: \{\
      ...state.readings,\
      [sensorId]: \{\
        lastValue: value,\
        lastUpdated: timestamp,\
        processedValue: processed\
      \}\
    \}\
  \}));\
  \
  return \{ processed: true, value: processed \};\
\});\
\
// Handle batches with zero-allocation processing\
sensorNode.zero("sensor-batch", (buffer, offsets) => \{\
  // Get batch metadata\
  const count = buffer.getUint32(offsets.payload.count);\
  const deviceId = buffer.getString(offsets.payload.deviceId);\
  \
  // Process all readings in the batch\
  let totalValue = 0;\
  const readingsOffset = offsets.payload.readings;\
  \
  for (let i = 0; i < count; i++) \{\
    // Calculate offset for this reading in the array\
    const readingOffset = readingsOffset + (i * 16); // Each reading is 16 bytes\
    \
    // Get reading data directly from buffer\
    const sensorId = buffer.getUint16(readingOffset);\
    const value = buffer.getFloat32(readingOffset + 4);\
    const timestamp = buffer.getUint64(readingOffset + 8);\
    \
    // Process without creating objects\
    const processed = value * calibrationFactor(sensorId);\
    totalValue += processed;\
    \
    // Update state (minimal object creation)\
    updateSensorState(sensorId, value, processed, timestamp);\
  \}\
  \
  // Return summary without creating intermediate objects\
  return \{\
    deviceId,\
    processedCount: count,\
    averageValue: totalValue / count\
  \};\
\});\
\
// Utility for minimal state updates\
function updateSensorState(sensorId, value, processed, timestamp) \{\
  // Use direct state operations instead of immutable patterns\
  // for performance-critical code\
  const readings = sensorNode.state.get().readings || \{\};\
  if (!readings[sensorId]) \{\
    readings[sensorId] = \{\};\
  \}\
  \
  readings[sensorId].lastValue = value;\
  readings[sensorId].lastUpdated = timestamp;\
  readings[sensorId].processedValue = processed;\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-GTpuxvFPVSw0JTy8MG9E-conclusion"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Conclusion\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Zero-allocation processing provides a powerful tool for performance-critical paths in your Happen applications. By working directly with memory buffers and minimizing explicit object creation, you can achieve higher throughput and lower latency for high-frequency events, even within the constraints of a JavaScript environment.\cb1 \
\cb4 This feature is most valuable in specific scenarios where reducing allocation pressure delivers tangible benefits:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls105\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Edge computing with high-volume data processing\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 IoT devices with limited memory\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Applications requiring predictable latency characteristics\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Time-series and sensor data processing\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 Remember that this is an advanced technique that trades developer experience for performance. Use it selectively where the benefits outweigh the added complexity, and always measure the actual performance impact in your specific use case.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 For most application code, Happen's standard event handling strikes the right balance between performance and developer experience. With our unified approach you can apply zero-allocation processing precisely where it matters most while keeping the rest of your codebase clean and idiomatic.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs72 \cf3 \cb4 Advanced Patterns\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 The core of Happen is built on a radical commitment to simplicity: two primitives, Nodes and Events, form the entire foundation. While you can build powerful systems using only the basic concepts, the true power of this minimalist approach is its composability. Happen's raw primitives are designed to be powerful building blocks, allowing you to construct sophisticated, production-grade solutions for challenges like distributed transactions, fault tolerance, and system resilience\'97
\f7\i if your application requires it
\f2\i0 .\cb1 \
\cb4 This section is not about features built into the framework; it's about what you can build with the framework. The following patterns demonstrate how Happen's simple, causal-by-default model provides the foundation to implement robust architectures, similar to those found in battle-tested systems like Erlang/OTP, without sacrificing the framework's core simplicity. You don't 
\f7\i have
\f2\i0  to build systems this way, but with Happen, you 
\f7\i can
\f2\i0 .\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-HACfI6K67Au0tPvrcrg2-saga-pattern-for-distributed-transactions"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Saga Pattern for Distributed Transactions\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The Saga pattern manages distributed transactions through a sequence of local operations, each with compensating actions for failure scenarios. This is particularly valuable for maintaining consistency across distributed components.\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Create a saga coordinator\
const orderSaga = createNode("order-saga");\
\
// Start saga for order processing\
orderSaga.on("process-order", async (event) => \{\
  const \{ orderId \} = event.payload;\
  const context = \{ orderId, steps: [] \};\
  \
  try \{\
    // Step 1: Reserve inventory\
    const inventoryResult = await orderSaga.send(inventoryNode, \{\
      type: "reserve-inventory",\
      payload: event.payload\
    \}).return();\
    \
    if (!inventoryResult.success) \{\
      throw new Error(`Inventory reservation failed: $\{inventoryResult.reason\}`);\
    \}\
    \
    context.steps.push("inventory-reserved");\
    \
    // Step 2: Process payment\
    const paymentResult = await orderSaga.send(paymentNode, \{\
      type: "process-payment",\
      payload: event.payload\
    \}).return();\
    \
    if (!paymentResult.success) \{\
      throw new Error(`Payment failed: $\{paymentResult.reason\}`);\
    \}\
    \
    context.steps.push("payment-processed");\
    context.paymentId = paymentResult.paymentId;\
    \
    // Step 3: Create shipment\
    const shipmentResult = await orderSaga.send(shipmentNode, \{\
      type: "create-shipment",\
      payload: \{\
        orderId,\
        items: event.payload.items,\
        address: event.payload.shippingAddress\
      \}\
    \}).return();\
    \
    if (!shipmentResult.success) \{\
      throw new Error(`Shipment creation failed: $\{shipmentResult.reason\}`);\
    \}\
    \
    // Complete the saga\
    orderSaga.broadcast(\{\
      type: "order-processed",\
      payload: \{\
        orderId,\
        status: "processed",\
        shipmentId: shipmentResult.shipmentId\
      \}\
    \});\
    \
    return \{ \
      success: true, \
      orderId,\
      shipmentId: shipmentResult.shipmentId\
    \};\
    \
  \} catch (error) \{\
    // Execute compensating transactions in reverse order\
    if (context.steps.includes("payment-processed")) \{\
      await orderSaga.send(paymentNode, \{\
        type: "refund-payment",\
        payload: \{\
          paymentId: context.paymentId\
        \}\
      \}).return();\
    \}\
    \
    if (context.steps.includes("inventory-reserved")) \{\
      await orderSaga.send(inventoryNode, \{\
        type: "release-inventory",\
        payload: event.payload\
      \}).return();\
    \}\
    \
    // Saga failed\
    orderSaga.broadcast(\{\
      type: "order-processing-failed",\
      payload: \{\
        orderId,\
        reason: error.message\
      \}\
    \});\
    \
    return \{ \
      success: false, \
      reason: error.message\
    \};\
  \}\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This implementation shows how Happen's event-driven model naturally supports complex transactional scenarios that span multiple services.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-HACfI6K67Au0tPvrcrg2-retry-pattern-with-exponential-backoff"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Retry Pattern with Exponential Backoff\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The Retry pattern handles transient failures by automatically retrying operations with increasing delays between attempts.\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Create a service node with retry capability\
const paymentServiceNode = createNode("payment-service");\
\
// Process payment with retry logic\
paymentServiceNode.on("process-payment", async function processPayment(event, context) \{\
  // Initialize retry context if not exists\
  context.retryCount = context.retryCount || 0;\
  context.startTime = context.startTime || Date.now();\
  \
  try \{\
    // Attempt payment processing\
    const result = await chargeCustomer(event.payload);\
    \
    // Success - return result\
    return \{\
      success: true,\
      transactionId: result.transactionId,\
      amount: event.payload.amount,\
      processedAt: Date.now()\
    \};\
    \
  \} catch (error) \{\
    // Store error in context\
    context.lastError = error;\
    context.retryCount++;\
    \
    // Determine if we should retry\
    const maxRetries = 5;\
    const maxDuration = 2 * 60 * 1000; // 2 minutes\
    const timeElapsed = Date.now() - context.startTime;\
    \
    if (context.retryCount < maxRetries && timeElapsed < maxDuration) \{\
      // Calculate exponential backoff delay\
      const delay = Math.min(100 * Math.pow(2, context.retryCount), 5000);\
      \
      // Log retry attempt\
      console.log(`Retrying payment ($\{context.retryCount\}/$\{maxRetries\}) after $\{delay\}ms delay`);\
      \
      // Wait before retrying\
      await new Promise(resolve => setTimeout(resolve, delay));\
      \
      // Return self to retry\
      return processPayment;\
    \}\
    \
    // Too many retries or timeout exceeded\
    return \{\
      success: false,\
      reason: "payment-failed-after-retries",\
      attempts: context.retryCount,\
      lastError: context.lastError.message\
    \};\
  \}\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This pattern demonstrates Happen's function-returning mechanism to create sophisticated retry logic with minimal code.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-HACfI6K67Au0tPvrcrg2-circuit-breaker-pattern"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Circuit Breaker Pattern\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The Circuit Breaker pattern prevents cascading failures by stopping operations that are likely to fail.\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Create a node with circuit breaker capability\
const apiGatewayNode = createNode("api-gateway");\
\
// Circuit state storage\
const circuits = \{\
  payment: \{\
    state: "closed", // closed, open, half-open\
    failures: 0,\
    lastFailure: null,\
    resetTimeout: null\
  \}\
\};\
\
// Handler with circuit breaker logic\
apiGatewayNode.on("call-payment-service", function processPaymentRequest(event, context) \{\
  const circuit = circuits.payment;\
  \
  // Check circuit state\
  if (circuit.state === "open") \{\
    // Circuit is open - fail fast\
    return \{\
      success: false,\
      reason: "circuit-open",\
      message: "Payment service is unavailable"\
    \};\
  \}\
  \
  // Process request with circuit awareness\
  return makePaymentServiceCall;\
\});\
\
// Function to make the actual service call\
async function makePaymentServiceCall(event, context) \{\
  const circuit = circuits.payment;\
  \
  try \{\
    // Attempt to call the payment service\
    const result = await callPaymentService(event.payload);\
    \
    // Success - reset circuit if needed\
    if (circuit.state === "half-open") \{\
      circuit.state = "closed";\
      circuit.failures = 0;\
    \}\
    \
    // Return successful result\
    return result;\
    \
  \} catch (error) \{\
    // Update circuit on failure\
    circuit.failures++;\
    circuit.lastFailure = Date.now();\
    \
    // Check if we should open the circuit\
    if (circuit.state === "closed" && circuit.failures >= 5) \{\
      // Open the circuit\
      circuit.state = "open";\
      \
      // Schedule reset to half-open\
      circuit.resetTimeout = setTimeout(() => \{\
        circuit.state = "half-open";\
      \}, 30000); // 30 second timeout\
    \}\
    \
    // Return error with circuit status\
    return \{\
      success: false,\
      reason: "payment-service-error",\
      message: error.message,\
      circuitState: circuit.state\
    \};\
  \}\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This pattern shows how Happen can be extended to implement sophisticated resilience patterns that protect systems from cascading failures.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-HACfI6K67Au0tPvrcrg2-supervisor-pattern"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Supervisor Pattern\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The Supervisor pattern manages component lifecycles and handles failures through a hierarchical oversight structure.\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Create a supervisor node\
const supervisorNode = createNode("system-supervisor");\
\
// Register handler for all error events\
supervisorNode.on(type => type.endsWith(".error"), (event) => \{\
  // Extract service name from event type\
  const service = event.type.split('.')[0];\
  \
  // Update service state\
  supervisorNode.state.set(state => \{\
    const services = state.services || \{\};\
    const serviceState = services[service] || \{\
      errors: 0,\
      lastError: 0,\
      lastReset: 0,\
      restarts: 0\
    \};\
    \
    // Update error count\
    const updatedServiceState = \{\
      ...serviceState,\
      errors: serviceState.errors + 1,\
      lastError: Date.now()\
    \};\
    \
    // Return updated state\
    return \{\
      ...state,\
      services: \{\
        ...services,\
        [service]: updatedServiceState\
      \}\
    \};\
  \});\
  \
  // Get updated service state\
  const serviceState = supervisorNode.state.get(state => \
    (state.services && state.services[service]) || \{ errors: 0, lastReset: 0 \}\
  );\
  \
  // Check restart threshold\
  if (serviceState.errors >= 5 && Date.now() - serviceState.lastReset < 60000) \{\
    // Service is failing too frequently - trigger restart\
    supervisorNode.broadcast(\{\
      type: "service.restart-required",\
      payload: \{\
        service,\
        reason: "excessive-errors",\
        errorCount: serviceState.errors\
      \}\
    \});\
  \}\
  \
  return \{ supervised: true \};\
\});\
\
// Handle service restart\
supervisorNode.on("service.restart-required", (event) => \{\
  const \{ service \} = event.payload;\
  \
  console.log(`Restarting service: $\{service\}`);\
  \
  // Broadcast restart event\
  supervisorNode.broadcast(\{\
    type: "infrastructure.restart-service",\
    payload: \{\
      service,\
      triggeredBy: "supervisor",\
      reason: event.payload.reason\
    \}\
  \});\
  \
  // Update service state\
  supervisorNode.state.set(state => \{\
    const services = state.services || \{\};\
    const serviceState = services[service] || \{\};\
    \
    return \{\
      ...state,\
      services: \{\
        ...services,\
        [service]: \{\
          ...serviceState,\
          errors: 0,\
          lastReset: Date.now(),\
          restarts: (serviceState.restarts || 0) + 1\
        \}\
      \}\
    \};\
  \});\
  \
  return \{ action: "restart", service \};\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This pattern demonstrates Happen's ability to implement hierarchical oversight and automated recovery mechanisms using its core primitives.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-HACfI6K67Au0tPvrcrg2-state-machine-workflow"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 State Machine Workflow\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The State Machine pattern models entities that transition between discrete states according to well-defined rules.\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Create a state machine node\
const orderStateMachine = createNode("order-state-machine");\
\
// Define allowed transitions\
const allowedTransitions = \{\
  "draft": ["submitted"],\
  "submitted": ["processing", "canceled"],\
  "processing": ["shipped", "canceled"],\
  "shipped": ["delivered"],\
  "canceled": []\
\};\
\
// Process transition requests\
orderStateMachine.on("transition-order", (event) => \{\
  const \{ orderId, toState \} = event.payload;\
  \
  // Get current order state\
  orderStateMachine.state.get(state => \{\
    const order = (state.orders || \{\})[orderId];\
    \
    if (!order) \{\
      return \{\
        success: false,\
        reason: "order-not-found"\
      \};\
    \}\
    \
    // Check if transition is allowed\
    const currentState = order.status;\
    if (!allowedTransitions[currentState]?.includes(toState)) \{\
      return \{\
        success: false,\
        reason: "invalid-transition",\
        message: `Cannot transition from $\{currentState\} to $\{toState\}`\
      \};\
    \}\
    \
    // Apply the transition\
    orderStateMachine.state.set(state => \{\
      const orders = state.orders || \{\};\
      \
      return \{\
        ...state,\
        orders: \{\
          ...orders,\
          [orderId]: \{\
            ...order,\
            status: toState,\
            transitionedAt: Date.now(),\
            previousStatus: currentState\
          \}\
        \}\
      \};\
    \});\
    \
    // Broadcast state change event\
    orderStateMachine.broadcast(\{\
      type: "order-state-changed",\
      payload: \{\
        orderId,\
        fromState: currentState,\
        toState,\
        timestamp: Date.now()\
      \}\
    \});\
    \
    return \{\
      success: true,\
      orderId,\
      currentState: toState\
    \};\
  \});\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This pattern shows how Happen's state management capabilities can be used to implement formal state machines with controlled transitions.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-HACfI6K67Au0tPvrcrg2-reactive-aggregates"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Reactive Aggregates\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The Reactive Aggregates pattern combines event-driven reactivity with consistent state management for domain aggregates.\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Create an aggregate node\
const customerAggregate = createNode("customer-aggregate");\
\
// React to events and update aggregate state\
customerAggregate.on("customer-registered", (event) => \{\
  const \{ customerId, email, name \} = event.payload;\
  \
  // Create new aggregate state\
  customerAggregate.state.set(state => \{\
    const customers = state.customers || \{\};\
    \
    return \{\
      ...state,\
      customers: \{\
        ...customers,\
        [customerId]: \{\
          id: customerId,\
          email,\
          name,\
          status: "active",\
          registeredAt: Date.now(),\
          orders: []\
        \}\
      \}\
    \};\
  \});\
  \
  return \{ updated: true \};\
\});\
\
// Add order to customer aggregate\
customerAggregate.on("order-created", (event) => \{\
  const \{ orderId, customerId, amount \} = event.payload;\
  \
  // Update aggregate state\
  customerAggregate.state.set(state => \{\
    const customers = state.customers || \{\};\
    const customer = customers[customerId];\
    \
    if (!customer) \{\
      return state; // Customer not found, state unchanged\
    \}\
    \
    return \{\
      ...state,\
      customers: \{\
        ...customers,\
        [customerId]: \{\
          ...customer,\
          orders: [\
            ...customer.orders,\
            \{\
              id: orderId,\
              amount,\
              createdAt: Date.now()\
            \}\
          ],\
          totalSpent: (customer.totalSpent || 0) + amount,\
          lastOrderAt: Date.now()\
        \}\
      \}\
    \};\
  \});\
  \
  // Check if customer qualifies for premium status\
  const customer = customerAggregate.state.get(state => \
    (state.customers || \{\})[customerId]\
  );\
  \
  if (customer && customer.orders.length >= 5 && customer.status !== "premium") \{\
    // Upgrade to premium status\
    customerAggregate.state.set(state => \{\
      const customers = state.customers || \{\};\
      \
      return \{\
        ...state,\
        customers: \{\
          ...customers,\
          [customerId]: \{\
            ...customers[customerId],\
            status: "premium",\
            upgradedAt: Date.now()\
          \}\
        \}\
      \};\
    \});\
    \
    // Broadcast premium status event\
    customerAggregate.broadcast(\{\
      type: "customer-premium-status-achieved",\
      payload: \{\
        customerId,\
        ordersCount: customer.orders.length,\
        totalSpent: customer.totalSpent + amount\
      \}\
    \});\
  \}\
  \
  return \{ updated: true \};\
\});\
\
// Command handler for direct interactions with the aggregate\
customerAggregate.on("update-customer-email", (event) => \{\
  const \{ customerId, email \} = event.payload;\
  \
  // Validate customer exists\
  const customer = customerAggregate.state.get(state => \
    (state.customers || \{\})[customerId]\
  );\
  \
  if (!customer) \{\
    return \{\
      success: false,\
      reason: "customer-not-found"\
    \};\
  \}\
  \
  // Update email\
  customerAggregate.state.set(state => \{\
    const customers = state.customers || \{\};\
    \
    return \{\
      ...state,\
      customers: \{\
        ...customers,\
        [customerId]: \{\
          ...customers[customerId],\
          email,\
          emailUpdatedAt: Date.now()\
        \}\
      \}\
    \};\
  \});\
  \
  // Broadcast email changed event\
  customerAggregate.broadcast(\{\
    type: "customer-email-changed",\
    payload: \{\
      customerId,\
      previousEmail: customer.email,\
      newEmail: email\
    \}\
  \});\
  \
  return \{\
    success: true,\
    customerId\
  \};\
\});\cb1 \
\pard\pardeftab720\partightenfactor0

\f2\fs24 \cf3 \cb4 This pattern demonstrates how Happen can combine reactive event handling with consistent state management in domain-driven designs.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs96 \cf3 \cb4 Wrappers\cb1 \
\pard\pardeftab720\partightenfactor0

\fs72 \cf3 \cb4 Wrappers\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 Wrappers are how Happen maintains its core philosophy of 
\f1\b radical simplicity
\f2\b0  while enabling powerful extensions. The core framework stays focused on just Nodes and Events, while wrappers provide specialized functionality built on top of these primitives.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-aCquANbnHWKGs37ogRyj-why-wrappers"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Why Wrappers?\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen's core is intentionally minimal - just two primitives (Nodes and Events) with causality tracking. This design choice enables:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls106\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Minimal dependencies
\f2\b0  in the core framework\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Universal compatibility
\f2\b0  across environments\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Predictable behavior
\f2\b0  regardless of extensions\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Optional complexity
\f2\b0  - only pay for what you use\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 Wrappers let you add sophisticated functionality while preserving this simplicity.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-aCquANbnHWKGs37ogRyj-how-wrappers-work"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 How Wrappers Work\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Wrappers are just 
\f1\b specialized Node factories
\f2\b0  that create nodes with specific behaviors. They don't change how Happen works - they build on existing patterns.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-aCquANbnHWKGs37ogRyj-basic-wrapper-pattern"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Basic Wrapper Pattern\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // A wrapper is just a function that creates configured nodes\
function createDatabaseNode(config) \{\
  const node = createNode(config.name)\
  \
  // Add specialized event handlers\
  node.on('db.query', async (event) => \{\
    const result = await database.query(event.payload.sql)\
    node.broadcast(\{\
      type: 'db.result',\
      payload: result,\
      correlationId: event.correlationId\
    \})\
  \})\
  \
  node.on('db.insert', async (event) => \{\
    // Handle inserts...\
  \})\
  \
  return node\
\}\
\
// Usage - still just regular Happen patterns\
const userDB = createDatabaseNode(\{ name: 'user-db' \})\
\
system.broadcast(\{\
  type: 'db.query',\
  payload: \{ sql: 'SELECT * FROM users WHERE active = true' \}\
\})\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 The wrapper provides convenience, but underneath it's just Nodes handling Events.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-aCquANbnHWKGs37ogRyj-the-happen-agents-wrapper"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 The happen-agents Wrapper\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The agents wrapper we discussed is a perfect example:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 import \{ createAgentNode, createContextNode \} from 'happen-agents'\
\
// Creates a node that handles the agent event patterns\
const researcher = createAgentNode(\{\
  llm: openai,\
  name: 'research-agent'\
\})\
\
// Creates a node that composes context dynamically  \
const context = createContextNode(\{\
  compose: \{\
    expertise: () => system.state.get('domain-knowledge'),\
    constraints: () => system.state.get('compliance-rules')\
  \}\
\})\
\
// Still just regular event flow\
system.broadcast(\{\
  type: 'agent.research',\
  payload: \{\
    goal: "analyze competitor pricing",\
    contexts: [context.id]\
  \}\
\})\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 The wrapper handles the LLM integration complexity, but the interface remains pure Happen.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-aCquANbnHWKGs37ogRyj-building-your-own-wrapper"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Building Your Own Wrapper\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Creating a wrapper is straightforward. Here's a template:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 export function createMyWrapper(config) \{\
  const node = createNode(config.name)\
  \
  // Initialize any external dependencies\
  const externalService = new SomeAPI(config.apiKey)\
  \
  // Add specialized event handlers\
  node.on('my-wrapper.action', async (event) => \{\
    try \{\
      // Do something with external service\
      const result = await externalService.process(event.payload)\
      \
      // Emit results as events\
      node.broadcast(\{\
        type: 'my-wrapper.complete',\
        payload: result,\
        correlationId: event.correlationId\
      \})\
      \
    \} catch (error) \{\
      // Error handling through events too\
      node.broadcast(\{\
        type: 'my-wrapper.error', \
        payload: \{ error: error.message \},\
        correlationId: event.correlationId\
      \})\
    \}\
  \})\
  \
  // Add helper methods if needed\
  node.customMethod = () => \{\
    // But still emit events for actual work\
    node.broadcast(\{ type: 'my-wrapper.custom' \})\
  \}\
  \
  return node\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-aCquANbnHWKGs37ogRyj-wrapper-best-practices"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Wrapper Best Practices\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f1\fs24 \AppleTypeServices \cf3 \cb4 Keep the interface event-based
\f2\b0 : Don't expose complex APIs. Let everything flow through events.\cb1 \

\f1\b \cb4 Maintain causality
\f2\b0 : Always use 
\f4\fs21 \cb7 correlationId
\f2\fs24 \cb4  to preserve causal chains.\cb1 \

\f1\b \cb4 Handle errors as events
\f2\b0 : Don't throw exceptions - emit error events.\cb1 \

\f1\b \cb4 Stay stateless when possible
\f2\b0 : Store state in the node, not in closure variables.\cb1 \

\f1\b \cb4 Document event types
\f2\b0 : Make it clear what events your wrapper handles and emits.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-aCquANbnHWKGs37ogRyj-wrapper-ecosystem"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Wrapper Ecosystem\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The wrapper pattern enables a rich ecosystem:\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-aCquANbnHWKGs37ogRyj-data-and-storage"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Data & Storage\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls107\ilvl0
\f2\b0\fs48 \AppleTypeServices \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f4\fs21 \cf3 \cb7 \strokec3 happen-postgres
\f2\fs24 \cb4  - PostgreSQL integration\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f4\fs21 \cf3 \cb7 \strokec3 happen-redis
\f2\fs24 \cb4  - Redis pub/sub and caching\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f4\fs21 \cf3 \cb7 \strokec3 happen-s3
\f2\fs24 \cb4  - AWS S3 file operations\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f4\fs21 \cf3 \cb7 \strokec3 happen-elasticsearch
\f2\fs24 \cb4  - Full-text search\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-aCquANbnHWKGs37ogRyj-ai-and-ml"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 AI & ML\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls108\ilvl0
\f2\b0\fs48 \AppleTypeServices \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f4\fs21 \cf3 \cb7 \strokec3 happen-agents
\f2\fs24 \cb4  - LLM-based intelligent agents\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f4\fs21 \cf3 \cb7 \strokec3 happen-embeddings
\f2\fs24 \cb4  - Vector similarity search\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f4\fs21 \cf3 \cb7 \strokec3 happen-vision
\f2\fs24 \cb4  - Image analysis and generation\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f4\fs21 \cf3 \cb7 \strokec3 happen-speech
\f2\fs24 \cb4  - Speech-to-text and text-to-speech\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-aCquANbnHWKGs37ogRyj-communication"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Communication\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls109\ilvl0
\f2\b0\fs48 \AppleTypeServices \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f4\fs21 \cf3 \cb7 \strokec3 happen-slack
\f2\fs24 \cb4  - Slack bot integration\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f4\fs21 \cf3 \cb7 \strokec3 happen-email
\f2\fs24 \cb4  - SMTP email sending\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f4\fs21 \cf3 \cb7 \strokec3 happen-websocket
\f2\fs24 \cb4  - Real-time client connections\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f4\fs21 \cf3 \cb7 \strokec3 happen-webhook
\f2\fs24 \cb4  - HTTP webhook handling\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-aCquANbnHWKGs37ogRyj-monitoring"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Monitoring\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls110\ilvl0
\f2\b0\fs48 \AppleTypeServices \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f4\fs21 \cf3 \cb7 \strokec3 happen-metrics
\f2\fs24 \cb4  - Prometheus metrics collection\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f4\fs21 \cf3 \cb7 \strokec3 happen-logging
\f2\fs24 \cb4  - Structured logging\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f4\fs21 \cf3 \cb7 \strokec3 happen-tracing
\f2\fs24 \cb4  - Distributed tracing\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f4\fs21 \cf3 \cb7 \strokec3 happen-alerts
\f2\fs24 \cb4  - Alert management\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-aCquANbnHWKGs37ogRyj-multiple-wrappers-together"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Multiple Wrappers Together\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Wrappers compose naturally:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 import \{ createAgentNode \} from 'happen-agents'\
import \{ createDatabaseNode \} from 'happen-postgres'  \
import \{ createSlackNode \} from 'happen-slack'\
\
const analyst = createAgentNode(\{ llm: openai \})\
const database = createDatabaseNode(\{ connectionString: "..." \})\
const slack = createSlackNode(\{ botToken: "..." \})\
\
// Agent can request data\
analyst.on('agent.complete', (event) => \{\
  database.broadcast(\{\
    type: 'db.insert',\
    payload: \{ table: 'reports', data: event.payload \}\
  \})\
\})\
\
// Database can trigger notifications\
database.on('db.complete', (event) => \{\
  slack.broadcast(\{\
    type: 'slack.message',\
    payload: \{ \
      channel: '#reports',\
      text: 'New analysis complete!'\
    \}\
  \})\
\})\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 Each wrapper handles its specialty, but they coordinate through Happen's event system.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-aCquANbnHWKGs37ogRyj-wrapper-development-guidelines"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Wrapper Development Guidelines\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-aCquANbnHWKGs37ogRyj-installation"}}{\fldrslt 
\f5\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Installation\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 npm install happen happen-your-wrapper\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-aCquANbnHWKGs37ogRyj-peer-dependencies"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Peer Dependencies\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 List 
\f4\fs21 \cb7 happen
\f2\fs24 \cb4  as a peer dependency, not a regular dependency:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 \{\
  "peerDependencies": \{\
    "happen": "^1.0.0"\
  \}\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-aCquANbnHWKGs37ogRyj-typescript-support"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 TypeScript Support\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Provide types for your event payloads:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 interface DatabaseQueryEvent \{\
  type: 'db.query'\
  payload: \{\
    sql: string\
    params?: any[]\
  \}\
\}\
\
interface DatabaseResultEvent \{\
  type: 'db.result'\
  payload: \{\
    rows: any[]\
    rowCount: number\
  \}\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-aCquANbnHWKGs37ogRyj-testing"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Testing\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Test your wrapper with regular Happen patterns:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 test('handles query events', async () => \{\
  const db = createDatabaseNode(\{ name: 'test-db' \})\
  \
  const resultPromise = new Promise(resolve => \{\
    db.on('db.result', resolve)\
  \})\
  \
  db.broadcast(\{\
    type: 'db.query',\
    payload: \{ sql: 'SELECT 1' \}\
  \})\
  \
  const result = await resultPromise\
  expect(result.payload.rows).toHaveLength(1)\
\})\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-aCquANbnHWKGs37ogRyj-the-wrapper-philosophy"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 The Wrapper Philosophy\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Wrappers embody Happen's core philosophy:\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f1\b \cf3 \cb4 Simple interface, powerful behavior
\f2\b0 : Complex functionality accessible through simple event patterns.\cb1 \

\f1\b \cb4 Composable by design
\f2\b0 : Any wrapper works with any other wrapper through events.\cb1 \

\f1\b \cb4 Causality preserved
\f2\b0 : All wrapper interactions maintain full causal tracking.\cb1 \

\f1\b \cb4 Environment agnostic
\f2\b0 : Same wrapper works in browser, server, worker, edge.\cb1 \

\f1\b \cb4 Optional complexity
\f2\b0 : Use only the wrappers you need, when you need them.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 Wrappers let Happen grow without compromising its essential simplicity. They're how we achieve the goal of being infinitely extensible while remaining fundamentally understandable.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs72 \cf3 \cb4 Agents\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-v84RhF0nr9YigrTdO7n2-introduction-to-agents"}}{\fldrslt 
\f9\fs60 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f9\fs60 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Introduction to Agents\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen provides a uniquely simple approach to building intelligent agent systems. Instead of complex orchestration frameworks, agents in Happen are just 
\f1\b events carrying goals and context
\f2\b0  that flow through your existing Node/Event architecture.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-v84RhF0nr9YigrTdO7n2-what-is-an-agent-in-happen"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 What is an Agent in Happen?\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 An agent is fundamentally:\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b \cf6 \cb4 \strokec6 Foundation model call + context
\f2\b0 \cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 \strokec3 More precisely, agents are 
\f1\b events that carry specialized context to achieve specific goals
\f2\b0 . They're not persistent objects you manage - they're ephemeral requests that flow through your system, gather the right context, and produce results.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-v84RhF0nr9YigrTdO7n2-your-first-agent"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Your First Agent\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Let's start with the simplest possible example:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 import \{ createNode \} from 'happen'\
import \{ createAgentNode \} from 'happen-agents'\
\
// Create a node that can handle agent requests\
const assistant = createAgentNode(\{\
  llm: openai, // your LLM provider\
  name: 'assistant'\
\})\
\
// Send an agent event - this IS the agent\
assistant.broadcast(\{\
  type: 'agent.help',\
  payload: \{\
    goal: "explain quantum computing in simple terms"\
  \}\
\})\
\
// The assistant automatically handles the pattern:\
// 1. Receives the goal\
// 2. Calls the LLM with context\
// 3. Emits the result as events\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 That's it! You've just created and used an agent. No configuration, no lifecycle management, no complex setup.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-v84RhF0nr9YigrTdO7n2-adding-context"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Adding Context\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The real power comes from providing context that helps the agent understand your domain:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Create context that can be composed dynamically\
const techContext = createContextNode(\{\
  compose: \{\
    audience: () => "software developers",\
    style: () => "practical examples with code",\
    expertise: () => "distributed systems and web technologies"\
  \}\
\})\
\
// Agent events can reference context\
system.broadcast(\{\
  type: 'agent.explain',\
  payload: \{\
    goal: "explain how NATS messaging works",\
    contexts: [techContext.id]\
  \}\
\})\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 The agent automatically pulls together the context when processing your goal, giving much better results than a generic LLM call.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-v84RhF0nr9YigrTdO7n2-the-agent-event-pattern"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 The Agent Event Pattern\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Here's the key insight: 
\f1\b agents are events, not objects
\f2\b0 . When you need intelligent behavior, you emit an agent event:\cb1 \
\cb4 javascript\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // This entire object IS the agent\
\{\
  type: 'agent.research',\
  payload: \{\
    goal: "find the top 5 Node.js testing frameworks",\
    contexts: ['developer-context', 'current-project']\
  \}\
\}\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 Any node in your system can handle agent events. Multiple nodes can process the same agent request. Agents naturally coordinate through Happen's event system.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-v84RhF0nr9YigrTdO7n2-intent-generation"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Intent Generation\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 You only need to specify 
\f1\b what
\f2\b0  you want - the system figures out 
\f1\b how
\f2\b0  to do it:\cb1 \
\cb4 javascript\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // You provide the goal\
system.broadcast(\{\
  type: 'agent.analyze',\
  payload: \{\
    goal: "analyze our API performance bottlenecks"\
  \}\
\})\
\
// The agent handler automatically:\
// 1. Generates an approach based on available context\
// 2. Executes the analysis using that approach\
// 3. Formats results appropriately\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 The LLM generates its own methodology and intent based on your goal and available context.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-v84RhF0nr9YigrTdO7n2-tools-as-agents"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Tools as Agents\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 In Happen, tools are just agents with specialized context. Instead of agents "calling tools," you have agent events triggering other agent events:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Research agent triggers search agent\
system.broadcast(\{\
  type: 'agent.websearch', \
  payload: \{\
    goal: "find recent papers on vector databases",\
    contexts: ['search-optimization-context']\
  \}\
\})\
\
// Which might trigger a summarization agent\
system.broadcast(\{\
  type: 'agent.summarize',\
  payload: \{\
    goal: "create executive summary of search results",\
    contexts: ['executive-communication-context']\
  \}\
\})\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 This creates a uniform system where everything is just 
\f1\b specialized context applied to specific functions
\f2\b0 .\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-v84RhF0nr9YigrTdO7n2-why-this-approach"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Why This Approach?\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f1\fs24 \AppleTypeServices \cf3 \cb4 Simplicity
\f2\b0 : No agent lifecycles, orchestrators, or complex state machines. Just events.\cb1 \

\f1\b \cb4 Composability
\f2\b0 : Agents work with any Happen system since they're just events.\cb1 \

\f1\b \cb4 Observability
\f2\b0 : Full causality tracking through Happen's event system.\cb1 \

\f1\b \cb4 Flexibility
\f2\b0 : Same pattern works for simple tasks or complex multi-agent coordination.\cb1 \

\f1\b \cb4 Natural
\f2\b0 : Builds on patterns you already know if you're using Happen.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-v84RhF0nr9YigrTdO7n2-context-sources"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Context Sources\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Context can come from anywhere in your system:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 const dynamicContext = createContextNode(\{\
  compose: \{\
    // Pull from system state\
    currentProject: () => system.state.get('active-project'),\
    \
    // Pull from recent events  \
    recentIssues: () => system.events.recent('bug.*').slice(-5),\
    \
    // Pull from other nodes\
    teamStatus: () => teamNode.state.get('availability'),\
    \
    // Pull from external APIs\
    marketData: async () => await fetch('/api/market-conditions')\
  \}\
\})\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 The context stays fresh and relevant because it's composed dynamically when the agent runs.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-v84RhF0nr9YigrTdO7n2-happen-agents-intelligence-without-persistence"}}{\fldrslt 
\f9\b\fs60 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f9\b\fs60 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Happen Agents: Intelligence Without Persistence\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-v84RhF0nr9YigrTdO7n2-why-are-agents-events"}}{\fldrslt 
\f3\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Why Are Agents Events?\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f1\fs24 \AppleTypeServices \cf3 \cb4 Think of it this way:
\f2\b0  What is an agent, really? It's a moment of intelligent reasoning about "what should I do next?"\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 In traditional systems, we create persistent objects to hold this intelligence:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 const agent = new Agent(); // Create a "thing" to do the thinking\
agent.think(); // Ask the "thing" to reason\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\fs24 \cf3 \cb4 But in Happen, 
\f1\b everything is events
\f2\b0 . So reasoning is also an event:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 system.broadcast(\{\
  type: 'agent.reasoning', // This IS the moment of thinking\
  payload: \{ query: "What should I do next?" \},\
  context: \{ /* everything needed to reason intelligently */ \}\
\});\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f1\b\fs24 \cf3 \cb4 An agent isn't a "thing that thinks" - it's the "thinking itself."
\f2\b0 \cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 Just like you don't need to create a persistent "Decision Maker" object to make a decision, you don't need a persistent "Agent" object to have intelligent reasoning. The reasoning happens in the moment, with full context, then moves on.\cb1 \
\cb4 The intelligence isn't lost - it flows into the system's event history and influences future reasoning events.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-v84RhF0nr9YigrTdO7n2-what-are-agents-in-happen"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 What Are Agents in Happen?\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-v84RhF0nr9YigrTdO7n2-traditional-agent-systems"}}{\fldrslt 
\f5\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Traditional Agent Systems\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 In most frameworks, agents are 
\f1\b persistent objects
\f2\b0  with predefined capabilities:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 class CustomerAgent \{\
  private tools: Tool[];\
  private memory: ConversationMemory;\
  private personality: string;\
  \
  constructor() \{\
    this.tools = [new EmailTool(), new DatabaseTool(), new KnowledgeBaseTool()];\
    this.memory = new ConversationMemory();\
    this.personality = "helpful customer service rep";\
  \}\
  \
  processRequest(request: string): Response \{\
    // Agent has fixed set of tools it can use\
    // Agent manages its own state and decision-making\
    return this.reasonAndRespond(request);\
  \}\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-v84RhF0nr9YigrTdO7n2-happen-agents"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Happen Agents\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 In Happen, agents are 
\f1\b intelligent events
\f2\b0  that understand full system capabilities:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Agent = reasoning event with complete system awareness\
system.broadcast(\{\
  type: 'agent.reasoning',\
  payload: \{ \
    query: "Customer is upset about billing error" \
  \},\
  context: \{\
    // Rich situational context\
    customer: \{ id: 12345, tier: 'premium', history: [...] \},\
    systemState: \{ billing: \{...\}, support: \{...\} \},\
    \
    // FULL SYSTEM CAPABILITIES available right now\
    capabilities: \{\
      'customer-db': ['lookup', 'update', 'get-history'],\
      'billing-system': ['refund', 'adjust', 'get-statements'],  \
      'email-service': ['send', 'template', 'schedule'],\
      'knowledge-base': ['search', 'suggest-articles'],\
      'escalation-system': ['create-ticket', 'assign-manager']\
    \}\
  \}\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-v84RhF0nr9YigrTdO7n2-dynamic-system-capability-awareness"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Dynamic System Capability Awareness\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The foundation model sees 
\f1\b everything the system can do
\f2\b0  and orchestrates intelligently:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // System automatically discovers current capabilities\
function discoverCapabilities() \{\
  return \{\
    // Database nodes\
    'user-db': userDbNode.getExposedFunctions(),\
    'billing-db': billingDbNode.getExposedFunctions(),\
    \
    // Service nodes  \
    'email': emailNode.getCapabilities(),\
    'sms': smsNode.getCapabilities(),\
    \
    // Integration nodes\
    'slack': slackNode.getAvailableChannels(),\
    'jira': jiraNode.getProjects(),\
    \
    // Even other agent reasoning capabilities\
    'specialist-agents': ['legal-analysis', 'technical-support', 'sales-optimization']\
  \};\
\}\
\
// LLM becomes system conductor that sees everything and decides what to do next\
const context = await composeContext(query, \{\
  systemState: getCurrentState(),\
  documents: searchRelevantDocs(query),\
  capabilities: discoverCapabilities(), // Full system topology\
  eventHistory: getRecentEvents()\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-v84RhF0nr9YigrTdO7n2-but-are-they-really-agents-addressing-the-persistence-misconception"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 "But Are They Really Agents?" - Addressing the Persistence Misconception\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 When people hear that Happen agents are ephemeral events, a common reaction is: 
\f7\i "But that's not a real agent! Agents need to persist and learn over time!"
\f2\i0 \cb1 \
\cb4 This confuses 
\f1\b where intelligence lives
\f2\b0  with 
\f1\b how intelligence behaves
\f2\b0 .\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-v84RhF0nr9YigrTdO7n2-traditional-thinking-intelligence-lives-inside-objects"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Traditional Thinking: Intelligence Lives Inside Objects\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 class Agent \{\
  private memory: Interaction[] = [];\
  private knowledge: Record<string, any> = \{\};\
  private personality: AgentPersonality = \{\};\
  \
  respond(input: string): string \{\
    // Agent uses its accumulated state to be "intelligent"\
    return this.reasonWithMemoryAndKnowledge(input);\
  \}\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-v84RhF0nr9YigrTdO7n2-happen-thinking-intelligence-emerges-from-system-context"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Happen Thinking: Intelligence Emerges from System Context\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // No persistent agent object, but intelligence is preserved and enhanced\
system.broadcast(\{\
  type: 'agent.reasoning',\
  payload: \{ query: "How should we handle this customer complaint?" \},\
  context: \{\
    conversationHistory: system.events.recent('customer.interaction.*'),\
    customerProfile: getCustomerContext(customerId),\
    pastResolutions: system.events.matching('complaint.resolved'),\
    currentCapabilities: getAvailableNodes(),\
    systemLearnings: getPatternAnalysis()\
  \}\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-v84RhF0nr9YigrTdO7n2-learning-still-happens-its-just-distributed-across-the-system"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Learning Still Happens - It's Just Distributed Across the System\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Every interaction creates 
\f1\b permanent learning
\f2\b0  in the system:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // When agent reasoning completes, outcomes become system knowledge\
system.on('agent.response', (event) => \{\
  // Store successful reasoning patterns\
  system.state.set(state => (\{\
    ...state,\
    successfulPatterns: [\
      ...state.successfulPatterns,\
      \{\
        query: event.context.originalQuery,\
        context: event.context,\
        outcome: event.payload,\
        effectiveness: calculateEffectiveness(event)\
      \}\
    ]\
  \}));\
\});\
\
// Future agents automatically benefit from past learnings (pseudo properties)\
const enhancedContext = await composeContext(query, \{\
  includePastPatterns: true,      // Learn from successful interactions\
  includeSystemEvolution: true    // Understand how system has changed\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-v84RhF0nr9YigrTdO7n2-real-time-learning-from-live-system-behavior"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Real-Time Learning from Live System Behavior\cb1 \
\pard\pardeftab720\qc\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Every successful resolution becomes immediate learning\
system.on('complaint.resolved', (event) => \{\
  // Resolution pattern is immediately available to future agents\
  updateContextPatterns(event.payload.resolution);\
  \
  // System learns what works\
  system.state.set(state => (\{\
    ...state,\
    resolutionPatterns: [\
      ...state.resolutionPatterns,\
      \{\
        problemType: event.payload.problemType,\
        resolution: event.payload.resolution,\
        customerSatisfaction: event.payload.rating,\
        timestamp: event.timestamp\
      \}\
    ]\
  \}));\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-v84RhF0nr9YigrTdO7n2-intelligence-is-preserved-agents-make-smart-decisions"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Intelligence Is Preserved: Agents Make Smart Decisions\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 The agent still makes 
\f1\b intelligent decisions
\f2\b0  about what to do next:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Agent reasoning: "I need more context about this customer"\
system.broadcast(\{\
  type: 'context.customer_request',\
  payload: \{ customerId: event.payload.customerId \},\
  context: event.context\
\});\
\
// Agent reasoning: "This looks like a billing issue, I should check payment history"  \
system.broadcast(\{\
  type: 'tool.payment_lookup',\
  payload: \{ customerId: event.payload.customerId \},\
  context: event.context  \
\});\
\
// Agent reasoning: "I have enough information now to provide resolution"\
system.broadcast(\{\
  type: 'agent.response',\
  payload: \{ resolution: synthesizeResolution(allGatheredContext) \},\
  context: event.context\
\});\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-v84RhF0nr9YigrTdO7n2-superior-intelligence-through-multiple-system-perspectives"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Superior Intelligence Through Multiple System Perspectives\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen agents access 
\f1\b collective intelligence
\f2\b0  instead of isolated knowledge:\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 context: \{\
  // Perfect Memory: Complete causal history\
  customerHistory: system.events.matching(`customer.$\{customerId\}.*`),\
  similarCases: system.events.matching('complaint.*'),\
  systemPatterns: getLearnedPatterns(),\
  \
  // Collective Intelligence: What every part of system knows right now\
  salesInsights: salesNode.getInsights(),\
  supportPatterns: supportNode.getPatterns(), \
  customerBehavior: analyticsNode.getCurrentTrends(),\
  marketConditions: marketNode.getLatestData(),\
  \
  // Dynamic Capabilities: What system can do right now\
  availableActions: discoverCapabilities()\
\}\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-v84RhF0nr9YigrTdO7n2-the-result-better-agents-through-non-persistence"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 The Result: Better Agents Through Non-Persistence\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Happen agents are 
\f1\b more intelligent
\f2\b0  precisely because they don't persist:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls111\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Fresh context every time
\f2\b0  - no stale cached information\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 System-wide learning
\f2\b0  - not limited to individual agent experience\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Perfect causality
\f2\b0  - trace exactly why every decision was made\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Distributed intelligence
\f2\b0  - leverage entire system's knowledge\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Real-time adaptation
\f2\b0  - learn from events as they happen\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Dynamic capabilities
\f2\b0  - see what's possible right now, not what was configured at startup\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 // Every agent reasoning event gets the smartest possible context\
const nextAgentEvent = \{\
  type: 'agent.reasoning',\
  payload: \{ query: userQuery \},\
  context: \{\
    // All system knowledge up to this moment\
    systemWisdom: aggregateAllSystemLearnings(),\
    // Current system state and capabilities  \
    currentCapabilities: discoverCapabilities(),\
    // Relevant historical context\
    relevantHistory: selectRelevantEvents(userQuery),\
    // Fresh data from all connected systems\
    liveContext: composeLiveSystemContext()\
  \}\
\};\cb1 \
\pard\pardeftab720\partightenfactor0

\f2\fs24 \cf3 \cb4 The agent event gets smarter context, makes better decisions, and contributes to system-wide learning, all without needing to persist between interactions.\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b\fs96 \cf3 \cb4 Open Source\cb1 \
\pard\pardeftab720\partightenfactor0

\fs72 \cf3 \cb4 Contributing\cb1 \
\pard\pardeftab720\sa240\partightenfactor0

\f2\b0\fs24 \cf3 \cb4 Don't be shy!\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-xcNPHInlo3nqE3445RlR-contributing-to-happen"}}{\fldrslt 
\f9\b\fs60 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f9\b\fs60 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Contributing to Happen\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Thank you for your interest in contributing to Happen! As a framework built on the philosophy of radical simplicity, we value contributions that maintain this principle while extending the framework's capabilities.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-xcNPHInlo3nqE3445RlR-core-philosophy"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Core Philosophy\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Before contributing, please familiarize yourself with Happen's core philosophy:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls112\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Radical Simplicity
\f2\b0 : True power emerges from simplicity rather than complexity\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Pure Causality
\f2\b0 : Events form natural causal chains that define system behavior\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Decentralized Intelligence
\f2\b0 : Smart systems emerge from simple nodes making local decisions\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Composable Primitives
\f2\b0 : Complex behaviors emerge from simple, understandable parts\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\f1\b\fs24 \cf3 \cb4 \strokec3 Runtime Transparency
\f2\b0 : Direct access to the underlying runtime environments\cb1 \
\pard\pardeftab720\sa480\partightenfactor0
\cf3 \cb4 Our goal is to maintain a framework with minimal primitives that compose to create powerful capabilities. We believe the most elegant solutions often emerge not from adding complexity, but from discovering the right minimal abstractions.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-xcNPHInlo3nqE3445RlR-how-to-contribute"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 How to Contribute\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-xcNPHInlo3nqE3445RlR-reporting-issues"}}{\fldrslt 
\f5\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Reporting Issues\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 When reporting issues, please include:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls113\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 A clear description of the problem\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Steps to reproduce the issue\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Expected vs. actual behavior\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Version information (Happen version, runtime environment, OS)\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Minimal code example that demonstrates the issue\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-xcNPHInlo3nqE3445RlR-feature-requests"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Feature Requests\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 We welcome feature requests that align with Happen's philosophy. When suggesting features:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls114\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Describe the problem you're trying to solve before proposing a solution\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Explain how the feature aligns with Happen's philosophy of radical simplicity\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Consider whether the feature could be implemented as a composable extension rather than a core addition\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 If possible, include examples of how the feature would be used\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-xcNPHInlo3nqE3445RlR-pull-requests"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Pull Requests\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 When submitting pull requests:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls115\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Create a branch with a descriptive name (e.g., 
\f4\fs21 \cb7 feature/event-replay
\f2\fs24 \cb4  or 
\f4\fs21 \cb7 fix/node-discovery
\f2\fs24 \cb4 )\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Include tests for new functionality\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Ensure all tests pass\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Update documentation to reflect changes\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Keep PRs focused on a single concern\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Follow the existing code style and patterns\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-xcNPHInlo3nqE3445RlR-development-setup"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Development Setup\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls116\ilvl0
\f2\b0\fs32 \AppleTypeServices \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Fork and clone the repository\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 git clone https://github.com/RobAntunes/happen.git\
cd happen\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls117\ilvl0
\f2\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Install dependencies\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 npm install\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls118\ilvl0
\f2\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Run tests\cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf6 \cb7 \strokec6 Copy\cb1 \
\pard\pardeftab720\partightenfactor0

\f4\fs28 \cf3 \cb9 \strokec3 npm test\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-xcNPHInlo3nqE3445RlR-coding-guidelines"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Coding Guidelines\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-xcNPHInlo3nqE3445RlR-simplicity-first"}}{\fldrslt 
\f5\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Simplicity First\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls119\ilvl0
\f2\b0\fs48 \AppleTypeServices \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Before adding code, ask: "Is this the simplest possible solution?"\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Prefer fewer, well-designed primitives over many specialized ones\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Follow the principle of "Do One Thing Well"\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-xcNPHInlo3nqE3445RlR-event-driven-design"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Event-Driven Design\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls120\ilvl0
\f2\b0\fs48 \AppleTypeServices \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Maintain the event-driven nature of the framework\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Ensure causality is preserved in all operations\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Keep nodes focused on single responsibilities\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-xcNPHInlo3nqE3445RlR-api-design"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 API Design\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls121\ilvl0
\f2\b0\fs48 \AppleTypeServices \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 APIs should be intuitive and consistent with existing patterns\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Prefer composable functions over complex objects\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Maintain backward compatibility when possible\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-xcNPHInlo3nqE3445RlR-testing"}}{\fldrslt 
\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f5\b\fs40 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Testing\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls122\ilvl0
\f2\b0\fs48 \AppleTypeServices \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Write unit tests for all new functionality\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Include integration tests for complex interactions\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Test across different runtime environments when applicable\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-xcNPHInlo3nqE3445RlR-documentation"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Documentation\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 Documentation is crucial for a framework like Happen. When adding or changing features:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls123\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Update the relevant documentation files\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Include clear, concise examples\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Explain not just how to use a feature, but why and when to use it\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Ensure code examples are tested and working\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-xcNPHInlo3nqE3445RlR-review-process"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Review Process\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 All contributions go through a review process:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls124\ilvl0
\fs32 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Automated checks (linting, tests)\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Code review by maintainers\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Possible revisions based on feedback\cb1 \uc0\u8232 
\fs32 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Final approval and merge\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-xcNPHInlo3nqE3445RlR-community-guidelines"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Community Guidelines\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 We strive to maintain a welcoming and inclusive community:\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls125\ilvl0
\fs48 \cf6 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 		\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Be respectful and considerate in all interactions\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Focus on the ideas being discussed, not the person presenting them\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Assume good intentions from other contributors\cb1 \uc0\u8232 
\fs48 \cf6 \strokec6 \uc0\u8232 
\fs24 \cf3 \cb4 \strokec3 Help others learn and grow through constructive feedback\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-xcNPHInlo3nqE3445RlR-recognition"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Recognition\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 All contributors are valued and will be recognized in our documentation and release notes. Significant contributors may be invited to join as maintainers.\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://open-2c.gitbook.com/~space/q8vrBtTE7RgMKLs2m89I/~gitbook/pdf?limit=100&back=false#pdf-page-xcNPHInlo3nqE3445RlR-questions"}}{\fldrslt 
\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \
}}\pard\pardeftab720\partightenfactor0

\f3\b\fs48 \AppleTypeServices\AppleTypeServicesF65539 \cf3 \cb4 Questions?\cb1 \
\pard\pardeftab720\sa480\partightenfactor0

\f2\b0\fs24 \AppleTypeServices \cf3 \cb4 If you have questions about contributing, please {\field{\*\fldinst{HYPERLINK "https://github.com/happen-framework/happen/issues/new"}}{\fldrslt \cf5 \ul \ulc5 \strokec5 open an issue}} with the label "question".\cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 Thank you for helping make Happen better while embracing the philosophy of simplicity!\cb1 \
}